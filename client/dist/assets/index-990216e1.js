(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(l){if(l.ep)return;l.ep=!0;const a=e(l);fetch(l.href,a)}})();const Qw=(r,t)=>r===t,cg=Symbol("solid-track"),is={equals:Qw};let dg=xg;const qt=1,rs=2,pg={owned:null,cleanups:null,context:null,owner:null};var Me=null;let wn=null,Se=null,Ve=null,Dt=null,$s=0;function wi(r,t){const e=Se,n=Me,l=r.length===0,a=l?pg:{owned:null,cleanups:null,context:null,owner:t===void 0?n:t},h=l?r:()=>r(()=>ht(()=>Cs(a)));Me=a,Se=null;try{return _i(h,!0)}finally{Se=e,Me=n}}function He(r,t){t=t?Object.assign({},is,t):is;const e={value:r,observers:null,observerSlots:null,comparator:t.equals||void 0},n=l=>(typeof l=="function"&&(l=l(e.value)),yg(e,l));return[vg.bind(e),n]}function Fe(r,t,e){const n=Ol(r,t,!1,qt);dr(n)}function ki(r,t,e){dg=nk;const n=Ol(r,t,!1,qt);(!e||!e.render)&&(n.user=!0),Dt?Dt.push(n):dr(n)}function be(r,t,e){e=e?Object.assign({},is,e):is;const n=Ol(r,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=e.equals||void 0,dr(n),vg.bind(n)}function ek(r){return _i(r,!1)}function ht(r){if(Se===null)return r();const t=Se;Se=null;try{return r()}finally{Se=t}}function gg(r){ki(()=>ht(r))}function mg(r){return Me===null||(Me.cleanups===null?Me.cleanups=[r]:Me.cleanups.push(r)),r}function tk(r,t){const e=Symbol("context");return{id:e,Provider:lk(e),defaultValue:r}}function ik(r){let t;return(t=kg(Me,r.id))!==void 0?t:r.defaultValue}function rr(r){const t=be(r),e=be(()=>Xn(t()));return e.toArray=()=>{const n=e();return Array.isArray(n)?n:n!=null?[n]:[]},e}function vg(){if(this.sources&&this.state)if(this.state===qt)dr(this);else{const r=Ve;Ve=null,_i(()=>ns(this),!1),Ve=r}if(Se){const r=this.observers?this.observers.length:0;Se.sources?(Se.sources.push(this),Se.sourceSlots.push(r)):(Se.sources=[this],Se.sourceSlots=[r]),this.observers?(this.observers.push(Se),this.observerSlots.push(Se.sources.length-1)):(this.observers=[Se],this.observerSlots=[Se.sources.length-1])}return this.value}function yg(r,t,e){let n=r.value;return(!r.comparator||!r.comparator(n,t))&&(r.value=t,r.observers&&r.observers.length&&_i(()=>{for(let l=0;l<r.observers.length;l+=1){const a=r.observers[l],h=wn&&wn.running;h&&wn.disposed.has(a),(h?!a.tState:!a.state)&&(a.pure?Ve.push(a):Dt.push(a),a.observers&&bg(a)),h||(a.state=qt)}if(Ve.length>1e6)throw Ve=[],new Error},!1)),t}function dr(r){if(!r.fn)return;Cs(r);const t=Me,e=Se,n=$s;Se=Me=r,rk(r,r.value,n),Se=e,Me=t}function rk(r,t,e){let n;try{n=r.fn(t)}catch(l){return r.pure&&(r.state=qt,r.owned&&r.owned.forEach(Cs),r.owned=null),r.updatedAt=e+1,wg(l)}(!r.updatedAt||r.updatedAt<=e)&&(r.updatedAt!=null&&"observers"in r?yg(r,n):r.value=n,r.updatedAt=e)}function Ol(r,t,e,n=qt,l){const a={fn:r,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Me,context:null,pure:e};return Me===null||Me!==pg&&(Me.owned?Me.owned.push(a):Me.owned=[a]),a}function ss(r){if(r.state===0)return;if(r.state===rs)return ns(r);if(r.suspense&&ht(r.suspense.inFallback))return r.suspense.effects.push(r);const t=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<$s);)r.state&&t.push(r);for(let e=t.length-1;e>=0;e--)if(r=t[e],r.state===qt)dr(r);else if(r.state===rs){const n=Ve;Ve=null,_i(()=>ns(r,t[0]),!1),Ve=n}}function _i(r,t){if(Ve)return r();let e=!1;t||(Ve=[]),Dt?e=!0:Dt=[],$s++;try{const n=r();return sk(e),n}catch(n){e||(Dt=null),Ve=null,wg(n)}}function sk(r){if(Ve&&(xg(Ve),Ve=null),r)return;const t=Dt;Dt=null,t.length&&_i(()=>dg(t),!1)}function xg(r){for(let t=0;t<r.length;t++)ss(r[t])}function nk(r){let t,e=0;for(t=0;t<r.length;t++){const n=r[t];n.user?r[e++]=n:ss(n)}for(t=0;t<e;t++)ss(r[t])}function ns(r,t){r.state=0;for(let e=0;e<r.sources.length;e+=1){const n=r.sources[e];if(n.sources){const l=n.state;l===qt?n!==t&&(!n.updatedAt||n.updatedAt<$s)&&ss(n):l===rs&&ns(n,t)}}}function bg(r){for(let t=0;t<r.observers.length;t+=1){const e=r.observers[t];e.state||(e.state=rs,e.pure?Ve.push(e):Dt.push(e),e.observers&&bg(e))}}function Cs(r){let t;if(r.sources)for(;r.sources.length;){const e=r.sources.pop(),n=r.sourceSlots.pop(),l=e.observers;if(l&&l.length){const a=l.pop(),h=e.observerSlots.pop();n<l.length&&(a.sourceSlots[h]=n,l[n]=a,e.observerSlots[n]=h)}}if(r.owned){for(t=r.owned.length-1;t>=0;t--)Cs(r.owned[t]);r.owned=null}if(r.cleanups){for(t=r.cleanups.length-1;t>=0;t--)r.cleanups[t]();r.cleanups=null}r.state=0,r.context=null}function wg(r){throw r}function kg(r,t){return r?r.context&&r.context[t]!==void 0?r.context[t]:kg(r.owner,t):void 0}function Xn(r){if(typeof r=="function"&&!r.length)return Xn(r());if(Array.isArray(r)){const t=[];for(let e=0;e<r.length;e++){const n=Xn(r[e]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return r}function lk(r,t){return function(n){let l;return Fe(()=>l=ht(()=>(Me.context={[r]:n.value},rr(()=>n.children))),void 0),l}}const ok=Symbol("fallback");function Kd(r){for(let t=0;t<r.length;t++)r[t]()}function ak(r,t,e={}){let n=[],l=[],a=[],h=0,d=t.length>1?[]:null;return mg(()=>Kd(a)),()=>{let p=r()||[],g,m;return p[cg],ht(()=>{let b=p.length,k,C,O,M,I,L,F,N,H;if(b===0)h!==0&&(Kd(a),a=[],n=[],l=[],h=0,d&&(d=[])),e.fallback&&(n=[ok],l[0]=wi(W=>(a[0]=W,e.fallback())),h=1);else if(h===0){for(l=new Array(b),m=0;m<b;m++)n[m]=p[m],l[m]=wi(y);h=b}else{for(O=new Array(b),M=new Array(b),d&&(I=new Array(b)),L=0,F=Math.min(h,b);L<F&&n[L]===p[L];L++);for(F=h-1,N=b-1;F>=L&&N>=L&&n[F]===p[N];F--,N--)O[N]=l[F],M[N]=a[F],d&&(I[N]=d[F]);for(k=new Map,C=new Array(N+1),m=N;m>=L;m--)H=p[m],g=k.get(H),C[m]=g===void 0?-1:g,k.set(H,m);for(g=L;g<=F;g++)H=n[g],m=k.get(H),m!==void 0&&m!==-1?(O[m]=l[g],M[m]=a[g],d&&(I[m]=d[g]),m=C[m],k.set(H,m)):a[g]();for(m=L;m<b;m++)m in O?(l[m]=O[m],a[m]=M[m],d&&(d[m]=I[m],d[m](m))):l[m]=wi(y);l=l.slice(0,h=b),n=p.slice(0)}return l});function y(b){if(a[m]=b,d){const[k,C]=He(m);return d[m]=C,t(p[m],k)}return t(p[m])}}}function V(r,t){return ht(()=>r(t||{}))}function fk(r){const t="fallback"in r&&{fallback:()=>r.fallback};return be(ak(()=>r.each,r.children,t||void 0))}function uk(r,t,e){let n=e.length,l=t.length,a=n,h=0,d=0,p=t[l-1].nextSibling,g=null;for(;h<l||d<a;){if(t[h]===e[d]){h++,d++;continue}for(;t[l-1]===e[a-1];)l--,a--;if(l===h){const m=a<n?d?e[d-1].nextSibling:e[a-d]:p;for(;d<a;)r.insertBefore(e[d++],m)}else if(a===d)for(;h<l;)(!g||!g.has(t[h]))&&t[h].remove(),h++;else if(t[h]===e[a-1]&&e[d]===t[l-1]){const m=t[--l].nextSibling;r.insertBefore(e[d++],t[h++].nextSibling),r.insertBefore(e[--a],m),t[l]=e[a]}else{if(!g){g=new Map;let y=d;for(;y<a;)g.set(e[y],y++)}const m=g.get(t[h]);if(m!=null)if(d<m&&m<a){let y=h,b=1,k;for(;++y<l&&y<a&&!((k=g.get(t[y]))==null||k!==m+b);)b++;if(b>m-d){const C=t[h];for(;d<m;)r.insertBefore(e[d++],C)}else r.replaceChild(e[d++],t[h++])}else h++;else t[h++].remove()}}}const Xd="_$DX_DELEGATE";function hk(r,t,e,n={}){let l;return wi(a=>{l=a,t===document?r():te(t,r(),t.firstChild?null:void 0,e)},n.owner),()=>{l(),t.textContent=""}}function oe(r,t,e){let n;const l=()=>{const h=document.createElement("template");return h.innerHTML=r,e?h.content.firstChild.firstChild:h.content.firstChild},a=t?()=>(n||(n=l())).cloneNode(!0):()=>ht(()=>document.importNode(n||(n=l()),!0));return a.cloneNode=a,a}function Gt(r,t=window.document){const e=t[Xd]||(t[Xd]=new Set);for(let n=0,l=r.length;n<l;n++){const a=r[n];e.has(a)||(e.add(a),t.addEventListener(a,ck))}}function kn(r,t,e){e==null?r.removeAttribute(t):r.setAttribute(t,e)}function Ms(r,t){t==null?r.removeAttribute("class"):r.className=t}function ls(r,t,e){return ht(()=>r(t,e))}function te(r,t,e,n){if(e!==void 0&&!n&&(n=[]),typeof t!="function")return os(r,t,n,e);Fe(l=>os(r,t(),l,e),n)}function ck(r){const t=`$$${r.type}`;let e=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==e&&Object.defineProperty(r,"target",{configurable:!0,value:e}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return e||document}});e;){const n=e[t];if(n&&!e.disabled){const l=e[`${t}Data`];if(l!==void 0?n.call(e,l,r):n.call(e,r),r.cancelBubble)return}e=e._$host||e.parentNode||e.host}}function os(r,t,e,n,l){for(;typeof e=="function";)e=e();if(t===e)return e;const a=typeof t,h=n!==void 0;if(r=h&&e[0]&&e[0].parentNode||r,a==="string"||a==="number")if(a==="number"&&(t=t.toString()),h){let d=e[0];d&&d.nodeType===3?d.data=t:d=document.createTextNode(t),e=di(r,e,n,d)}else e!==""&&typeof e=="string"?e=r.firstChild.data=t:e=r.textContent=t;else if(t==null||a==="boolean")e=di(r,e,n);else{if(a==="function")return Fe(()=>{let d=t();for(;typeof d=="function";)d=d();e=os(r,d,e,n)}),()=>e;if(Array.isArray(t)){const d=[],p=e&&Array.isArray(e);if(Yn(d,t,e,l))return Fe(()=>e=os(r,d,e,n,!0)),()=>e;if(d.length===0){if(e=di(r,e,n),h)return e}else p?e.length===0?Yd(r,d,n):uk(r,e,d):(e&&di(r),Yd(r,d));e=d}else if(t instanceof Node){if(Array.isArray(e)){if(h)return e=di(r,e,n,t);di(r,e,null,t)}else e==null||e===""||!r.firstChild?r.appendChild(t):r.replaceChild(t,r.firstChild);e=t}else console.warn("Unrecognized value. Skipped inserting",t)}return e}function Yn(r,t,e,n){let l=!1;for(let a=0,h=t.length;a<h;a++){let d=t[a],p=e&&e[a];if(d instanceof Node)r.push(d);else if(!(d==null||d===!0||d===!1))if(Array.isArray(d))l=Yn(r,d,p)||l;else if(typeof d=="function")if(n){for(;typeof d=="function";)d=d();l=Yn(r,Array.isArray(d)?d:[d],Array.isArray(p)?p:[p])||l}else r.push(d),l=!0;else{const g=String(d);p&&p.nodeType===3?(p.data=g,r.push(p)):r.push(document.createTextNode(g))}}return l}function Yd(r,t,e=null){for(let n=0,l=t.length;n<l;n++)r.insertBefore(t[n],e)}function di(r,t,e,n){if(e===void 0)return r.textContent="";const l=n||document.createTextNode("");if(t.length){let a=!1;for(let h=t.length-1;h>=0;h--){const d=t[h];if(l!==d){const p=d.parentNode===r;!a&&!h?p?r.replaceChild(l,d):r.insertBefore(l,e):p&&d.remove()}else a=!0}}else r.insertBefore(l,e);return[l]}const dk=new Map;async function It(r){let t=dk.get(r);return t===void 0&&(t=await await(await fetch(r)).text()),t}function pk(r,t){const e=new Map;return{get(n){var a,h;return(h=(a=e.get(r(n)))==null?void 0:a.find(d=>t(d[0],n)))==null?void 0:h[1]},set(n,l){let a=r(n),h=e.get(a);h||(h=[],e.set(a,h));const d=h.findIndex(p=>t(p[0],n));d!=-1&&h.splice(d,1),h.push([n,l])},delete(n){let l=r(n),a=e.get(l);if(!a)return;const h=a.findIndex(d=>t(d[0],n));h!=-1&&a.splice(h,1)}}}function gk(r,t,e){e||(e=(a,h)=>a==h);const[n,l]=He(t());r(),ki(()=>{const a=t();e!=null&&e(n(),a)||r(),ht(()=>l(()=>a))})}var vi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Il={},Sg={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.makeEveryOtherGenerator=Ht.makeGenerator=Ht.visit=void 0;var mk=function(r){return!!(r!=null&&r.type)},vk=function(r){return mk(r)||Array.isArray(r)},yk=function(r,t,e,n,l){return{node:r,parent:t,parentPath:e,key:n,index:l,skip:function(){this.skipped=!0},remove:function(){this.removed=!0},replaceWith:function(a){this.replaced=a},findParent:function(a){return e&&(a(e)?e:e.findParent(a))}}},xk=function(r,t){var e=function(n,l,a,h,d){var p,g=t[n.type],m=yk(n,l,a,h,d),y=l;if(g!=null&&g.enter){if(g.enter(m),m.removed){if(!h||!l)throw new Error("Asked to remove ".concat(n," but no parent key was present in ").concat(l));return typeof d=="number"?y[h].splice(d,1):y[h]=null,m}if(m.replaced){if(!h||!l)throw new Error("Asked to remove ".concat(n," but no parent key was present in ").concat(l));typeof d=="number"?y[h].splice(d,1,m.replaced):y[h]=m.replaced}if(m.skipped)return m}Object.entries(n).filter(function(b){b[0];var k=b[1];return vk(k)}).forEach(function(b){var k=b[0],C=b[1];if(Array.isArray(C))for(var O=0,M=0;O-M<C.length;O++){var I=C[O-M],L=e(I,n,m,k,O-M);L!=null&&L.removed&&(M+=1)}else e(C,n,m,k)}),(p=g==null?void 0:g.exit)===null||p===void 0||p.call(g,m)};e(r)};Ht.visit=xk;var bk=function(r){var t=function(e){return typeof e=="string"?e:e==null?"":Array.isArray(e)?e.map(t).join(""):e.type in r?r[e.type](e):"NO GENERATOR FOR ".concat(e.type)+e};return t};Ht.makeGenerator=bk;var wk=function(r){var t=function(e,n){return e.reduce(function(l,a,h){return l+r(a)+(h===e.length-1?"":r(n[h]))},"")};return t};Ht.makeEveryOtherGenerator=wk;var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});(function(r){var t=vi&&vi.__createBinding||(Object.create?function(n,l,a,h){h===void 0&&(h=a);var d=Object.getOwnPropertyDescriptor(l,a);(!d||("get"in d?!l.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return l[a]}}),Object.defineProperty(n,h,d)}:function(n,l,a,h){h===void 0&&(h=a),n[h]=l[a]}),e=vi&&vi.__exportStar||function(n,l){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(l,a)&&t(l,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Ht,r),e(Ag,r)})(Sg);Object.defineProperty(Il,"__esModule",{value:!0});var Pg=Sg,kk={program:function(r){return T(r.wsStart)+T(r.program)},preprocessor:function(r){return T(r.line)+T(r._)},keyword:function(r){return T(r.token)+T(r.whitespace)},precision:function(r){return T(r.prefix)+T(r.qualifier)+T(r.specifier)},expression_statement:function(r){return T(r.expression)+T(r.semi)},if_statement:function(r){return T(r.if)+T(r.lp)+T(r.condition)+T(r.rp)+T(r.body)+T(r.else)},switch_statement:function(r){return T(r.switch)+T(r.lp)+T(r.expression)+T(r.rp)+T(r.lb)+T(r.cases)+T(r.rb)},break_statement:function(r){return T(r.break)+T(r.semi)},do_statement:function(r){return T(r.do)+T(r.body)+T(r.while)+T(r.lp)+T(r.expression)+T(r.rp)+T(r.semi)},continue_statement:function(r){return T(r.continue)+T(r.semi)},return_statement:function(r){return T(r.return)+T(r.expression)+T(r.semi)},discard_statement:function(r){return T(r.discard)+T(r.semi)},while_statement:function(r){return T(r.while)+T(r.lp)+T(r.condition)+T(r.rp)+T(r.body)},for_statement:function(r){return T(r.for)+T(r.lp)+T(r.init)+T(r.initSemi)+T(r.condition)+T(r.conditionSemi)+T(r.operation)+T(r.rp)+T(r.body)},condition_expression:function(r){return T(r.specified_type)+T(r.identifier)+T(r.operator)+T(r.initializer)},declaration_statement:function(r){return T(r.declaration)+T(r.semi)},fully_specified_type:function(r){return T(r.qualifiers)+T(r.specifier)},layout_qualifier:function(r){return T(r.layout)+T(r.lp)+pi(r.qualifiers,r.commas)+T(r.rp)},layout_qualifier_id:function(r){return T(r.identifier)+T(r.operator)+T(r.expression)},switch_case:function(r){return T(r.case)+T(r.test)+T(r.colon)+T(r.statements)},default_case:function(r){return T(r.default)+T(r.colon)+T(r.statements)},declaration:function(r){return T(r.identifier)+T(r.quantifier)+T(r.operator)+T(r.initializer)},declarator_list:function(r){return T(r.specified_type)+pi(r.declarations,r.commas)},type_specifier:function(r){return T(r.specifier)+T(r.quantifier)},array_specifiers:function(r){return T(r.specifiers)},array_specifier:function(r){return T(r.lb)+T(r.expression)+T(r.rb)},identifier:function(r){return r.identifier+T(r.whitespace)},function_header:function(r){return T(r.returnType)+T(r.name)+T(r.lp)},function_prototype:function(r){return T(r.header.returnType)+T(r.header.name)+T(r.header.lp)+(r.parameters?pi(r.parameters,r.commas):"")+T(r.rp)},parameter_declaration:function(r){return T(r.qualifier)+T(r.declaration)},compound_statement:function(r){return T(r.lb)+T(r.statements)+T(r.rb)},function:function(r){return T(r.prototype)+T(r.body)},function_call:function(r){return T(r.identifier)+T(r.lp)+T(r.args)+T(r.rp)},parameter_declarator:function(r){return T(r.specifier)+T(r.identifier)+T(r.quantifier)},postfix:function(r){return T(r.expression)+T(r.postfix)},quantifier:function(r){return T(r.lb)+T(r.expression)+T(r.rb)},quantified_identifier:function(r){return T(r.identifier)+T(r.quantifier)},field_selection:function(r){return T(r.dot)+T(r.selection)},subroutine_qualifier:function(r){return T(r.subroutine)+T(r.lp)+T(r.type_names)+T(r.commas)+T(r.rp)},assignment:function(r){return T(r.left)+T(r.operator)+T(r.right)},ternary:function(r){return T(r.expression)+T(r.question)+T(r.left)+T(r.colon)+T(r.right)},binary:function(r){return T(r.left)+T(r.operator)+T(r.right)},group:function(r){return T(r.lp)+T(r.expression)+T(r.rp)},unary:function(r){return T(r.operator)+T(r.expression)},float_constant:function(r){return T(r.token)+T(r.whitespace)},double_constant:function(r){return T(r.token)+T(r.whitespace)},int_constant:function(r){return T(r.token)+T(r.whitespace)},uint_constant:function(r){return T(r.token)+T(r.whitespace)},bool_constant:function(r){return T(r.token)+T(r.whitespace)},literal:function(r){return T(r.literal)+T(r.whitespace)},struct:function(r){return T(r.struct)+T(r.typeName)+T(r.lb)+T(r.declarations)+T(r.rb)},struct_declaration:function(r){return T(r.declaration)+T(r.semi)},interface_declarator:function(r){return T(r.qualifiers)+T(r.interface_type)+T(r.lp)+T(r.declarations)+T(r.rp)+T(r.identifier)},struct_declarator:function(r){return T(r.specified_type)+pi(r.declarations,r.commas)},initializer_list:function(r){return T(r.lb)+pi(r.initializers,r.commas)+T(r.rb)},qualifier_declarator:function(r){return T(r.qualifiers)+pi(r.declarations,r.commas)}},T=(0,Pg.makeGenerator)(kk),pi=(0,Pg.makeEveryOtherGenerator)(T);Il.default=T;const Sk=String.fromCharCode(123),Ak=(r,...t)=>{t.forEach(([e,n])=>{r.types[e]={references:[n]}})},Pk=(r,t,e)=>{r.types[t].references.push(e)},Nl=(r,t)=>r?t in r.types?r:Nl(r.parent,t):null,$k=(r,t)=>Nl(r,t)!==null,Zi=(r,...t)=>{t.forEach(([e,n])=>{const l=r.bindings[e]||{references:[]};l.initializer=n,l.references.unshift(n),r.bindings[e]=l})},Ck=(r,t,e)=>{const n=$g(r,t);n?n.bindings[t].references.push(e):Zi(r,[t,e])},$g=(r,t)=>r?t in r.bindings?r:$g(r.parent,t):null,Mk=(r,t,e)=>{r.functions[t]={references:[e]}},Sn=(r,t,e)=>{const n=Ll(r);t in n.functions?n.functions[t].references.push(e):Mk(n,t,e)},Ll=r=>r.parent?Ll(r.parent):r,Tk=(r,t)=>t in Ll(r).functions,gi=(r,t)=>({partial:t===void 0?r:{type:r,...t}}),Qi=(...r)=>r.flat().filter(t=>t!=null&&t!==""&&t.length!==0),Dk=r=>r.length>1?r:r[0],Ek=(...r)=>Dk(Qi(r)),Rk=(...r)=>r.flat().reduce((t,[e,n])=>({type:"binary",operator:e,left:t,right:n})),Ok=new Set(["abs","acos","acosh","all","any","asin","asinh","atan","atanh","atomicAdd","atomicAnd","atomicCompSwap","atomicCounter","atomicCounterDecrement","atomicCounterIncrement","atomicExchange","atomicMax","atomicMin","atomicOr","atomicXor","barrier","bitCount","bitfieldExtract","bitfieldInsert","bitfieldReverse","ceil","clamp","cos","cosh","cross","degrees","determinant","dFdx","dFdxCoarse","dFdxFine","dFdy","dFdyCoarse","dFdyFine","distance","dot","EmitStreamVertex","EmitVertex","EndPrimitive","EndStreamPrimitive","equal","exp","exp2","faceforward","findLSB","findMSB","floatBitsToInt","floatBitsToUint","floor","fma","fract","frexp","fwidth","fwidthCoarse","fwidthFine","greaterThan","greaterThanEqual","groupMemoryBarrier","imageAtomicAdd","imageAtomicAnd","imageAtomicCompSwap","imageAtomicExchange","imageAtomicMax","imageAtomicMin","imageAtomicOr","imageAtomicXor","imageLoad","imageSamples","imageSize","imageStore","imulExtended","intBitsToFloat","interpolateAtCentroid","interpolateAtOffset","interpolateAtSample","inverse","inversesqrt","isinf","isnan","ldexp","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","memoryBarrier","memoryBarrierAtomicCounter","memoryBarrierBuffer","memoryBarrierImage","memoryBarrierShared","min","mix","mod","modf","noise","noise1","noise2","noise3","noise4","normalize","not","notEqual","outerProduct","packDouble2x32","packHalf2x16","packSnorm2x16","packSnorm4x8","packUnorm","packUnorm2x16","packUnorm4x8","pow","radians","reflect","refract","round","roundEven","sign","sin","sinh","smoothstep","sqrt","step","tan","tanh","texelFetch","texelFetchOffset","texture","textureGather","textureGatherOffset","textureGatherOffsets","textureGrad","textureGradOffset","textureLod","textureLodOffset","textureOffset","textureProj","textureProjGrad","textureProjGradOffset","textureProjLod","textureProjLodOffset","textureProjOffset","textureQueryLevels","textureQueryLod","textureSamples","textureSize","transpose","trunc","uaddCarry","uintBitsToFloat","umulExtended","unpackDouble2x32","unpackHalf2x16","unpackSnorm2x16","unpackSnorm4x8","unpackUnorm","unpackUnorm2x16","unpackUnorm4x8","usubBorrow","texture2D","textureCube"]);function Ik(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}function ii(r,t,e,n){var l=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(l,ii.prototype),l.expected=t,l.found=e,l.location=n,l.name="SyntaxError",l}Ik(ii,Error);function An(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}ii.prototype.format=function(r){var t="Error: "+this.message;if(this.location){var e=null,n;for(n=0;n<r.length;n++)if(r[n].source===this.location.source){e=r[n].text.split(/\r\n|\n|\r/g);break}var l=this.location.start,a=this.location.source+":"+l.line+":"+l.column;if(e){var h=this.location.end,d=An("",l.line.toString().length),p=e[l.line-1],g=l.line===h.line?h.column:p.length+1;t+=`
 --> `+a+`
`+d+` |
`+l.line+" | "+p+`
`+d+" | "+An("",l.column-1)+An("",g-l.column,"^")}else t+=`
 at `+a}return t};ii.buildMessage=function(r,t){var e={literal:function(g){return'"'+l(g.text)+'"'},class:function(g){var m=g.parts.map(function(y){return Array.isArray(y)?a(y[0])+"-"+a(y[1]):a(y)});return"["+(g.inverted?"^":"")+m+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(g){return g.description}};function n(g){return g.charCodeAt(0).toString(16).toUpperCase()}function l(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+n(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+n(m)})}function a(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+n(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+n(m)})}function h(g){return e[g.type](g)}function d(g){var m=g.map(h),y,b;if(m.sort(),m.length>0){for(y=1,b=1;y<m.length;y++)m[y-1]!==m[y]&&(m[b]=m[y],b++);m.length=b}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function p(g){return g?'"'+l(g)+'"':"end of input"}return"Expected "+d(r)+" but "+p(t)+" found."};function Nk(r,t){t=t!==void 0?t:{};var e={},n=t.grammarSource,l={start:xu},a=xu,h="attribute",d="varying",p="const",g="bool",m="float",y="double",b="int",k="uint",C="break",O="continue",M="do",I="else",L="for",F="if",N="discard",H="return",W="switch",Z="case",re="default",X="subroutine",J="bvec2",ie="bvec3",me="bvec4",ke="ivec2",We="ivec3",De="ivec4",it="uvec2",Bi="uvec3",ot="uvec4",Ge="vec2",rt="vec3",ct="vec4",Pt="mat2",Xt="mat3",Fi="mat4",ao="centroid",fo="in",uo="out",ho="inout",co="uniform",po="patch",go="sample",mo="buffer",vo="shared",yo="coherent",xo="volatile",bo="restrict",wo="readonly",ko="writeonly",So="dvec2",Ao="dvec3",Po="dvec4",$o="dmat2",Co="dmat3",Mo="dmat4",To="noperspective",Do="flat",Eo="smooth",Ro="layout",Oo="mat2x2",Io="mat2x3",No="mat2x4",Lo="mat3x2",_o="mat3x3",Bo="mat3x4",Fo="mat4x2",Vo="mat4x3",Ho="mat4x4",Wo="dmat2x2",zo="dmat2x3",Uo="dmat2x4",qo="dmat3x2",Go="dmat3x3",jo="dmat3x4",Ko="dmat4x2",Xo="dmat4x3",Yo="dmat4x4",Jo="atomic_uint",Zo="sampler1D",Qo="sampler2D",ea="sampler3D",ta="samplerCube",ia="sampler1DShadow",ra="sampler2DShadow",sa="samplerCubeShadow",na="sampler1DArray",la="sampler2DArray",oa="sampler1DArrayShadow",aa="sampler2DArrayshadow",fa="isampler1D",ua="isampler2D",ha="isampler3D",ca="isamplerCube",da="isampler1Darray",pa="isampler2DArray",ga="usampler1D",ma="usampler2D",va="usampler3D",ya="usamplerCube",xa="usampler1DArray",ba="usampler2DArray",wa="sampler2DRect",ka="sampler2DRectshadow",Sa="isampler2DRect",Aa="usampler2DRect",Pa="samplerBuffer",$a="isamplerBuffer",Ca="usamplerBuffer",Ma="samplerCubeArray",Ta="samplerCubeArrayShadow",Da="isamplerCubeArray",Ea="usamplerCubeArray",Ra="sampler2DMS",Oa="isampler2DMS",Ia="usampler2DMS",Na="sampler2DMSArray",La="isampler2DMSArray",_a="usampler2DMSArray",Ba="image1D",Fa="iimage1D",Va="uimage1D",Ha="image2D",Wa="iimage2D",za="uimage2D",Ua="image3D",qa="iimage3D",Ga="uimage3D",ja="image2DRect",Ka="iimage2DRect",Xa="uimage2DRect",Ya="imageCube",Ja="iimageCube",Za="uimageCube",Qa="imageBuffer",ef="iimageBuffer",tf="uimageBuffer",rf="image1DArray",sf="iimage1DArray",nf="uimage1DArray",lf="image2DArray",of="iimage2DArray",af="uimage2DArray",ff="imageCubeArray",uf="iimageCubeArray",hf="uimageCubeArray",cf="image2DMS",df="iimage2DMS",pf="uimage2DMS",gf="image2DMArray",mf="iimage2DMSArray",vf="uimage2DMSArray",yf="struct",xf="void",bf="while",wf="invariant",kf="precise",Sf="highp",Af="mediump",Pf="lowp",$f="precision",Cf="true",Mf="false",Tf="<<",Df=">>",Ef="++",Rf="--",Of="<=",If=">=",Nf="==",Lf="!=",_f="&&",Bf="||",Ff="^^",Vf="*=",Hf="/=",Wf="+=",zf="%=",Uf="<<=",qf=">>=",Gf="&=",jf="^=",Kf="|=",Xf="-=",x0="(",b0=")",w0="[",k0="]",S0="{",A0="}",Yf=".",P0=",",$0=":",C0="=",M0=";",T0="!",D0="-",E0="~",R0="+",O0="*",I0="/",N0="%",L0="<",_0=">",B0="|",F0="^",V0="&",H0="?",Jf="0",Zf="lf",Qf="LF",W0="#",eu="//",tu="/*",ai="*/",z0=/^[A-Za-z_]/,Os=/^[A-Za-z_0-9]/,U0=/^[uU]/,q0=/^[1-9]/,iu=/^[0-7]/,G0=/^[xX]/,ru=/^[0-9a-fA-F]/,j0=/^[0-9]/,K0=/^[eE]/,X0=/^[+\-]/,Y0=/^[fF]/,vr=/^[^\n]/,su=/^[ \t\n\r]/,J0=$("attribute",!1),Z0=$("varying",!1),Q0=$("const",!1),ev=$("bool",!1),tv=$("float",!1),iv=$("double",!1),rv=$("int",!1),sv=$("uint",!1),nv=$("break",!1),lv=$("continue",!1),ov=$("do",!1),av=$("else",!1),fv=$("for",!1),uv=$("if",!1),hv=$("discard",!1),cv=$("return",!1),dv=$("switch",!1),pv=$("case",!1),gv=$("default",!1),mv=$("subroutine",!1),vv=$("bvec2",!1),yv=$("bvec3",!1),xv=$("bvec4",!1),bv=$("ivec2",!1),wv=$("ivec3",!1),kv=$("ivec4",!1),Sv=$("uvec2",!1),Av=$("uvec3",!1),Pv=$("uvec4",!1),$v=$("vec2",!1),Cv=$("vec3",!1),Mv=$("vec4",!1),Tv=$("mat2",!1),Dv=$("mat3",!1),Ev=$("mat4",!1),Rv=$("centroid",!1),Ov=$("in",!1),Iv=$("out",!1),Nv=$("inout",!1),Lv=$("uniform",!1),_v=$("patch",!1),Bv=$("sample",!1),Fv=$("buffer",!1),Vv=$("shared",!1),Hv=$("coherent",!1),Wv=$("volatile",!1),zv=$("restrict",!1),Uv=$("readonly",!1),qv=$("writeonly",!1),Gv=$("dvec2",!1),jv=$("dvec3",!1),Kv=$("dvec4",!1),Xv=$("dmat2",!1),Yv=$("dmat3",!1),Jv=$("dmat4",!1),Zv=$("noperspective",!1),Qv=$("flat",!1),e1=$("smooth",!1),t1=$("layout",!1),i1=$("mat2x2",!1),r1=$("mat2x3",!1),s1=$("mat2x4",!1),n1=$("mat3x2",!1),l1=$("mat3x3",!1),o1=$("mat3x4",!1),a1=$("mat4x2",!1),f1=$("mat4x3",!1),u1=$("mat4x4",!1),h1=$("dmat2x2",!1),c1=$("dmat2x3",!1),d1=$("dmat2x4",!1),p1=$("dmat3x2",!1),g1=$("dmat3x3",!1),m1=$("dmat3x4",!1),v1=$("dmat4x2",!1),y1=$("dmat4x3",!1),x1=$("dmat4x4",!1),b1=$("atomic_uint",!1),w1=$("sampler1D",!1),k1=$("sampler2D",!1),S1=$("sampler3D",!1),A1=$("samplerCube",!1),P1=$("sampler1DShadow",!1),$1=$("sampler2DShadow",!1),C1=$("samplerCubeShadow",!1),M1=$("sampler1DArray",!1),T1=$("sampler2DArray",!1),D1=$("sampler1DArrayShadow",!1),E1=$("sampler2DArrayshadow",!1),R1=$("isampler1D",!1),O1=$("isampler2D",!1),I1=$("isampler3D",!1),N1=$("isamplerCube",!1),L1=$("isampler1Darray",!1),_1=$("isampler2DArray",!1),B1=$("usampler1D",!1),F1=$("usampler2D",!1),V1=$("usampler3D",!1),H1=$("usamplerCube",!1),W1=$("usampler1DArray",!1),z1=$("usampler2DArray",!1),U1=$("sampler2DRect",!1),q1=$("sampler2DRectshadow",!1),G1=$("isampler2DRect",!1),j1=$("usampler2DRect",!1),K1=$("samplerBuffer",!1),X1=$("isamplerBuffer",!1),Y1=$("usamplerBuffer",!1),J1=$("samplerCubeArray",!1),Z1=$("samplerCubeArrayShadow",!1),Q1=$("isamplerCubeArray",!1),ey=$("usamplerCubeArray",!1),ty=$("sampler2DMS",!1),iy=$("isampler2DMS",!1),ry=$("usampler2DMS",!1),sy=$("sampler2DMSArray",!1),ny=$("isampler2DMSArray",!1),ly=$("usampler2DMSArray",!1),oy=$("image1D",!1),ay=$("iimage1D",!1),fy=$("uimage1D",!1),uy=$("image2D",!1),hy=$("iimage2D",!1),cy=$("uimage2D",!1),dy=$("image3D",!1),py=$("iimage3D",!1),gy=$("uimage3D",!1),my=$("image2DRect",!1),vy=$("iimage2DRect",!1),yy=$("uimage2DRect",!1),xy=$("imageCube",!1),by=$("iimageCube",!1),wy=$("uimageCube",!1),ky=$("imageBuffer",!1),Sy=$("iimageBuffer",!1),Ay=$("uimageBuffer",!1),Py=$("image1DArray",!1),$y=$("iimage1DArray",!1),Cy=$("uimage1DArray",!1),My=$("image2DArray",!1),Ty=$("iimage2DArray",!1),Dy=$("uimage2DArray",!1),Ey=$("imageCubeArray",!1),Ry=$("iimageCubeArray",!1),Oy=$("uimageCubeArray",!1),Iy=$("image2DMS",!1),Ny=$("iimage2DMS",!1),Ly=$("uimage2DMS",!1),_y=$("image2DMArray",!1),By=$("iimage2DMSArray",!1),Fy=$("uimage2DMSArray",!1),Vy=$("struct",!1),Hy=$("void",!1),Wy=$("while",!1),zy=$("invariant",!1),Uy=$("precise",!1),qy=$("highp",!1),Gy=$("mediump",!1),jy=$("lowp",!1),Ky=$("precision",!1),Xy=$("true",!1),Yy=$("false",!1),Jy=ae("keyword"),Zy=$("<<",!1),Qy=$(">>",!1),ex=$("++",!1),tx=$("--",!1),ix=$("<=",!1),rx=$(">=",!1),sx=$("==",!1),nx=$("!=",!1),lx=$("&&",!1),ox=$("||",!1),ax=$("^^",!1),fx=$("*=",!1),ux=$("/=",!1),hx=$("+=",!1),cx=$("%=",!1),dx=$("<<=",!1),px=$(">>=",!1),gx=$("&=",!1),mx=$("^=",!1),vx=$("|=",!1),yx=$("-=",!1),xx=$("(",!1),bx=$(")",!1),wx=$("[",!1),kx=$("]",!1),Sx=$("{",!1),Ax=$("}",!1),nu=$(".",!1),Px=$(",",!1),$x=$(":",!1),Cx=$("=",!1),Mx=$(";",!1),Tx=$("!",!1),Dx=$("-",!1),Ex=$("~",!1),Rx=$("+",!1),Ox=$("*",!1),Ix=$("/",!1),Nx=$("%",!1),Lx=$("<",!1),_x=$(">",!1),Bx=$("|",!1),Fx=$("^",!1),Vx=$("&",!1),Hx=$("?",!1),Wx=Je([["A","Z"],["a","z"],"_"],!1,!1),Is=Je([["A","Z"],["a","z"],"_",["0","9"]],!1,!1),zx=Je(["u","U"],!1,!1),Ux=Je([["1","9"]],!1,!1),lu=$("0",!1),ou=Je([["0","7"]],!1,!1),qx=Je(["x","X"],!1,!1),au=Je([["0","9"],["a","f"],["A","F"]],!1,!1),Gx=Je([["0","9"]],!1,!1),jx=ae("exponent"),Kx=Je(["e","E"],!1,!1),Xx=Je(["+","-"],!1,!1),Yx=Je(["f","F"],!1,!1),Jx=$("lf",!1),Zx=$("LF",!1),Qx=ae("primary expression"),eb=ae("unary expression"),tb=ae("equality expression"),ib=ae("and expression"),rb=ae("asignment"),sb=ae("expression"),nb=ae("precision statement"),lb=ae("function prototype"),ob=ae("function header"),ab=ae("function prototype scope"),fb=ae("function header scope"),ub=ae("function parameters"),hb=ae("parameter declaration"),cb=ae("parameter declarator"),db=ae("single type qualifier"),pb=ae("interpolation qualifier"),gb=ae("storage qualifier"),fu=ae("type specifier"),mb=ae("array specifier"),vb=ae("precision qualifier"),yb=ae("struct specifier"),xb=ae("iteration statement"),bb=ae("jump statement"),wb=ae("prepocessor"),kb=$("#",!1),yr=Je([`
`],!0,!1),Sb=ae("whitespace"),Ab=$("//",!1),Pb=$("/*",!1),Ns=$("*/",!1),uu=q2(),hu=Je([" ","	",`
`,"\r"],!1,!1),$b=function(i,o){var f;return ji(ee,(f=xn())==null?void 0:f.end),z("program",{wsStart:i,program:o,scopes:jd})},E=function(i,o){return z("keyword",{token:i,whitespace:o})},Cb=function(i,o){return z("float_constant",{token:i,whitespace:o})},Mb=function(i,o){return z("double_constant",{token:i,whitespace:o})},Tb=function(i,o){return z("int_constant",{token:i,whitespace:o})},Db=function(i,o){return z("uint_constant",{token:i,whitespace:o})},Eb=function(i,o){return z("bool_constant",{token:i,whitespace:o})},Y=function(i,o){return z("literal",{literal:i,whitespace:o})},Rb=function(i,o){return z("identifier",{identifier:i,whitespace:o})},Ob=function(i){const{identifier:o}=i;let f;return(f=Nl(ee,o))&&Pk(f,o,i),i},Ib=function(i,o,f){return z("group",{lp:i,expression:o,rp:f})},Nb=function(i){const{identifier:o}=i;return Ck(ee,o,i),i},Lb=function(i){return i.flat().reduceRight((o,f)=>o?z("postfix",{expression:f,postfix:o}):f)},_b=function(i,o,f){return z("quantifier",{lb:i,expression:o,rb:f})},Bb=function(i,o){return z("field_selection",{dot:i,selection:o})},Fb=function(i,o,f){const c=i.partial,{identifier:u}=c,x=u.type==="postfix"?u.expression.identifier?u.expression.identifier.specifier.identifier:u.expression.specifier.identifier:u.specifier.identifier,P=z("function_call",{...c,args:o,rp:f}),D=Tk(ee,x);return x&&!$k(ee,x)&&(D||!Ok.has(x))&&(D||Jw(`Warning: Function "${x}" has not been declared`),Sn(ee,x,P)),P},Vb=function(i){return[i]},Hb=function(i,o){return[i,...o.flat()]},cu=function(i,o,f){return gi({head:[i,o],lp:f})},Wb=function(i){return gi({lp:i.partial.lp,identifier:[i.partial.head].flat().reduceRight((o,f)=>o?z("postfix",{expression:f,postfix:o}):f)})},zb=function(i,o,f,c){return z("function_call",{identifier:i,lp:o,args:f,rp:c})},Ub=function(i,o){return z("unary",{operator:i,expression:o})},st=function(i,o){return Rk(i,o)},qb=function(i,o,f,c,u){return{question:o,left:f,right:u,colon:c}},Gb=function(i,o){return o?z("ternary",{expression:i,...o}):i},jb=function(i,o,f){return z("assignment",{left:i,operator:o,right:f})},Kb=function(i){return z("declaration_statement",{declaration:i[0],semi:i[1]})},Xb=function(i,o,f){return z("qualifier_declarator",{qualifiers:i,declarations:Qi([o,...f.map(c=>c[1])]),commas:f.map(c=>c[0])})},Yb=function(i,o,f,c,u,x){const P=z("interface_declarator",{qualifiers:i,interface_type:o,lp:f,declarations:c,rp:u,identifier:x});return Zi(ee,[o.identifier,P]),P},Jb=function(i,o,f){return z("precision",{prefix:i,qualifier:o,specifier:f})},Zb=function(i,o,f){const c=((o==null?void 0:o.parameters)||[]).filter(u=>!!u.declaration.identifier).map(u=>[u.declaration.identifier.identifier,u]);return Zi(ee,...c),z("function_prototype",{header:i,...o,rp:f})},Qb=function(i,o,f){const c=z("function_header",{returnType:i,name:o,lp:f});return ee=Tr(Gi(o.identifier,ee,f.location)),c},e2=function(i,o,f){return z("function_prototype",{header:i,...o,rp:f})},t2=function(i,o,f){return z("function_header",{returnType:i,name:o,lp:f})},i2=function(i,o){return{parameters:[i,...o.map(f=>f[1])],commas:o.map(f=>f[0])}},r2=function(i,o){return z("parameter_declaration",{qualifier:i,declaration:o})},s2=function(i,o,f){return z("parameter_declarator",{specifier:i,identifier:o,quantifier:f})},n2=function(i,o){const f=[i.declaration,...o.map(c=>c[1])].filter(c=>!!c.identifier);return Zi(ee,...f.map(c=>[c.identifier.identifier,c])),z("declarator_list",{specified_type:i.specified_type,declarations:f,commas:o.map(c=>c[0])})},l2=function(i,o,f){const[c,u]=f||[];return z("declaration",{identifier:i,quantifier:o,operator:c,initializer:u})},o2=function(i,o){const[f,c,u]=o||[],[x,P]=u||[];return{declaration:z("declaration",{identifier:f,quantifier:c,operator:x,initializer:P}),specified_type:i}},a2=function(i,o){return z("fully_specified_type",{qualifiers:i,specifier:o})},f2=function(i,o,f,c){return gi({qualifiers:[f,...c.map(u=>u[1])],commas:c.map(u=>u[0])})},u2=function(i,o,f,c){return z("layout_qualifier",{layout:i,lp:o,...f.partial,rp:c})},h2=function(i,o){const[f,c]=o||[];return z("layout_qualifier_id",{identifier:i,operator:f,expression:c})},c2=function(i,o,f,c,u){return gi({lp:o,type_names:[f,...c.map(x=>x[1])],commas:c.map(x=>x[0]),rp:u})},d2=function(i,o){return z("subroutine_qualifier",{subroutine:i,...o==null?void 0:o.partial})},p2=function(i,o){return z("type_specifier",{specifier:i,quantifier:o})},du=function(i,o,f){return z("array_specifier",{lb:i,expression:o,rb:f})},g2=function(i){return z("array_specifiers",{specifiers:i})},m2=function(i,o,f,c,u){const x=z("struct",{lb:f,declarations:c,rb:u,struct:i,typeName:o});return o&&Ak(ee,[o.identifier,x]),x},pu=function(i,o){return z("struct_declaration",{declaration:i,semi:o})},v2=function(i,o,f){return z("struct_declarator",{specified_type:i,declarations:[o,...f.map(c=>c[1])],commas:f.map(c=>c[0])})},y2=function(i,o){return z("quantified_identifier",{identifier:i,quantifier:o})},x2=function(i,o,f,c,u){return z("initializer_list",{lb:i,initializers:[o,...f.map(x=>x[1])],commas:Qi(f.map(x=>x[0]),c),rb:u})},b2=function(i){return ee=Tr(Gi(Sk,ee)),i},w2=function(i,o,f){var c;return ji(ee,(c=f.location)==null?void 0:c.start),ee=Dr(ee),z("compound_statement",{lb:i,statements:(o||[]).flat(),rb:f})},k2=function(i,o,f){return z("compound_statement",{lb:i,statements:(o||[]).flat(),rb:f})},S2=function(i,o){return z("expression_statement",{expression:i,semi:o})},A2=function(i,o,f,c,u){const[x,P]=u;return z("if_statement",{if:i,body:x,lp:o,condition:f,rp:c,...P&&{else:P.flat()}})},P2=function(i,o,f,c,u,x,P){return z("switch_statement",{switch:i,lp:o,expression:f,rp:c,lb:u,cases:Zw(x),rb:P})},$2=function(i,o,f){return gi("case_label",{case:i,test:o,colon:f})},C2=function(i,o){return gi("default_label",{default:i,colon:o})},M2=function(i){return ee=Tr(Gi("while",ee)),i},T2=function(i,o,f,c,u){var P,D;const x=u.rb?(P=u.rb.location)==null?void 0:P.start:(D=u.location)==null?void 0:D.end;return ji(ee,x),ee=Dr(ee),z("while_statement",{while:i,lp:o,condition:f,rp:c,body:u})},D2=function(i,o,f,c,u,x,P){return z("do_statement",{do:i,body:o,while:f,lp:c,expression:u,rp:x,semi:P})},E2=function(i){return ee=Tr(Gi("for",ee)),i},R2=function(i,o,f,c,u,x,P,D){var ve,Ee;const G=D.rb?(ve=D.rb.location)==null?void 0:ve.start:(Ee=D.location)==null?void 0:Ee.end;return ji(ee,G),ee=Dr(ee),z("for_statement",{for:i,body:D,lp:o,init:f.expression||f.declaration,initSemi:f.semi,condition:c,conditionSemi:u,operation:x,rp:P})},O2=function(i,o,f,c){const u=z("condition_expression",{specified_type:i,identifier:o,operator:f,initializer:c});return Zi(ee,[o.identifier,u]),u},I2=function(i,o){return z("continue_statement",{continue:i,semi:o})},N2=function(i,o){return z("break_statement",{break:i,semi:o})},L2=function(i,o,f){return z("return_statement",{return:i,expression:o,semi:f})},_2=function(i,o){return z("discard_statement",{discard:i,semi:o})},B2=function(i,o){return z("preprocessor",{line:i,_:o})},F2=function(i,o){return Sn(ee,i.header.name.identifier,i),z("declaration_statement",{declaration:i,semi:o})},V2=function(i,o){var c;const f=z("function",{prototype:i,body:o});return ji(ee,(c=o.rb.location)==null?void 0:c.start),ee=Dr(ee),Sn(ee,i.header.name.identifier,f),f},H2=function(i,o){return Ek(i,o)},gu=function(i,o,f){return Qi(o,f)},W2=function(i,o){return Qi(i,o.flat())},mu=function(i){return i},z2=function(i){return i},s=0,S=0,xr=[{line:1,column:1}],dt=0,Ls=[],w=0,v={},br;if("startRule"in t){if(!(t.startRule in l))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');a=l[t.startRule]}function vu(){return r.substring(S,s)}function U2(){return _s(S,s)}function $(i,o){return{type:"literal",text:i,ignoreCase:o}}function Je(i,o,f){return{type:"class",parts:i,inverted:o,ignoreCase:f}}function q2(){return{type:"any"}}function G2(){return{type:"end"}}function ae(i){return{type:"other",description:i}}function yu(i){var o=xr[i],f;if(o)return o;for(f=i-1;!xr[f];)f--;for(o=xr[f],o={line:o.line,column:o.column};f<i;)r.charCodeAt(f)===10?(o.line++,o.column=1):o.column++,f++;return xr[i]=o,o}function _s(i,o){var f=yu(i),c=yu(o);return{source:n,start:{offset:i,line:f.line,column:f.column},end:{offset:o,line:c.line,column:c.column}}}function A(i){s<dt||(s>dt&&(dt=s,Ls=[]),Ls.push(i))}function j2(i,o,f){return new ii(ii.buildMessage(i,o),i,o,f)}function xu(){var i,o,f,c=s*309+0,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=j(),f=Gw(),f!==e?(S=i,i=$b(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function bu(){var i,o,f,c=s*309+1,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===h?(o=h,s+=9):(o=e,w===0&&A(J0)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function wu(){var i,o,f,c=s*309+2,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===d?(o=d,s+=7):(o=e,w===0&&A(Z0)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Bs(){var i,o,f,c=s*309+3,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===p?(o=p,s+=5):(o=e,w===0&&A(Q0)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ku(){var i,o,f,c=s*309+4,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===g?(o=g,s+=4):(o=e,w===0&&A(ev)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Su(){var i,o,f,c=s*309+5,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===m?(o=m,s+=5):(o=e,w===0&&A(tv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Au(){var i,o,f,c=s*309+6,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===y?(o=y,s+=6):(o=e,w===0&&A(iv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Pu(){var i,o,f,c=s*309+7,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,3)===b?(o=b,s+=3):(o=e,w===0&&A(rv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function $u(){var i,o,f,c=s*309+8,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===k?(o=k,s+=4):(o=e,w===0&&A(sv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Cu(){var i,o,f,c=s*309+9,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===C?(o=C,s+=5):(o=e,w===0&&A(nv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Mu(){var i,o,f,c=s*309+10,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===O?(o=O,s+=8):(o=e,w===0&&A(lv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Tu(){var i,o,f,c=s*309+11,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===M?(o=M,s+=2):(o=e,w===0&&A(ov)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Du(){var i,o,f,c=s*309+12,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===I?(o=I,s+=4):(o=e,w===0&&A(av)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Eu(){var i,o,f,c=s*309+13,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,3)===L?(o=L,s+=3):(o=e,w===0&&A(fv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ru(){var i,o,f,c=s*309+14,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===F?(o=F,s+=2):(o=e,w===0&&A(uv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ou(){var i,o,f,c=s*309+15,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===N?(o=N,s+=7):(o=e,w===0&&A(hv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Iu(){var i,o,f,c=s*309+16,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===H?(o=H,s+=6):(o=e,w===0&&A(cv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Nu(){var i,o,f,c=s*309+17,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===W?(o=W,s+=6):(o=e,w===0&&A(dv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Lu(){var i,o,f,c=s*309+18,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Z?(o=Z,s+=4):(o=e,w===0&&A(pv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function _u(){var i,o,f,c=s*309+19,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===re?(o=re,s+=7):(o=e,w===0&&A(gv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Bu(){var i,o,f,c=s*309+20,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===X?(o=X,s+=10):(o=e,w===0&&A(mv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Fu(){var i,o,f,c=s*309+21,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===J?(o=J,s+=5):(o=e,w===0&&A(vv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Vu(){var i,o,f,c=s*309+22,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===ie?(o=ie,s+=5):(o=e,w===0&&A(yv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Hu(){var i,o,f,c=s*309+23,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===me?(o=me,s+=5):(o=e,w===0&&A(xv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Wu(){var i,o,f,c=s*309+24,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===ke?(o=ke,s+=5):(o=e,w===0&&A(bv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function zu(){var i,o,f,c=s*309+25,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===We?(o=We,s+=5):(o=e,w===0&&A(wv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Uu(){var i,o,f,c=s*309+26,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===De?(o=De,s+=5):(o=e,w===0&&A(kv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function qu(){var i,o,f,c=s*309+27,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===it?(o=it,s+=5):(o=e,w===0&&A(Sv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Gu(){var i,o,f,c=s*309+28,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Bi?(o=Bi,s+=5):(o=e,w===0&&A(Av)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ju(){var i,o,f,c=s*309+29,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===ot?(o=ot,s+=5):(o=e,w===0&&A(Pv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ku(){var i,o,f,c=s*309+30,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Ge?(o=Ge,s+=4):(o=e,w===0&&A($v)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Xu(){var i,o,f,c=s*309+31,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===rt?(o=rt,s+=4):(o=e,w===0&&A(Cv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Yu(){var i,o,f,c=s*309+32,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===ct?(o=ct,s+=4):(o=e,w===0&&A(Mv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ju(){var i,o,f,c=s*309+33,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Pt?(o=Pt,s+=4):(o=e,w===0&&A(Tv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Zu(){var i,o,f,c=s*309+34,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Xt?(o=Xt,s+=4):(o=e,w===0&&A(Dv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Qu(){var i,o,f,c=s*309+35,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Fi?(o=Fi,s+=4):(o=e,w===0&&A(Ev)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function eh(){var i,o,f,c=s*309+36,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===ao?(o=ao,s+=8):(o=e,w===0&&A(Rv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Fs(){var i,o,f,c=s*309+37,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===fo?(o=fo,s+=2):(o=e,w===0&&A(Ov)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Vs(){var i,o,f,c=s*309+38,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,3)===uo?(o=uo,s+=3):(o=e,w===0&&A(Iv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Hs(){var i,o,f,c=s*309+39,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===ho?(o=ho,s+=5):(o=e,w===0&&A(Nv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function th(){var i,o,f,c=s*309+40,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===co?(o=co,s+=7):(o=e,w===0&&A(Lv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ih(){var i,o,f,c=s*309+41,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===po?(o=po,s+=5):(o=e,w===0&&A(_v)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function rh(){var i,o,f,c=s*309+42,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===go?(o=go,s+=6):(o=e,w===0&&A(Bv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function sh(){var i,o,f,c=s*309+43,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===mo?(o=mo,s+=6):(o=e,w===0&&A(Fv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ws(){var i,o,f,c=s*309+44,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===vo?(o=vo,s+=6):(o=e,w===0&&A(Vv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function zs(){var i,o,f,c=s*309+45,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===yo?(o=yo,s+=8):(o=e,w===0&&A(Hv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Us(){var i,o,f,c=s*309+46,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===xo?(o=xo,s+=8):(o=e,w===0&&A(Wv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function qs(){var i,o,f,c=s*309+47,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===bo?(o=bo,s+=8):(o=e,w===0&&A(zv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Gs(){var i,o,f,c=s*309+48,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===wo?(o=wo,s+=8):(o=e,w===0&&A(Uv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function js(){var i,o,f,c=s*309+49,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===ko?(o=ko,s+=9):(o=e,w===0&&A(qv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function nh(){var i,o,f,c=s*309+50,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===So?(o=So,s+=5):(o=e,w===0&&A(Gv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function lh(){var i,o,f,c=s*309+51,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Ao?(o=Ao,s+=5):(o=e,w===0&&A(jv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function oh(){var i,o,f,c=s*309+52,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Po?(o=Po,s+=5):(o=e,w===0&&A(Kv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ah(){var i,o,f,c=s*309+53,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===$o?(o=$o,s+=5):(o=e,w===0&&A(Xv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function fh(){var i,o,f,c=s*309+54,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Co?(o=Co,s+=5):(o=e,w===0&&A(Yv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function uh(){var i,o,f,c=s*309+55,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Mo?(o=Mo,s+=5):(o=e,w===0&&A(Jv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function hh(){var i,o,f,c=s*309+56,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===To?(o=To,s+=13):(o=e,w===0&&A(Zv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ch(){var i,o,f,c=s*309+57,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Do?(o=Do,s+=4):(o=e,w===0&&A(Qv)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function dh(){var i,o,f,c=s*309+58,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Eo?(o=Eo,s+=6):(o=e,w===0&&A(e1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ph(){var i,o,f,c=s*309+59,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Ro?(o=Ro,s+=6):(o=e,w===0&&A(t1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function gh(){var i,o,f,c=s*309+60,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Oo?(o=Oo,s+=6):(o=e,w===0&&A(i1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function mh(){var i,o,f,c=s*309+61,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Io?(o=Io,s+=6):(o=e,w===0&&A(r1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function vh(){var i,o,f,c=s*309+62,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===No?(o=No,s+=6):(o=e,w===0&&A(s1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function yh(){var i,o,f,c=s*309+63,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Lo?(o=Lo,s+=6):(o=e,w===0&&A(n1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function xh(){var i,o,f,c=s*309+64,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===_o?(o=_o,s+=6):(o=e,w===0&&A(l1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function bh(){var i,o,f,c=s*309+65,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Bo?(o=Bo,s+=6):(o=e,w===0&&A(o1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function wh(){var i,o,f,c=s*309+66,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Fo?(o=Fo,s+=6):(o=e,w===0&&A(a1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function kh(){var i,o,f,c=s*309+67,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Vo?(o=Vo,s+=6):(o=e,w===0&&A(f1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Sh(){var i,o,f,c=s*309+68,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===Ho?(o=Ho,s+=6):(o=e,w===0&&A(u1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ah(){var i,o,f,c=s*309+69,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Wo?(o=Wo,s+=7):(o=e,w===0&&A(h1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ph(){var i,o,f,c=s*309+70,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===zo?(o=zo,s+=7):(o=e,w===0&&A(c1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function $h(){var i,o,f,c=s*309+71,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Uo?(o=Uo,s+=7):(o=e,w===0&&A(d1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ch(){var i,o,f,c=s*309+72,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===qo?(o=qo,s+=7):(o=e,w===0&&A(p1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Mh(){var i,o,f,c=s*309+73,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Go?(o=Go,s+=7):(o=e,w===0&&A(g1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Th(){var i,o,f,c=s*309+74,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===jo?(o=jo,s+=7):(o=e,w===0&&A(m1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Dh(){var i,o,f,c=s*309+75,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Ko?(o=Ko,s+=7):(o=e,w===0&&A(v1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Eh(){var i,o,f,c=s*309+76,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Xo?(o=Xo,s+=7):(o=e,w===0&&A(y1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Rh(){var i,o,f,c=s*309+77,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Yo?(o=Yo,s+=7):(o=e,w===0&&A(x1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Oh(){var i,o,f,c=s*309+78,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,11)===Jo?(o=Jo,s+=11):(o=e,w===0&&A(b1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ih(){var i,o,f,c=s*309+79,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===Zo?(o=Zo,s+=9):(o=e,w===0&&A(w1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Nh(){var i,o,f,c=s*309+80,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===Qo?(o=Qo,s+=9):(o=e,w===0&&A(k1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Lh(){var i,o,f,c=s*309+81,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===ea?(o=ea,s+=9):(o=e,w===0&&A(S1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function _h(){var i,o,f,c=s*309+82,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,11)===ta?(o=ta,s+=11):(o=e,w===0&&A(A1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Bh(){var i,o,f,c=s*309+83,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===ia?(o=ia,s+=15):(o=e,w===0&&A(P1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Fh(){var i,o,f,c=s*309+84,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===ra?(o=ra,s+=15):(o=e,w===0&&A($1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Vh(){var i,o,f,c=s*309+85,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,17)===sa?(o=sa,s+=17):(o=e,w===0&&A(C1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Hh(){var i,o,f,c=s*309+86,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===na?(o=na,s+=14):(o=e,w===0&&A(M1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Wh(){var i,o,f,c=s*309+87,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===la?(o=la,s+=14):(o=e,w===0&&A(T1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function zh(){var i,o,f,c=s*309+88,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,20)===oa?(o=oa,s+=20):(o=e,w===0&&A(D1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Uh(){var i,o,f,c=s*309+89,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,20)===aa?(o=aa,s+=20):(o=e,w===0&&A(E1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function qh(){var i,o,f,c=s*309+90,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===fa?(o=fa,s+=10):(o=e,w===0&&A(R1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Gh(){var i,o,f,c=s*309+91,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===ua?(o=ua,s+=10):(o=e,w===0&&A(O1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function jh(){var i,o,f,c=s*309+92,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===ha?(o=ha,s+=10):(o=e,w===0&&A(I1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Kh(){var i,o,f,c=s*309+93,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===ca?(o=ca,s+=12):(o=e,w===0&&A(N1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Xh(){var i,o,f,c=s*309+94,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===da?(o=da,s+=15):(o=e,w===0&&A(L1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Yh(){var i,o,f,c=s*309+95,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===pa?(o=pa,s+=15):(o=e,w===0&&A(_1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Jh(){var i,o,f,c=s*309+96,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===ga?(o=ga,s+=10):(o=e,w===0&&A(B1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Zh(){var i,o,f,c=s*309+97,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===ma?(o=ma,s+=10):(o=e,w===0&&A(F1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Qh(){var i,o,f,c=s*309+98,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===va?(o=va,s+=10):(o=e,w===0&&A(V1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ec(){var i,o,f,c=s*309+99,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===ya?(o=ya,s+=12):(o=e,w===0&&A(H1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function tc(){var i,o,f,c=s*309+100,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===xa?(o=xa,s+=15):(o=e,w===0&&A(W1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ic(){var i,o,f,c=s*309+101,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===ba?(o=ba,s+=15):(o=e,w===0&&A(z1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function rc(){var i,o,f,c=s*309+102,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===wa?(o=wa,s+=13):(o=e,w===0&&A(U1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function sc(){var i,o,f,c=s*309+103,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,19)===ka?(o=ka,s+=19):(o=e,w===0&&A(q1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function nc(){var i,o,f,c=s*309+104,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===Sa?(o=Sa,s+=14):(o=e,w===0&&A(G1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function lc(){var i,o,f,c=s*309+105,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===Aa?(o=Aa,s+=14):(o=e,w===0&&A(j1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function oc(){var i,o,f,c=s*309+106,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===Pa?(o=Pa,s+=13):(o=e,w===0&&A(K1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ac(){var i,o,f,c=s*309+107,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===$a?(o=$a,s+=14):(o=e,w===0&&A(X1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function fc(){var i,o,f,c=s*309+108,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===Ca?(o=Ca,s+=14):(o=e,w===0&&A(Y1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function uc(){var i,o,f,c=s*309+109,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,16)===Ma?(o=Ma,s+=16):(o=e,w===0&&A(J1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function hc(){var i,o,f,c=s*309+110,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,22)===Ta?(o=Ta,s+=22):(o=e,w===0&&A(Z1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function cc(){var i,o,f,c=s*309+111,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,17)===Da?(o=Da,s+=17):(o=e,w===0&&A(Q1)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function dc(){var i,o,f,c=s*309+112,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,17)===Ea?(o=Ea,s+=17):(o=e,w===0&&A(ey)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function pc(){var i,o,f,c=s*309+113,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,11)===Ra?(o=Ra,s+=11):(o=e,w===0&&A(ty)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function gc(){var i,o,f,c=s*309+114,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===Oa?(o=Oa,s+=12):(o=e,w===0&&A(iy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function mc(){var i,o,f,c=s*309+115,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===Ia?(o=Ia,s+=12):(o=e,w===0&&A(ry)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function vc(){var i,o,f,c=s*309+116,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,16)===Na?(o=Na,s+=16):(o=e,w===0&&A(sy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function yc(){var i,o,f,c=s*309+117,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,17)===La?(o=La,s+=17):(o=e,w===0&&A(ny)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function xc(){var i,o,f,c=s*309+118,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,17)===_a?(o=_a,s+=17):(o=e,w===0&&A(ly)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function bc(){var i,o,f,c=s*309+119,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Ba?(o=Ba,s+=7):(o=e,w===0&&A(oy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function wc(){var i,o,f,c=s*309+120,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===Fa?(o=Fa,s+=8):(o=e,w===0&&A(ay)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function kc(){var i,o,f,c=s*309+121,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===Va?(o=Va,s+=8):(o=e,w===0&&A(fy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Sc(){var i,o,f,c=s*309+122,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Ha?(o=Ha,s+=7):(o=e,w===0&&A(uy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ac(){var i,o,f,c=s*309+123,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===Wa?(o=Wa,s+=8):(o=e,w===0&&A(hy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Pc(){var i,o,f,c=s*309+124,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===za?(o=za,s+=8):(o=e,w===0&&A(cy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function $c(){var i,o,f,c=s*309+125,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Ua?(o=Ua,s+=7):(o=e,w===0&&A(dy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Cc(){var i,o,f,c=s*309+126,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===qa?(o=qa,s+=8):(o=e,w===0&&A(py)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Mc(){var i,o,f,c=s*309+127,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,8)===Ga?(o=Ga,s+=8):(o=e,w===0&&A(gy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Tc(){var i,o,f,c=s*309+128,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,11)===ja?(o=ja,s+=11):(o=e,w===0&&A(my)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Dc(){var i,o,f,c=s*309+129,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===Ka?(o=Ka,s+=12):(o=e,w===0&&A(vy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ec(){var i,o,f,c=s*309+130,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===Xa?(o=Xa,s+=12):(o=e,w===0&&A(yy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Rc(){var i,o,f,c=s*309+131,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===Ya?(o=Ya,s+=9):(o=e,w===0&&A(xy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Oc(){var i,o,f,c=s*309+132,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===Ja?(o=Ja,s+=10):(o=e,w===0&&A(by)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ic(){var i,o,f,c=s*309+133,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===Za?(o=Za,s+=10):(o=e,w===0&&A(wy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Nc(){var i,o,f,c=s*309+134,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,11)===Qa?(o=Qa,s+=11):(o=e,w===0&&A(ky)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Lc(){var i,o,f,c=s*309+135,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===ef?(o=ef,s+=12):(o=e,w===0&&A(Sy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function _c(){var i,o,f,c=s*309+136,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===tf?(o=tf,s+=12):(o=e,w===0&&A(Ay)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Bc(){var i,o,f,c=s*309+137,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===rf?(o=rf,s+=12):(o=e,w===0&&A(Py)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Fc(){var i,o,f,c=s*309+138,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===sf?(o=sf,s+=13):(o=e,w===0&&A($y)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Vc(){var i,o,f,c=s*309+139,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===nf?(o=nf,s+=13):(o=e,w===0&&A(Cy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Hc(){var i,o,f,c=s*309+140,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,12)===lf?(o=lf,s+=12):(o=e,w===0&&A(My)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Wc(){var i,o,f,c=s*309+141,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===of?(o=of,s+=13):(o=e,w===0&&A(Ty)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function zc(){var i,o,f,c=s*309+142,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===af?(o=af,s+=13):(o=e,w===0&&A(Dy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Uc(){var i,o,f,c=s*309+143,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,14)===ff?(o=ff,s+=14):(o=e,w===0&&A(Ey)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function qc(){var i,o,f,c=s*309+144,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===uf?(o=uf,s+=15):(o=e,w===0&&A(Ry)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Gc(){var i,o,f,c=s*309+145,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===hf?(o=hf,s+=15):(o=e,w===0&&A(Oy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function jc(){var i,o,f,c=s*309+146,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===cf?(o=cf,s+=9):(o=e,w===0&&A(Iy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Kc(){var i,o,f,c=s*309+147,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===df?(o=df,s+=10):(o=e,w===0&&A(Ny)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Xc(){var i,o,f,c=s*309+148,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,10)===pf?(o=pf,s+=10):(o=e,w===0&&A(Ly)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Yc(){var i,o,f,c=s*309+149,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,13)===gf?(o=gf,s+=13):(o=e,w===0&&A(_y)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Jc(){var i,o,f,c=s*309+150,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===mf?(o=mf,s+=15):(o=e,w===0&&A(By)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Zc(){var i,o,f,c=s*309+151,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,15)===vf?(o=vf,s+=15):(o=e,w===0&&A(Fy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Qc(){var i,o,f,c=s*309+152,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,6)===yf?(o=yf,s+=6):(o=e,w===0&&A(Vy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ks(){var i,o,f,c=s*309+153,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===xf?(o=xf,s+=4):(o=e,w===0&&A(Hy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Xs(){var i,o,f,c=s*309+154,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===bf?(o=bf,s+=5):(o=e,w===0&&A(Wy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ed(){var i,o,f,c=s*309+155,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===wf?(o=wf,s+=9):(o=e,w===0&&A(zy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function td(){var i,o,f,c=s*309+156,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===kf?(o=kf,s+=7):(o=e,w===0&&A(Uy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function id(){var i,o,f,c=s*309+157,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,5)===Sf?(o=Sf,s+=5):(o=e,w===0&&A(qy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function rd(){var i,o,f,c=s*309+158,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,7)===Af?(o=Af,s+=7):(o=e,w===0&&A(Gy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function sd(){var i,o,f,c=s*309+159,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Pf?(o=Pf,s+=4):(o=e,w===0&&A(jy)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function nd(){var i,o,f,c=s*309+160,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,9)===$f?(o=$f,s+=9):(o=e,w===0&&A(Ky)),o!==e?(f=R(),f!==e?(S=i,i=E(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function K2(){var i,o,f,c=s*309+161,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Cd(),o!==e?(f=j(),S=i,i=Cb(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function X2(){var i,o,f,c=s*309+162,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Cd(),o!==e?(f=j(),S=i,i=Mb(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Y2(){var i,o,f,c=s*309+163,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=$d(),o!==e?(f=j(),S=i,i=Tb(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function J2(){var i,o,f,c=s*309+164,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=$d(),o!==e?(f=j(),S=i,i=Db(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Z2(){var i,o,f,c=s*309+165,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,4)===Cf?(o=Cf,s+=4):(o=e,w===0&&A(Xy)),o===e&&(r.substr(s,5)===Mf?(o=Mf,s+=5):(o=e,w===0&&A(Yy))),o!==e?(f=j(),S=i,i=Eb(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ld(){var i,o=s*309+166,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=bu(),i===e&&(i=wu(),i===e&&(i=Bs(),i===e&&(i=ku(),i===e&&(i=Su(),i===e&&(i=Au(),i===e&&(i=Pu(),i===e&&(i=$u(),i===e&&(i=Cu(),i===e&&(i=Mu(),i===e&&(i=Tu(),i===e&&(i=Du(),i===e&&(i=Eu(),i===e&&(i=Ru(),i===e&&(i=Ou(),i===e&&(i=Iu(),i===e&&(i=Nu(),i===e&&(i=Lu(),i===e&&(i=_u(),i===e&&(i=Bu(),i===e&&(i=Fu(),i===e&&(i=Vu(),i===e&&(i=Hu(),i===e&&(i=Wu(),i===e&&(i=zu(),i===e&&(i=Uu(),i===e&&(i=qu(),i===e&&(i=Gu(),i===e&&(i=ju(),i===e&&(i=Ku(),i===e&&(i=Xu(),i===e&&(i=Yu(),i===e&&(i=Ju(),i===e&&(i=Zu(),i===e&&(i=Qu(),i===e&&(i=eh(),i===e&&(i=Fs(),i===e&&(i=Vs(),i===e&&(i=Hs(),i===e&&(i=th(),i===e&&(i=ih(),i===e&&(i=rh(),i===e&&(i=sh(),i===e&&(i=Ws(),i===e&&(i=zs(),i===e&&(i=Us(),i===e&&(i=qs(),i===e&&(i=Gs(),i===e&&(i=js(),i===e&&(i=nh(),i===e&&(i=lh(),i===e&&(i=oh(),i===e&&(i=ah(),i===e&&(i=fh(),i===e&&(i=uh(),i===e&&(i=hh(),i===e&&(i=ch(),i===e&&(i=dh(),i===e&&(i=ph(),i===e&&(i=gh(),i===e&&(i=mh(),i===e&&(i=vh(),i===e&&(i=yh(),i===e&&(i=xh(),i===e&&(i=bh(),i===e&&(i=wh(),i===e&&(i=kh(),i===e&&(i=Sh(),i===e&&(i=Ah(),i===e&&(i=Ph(),i===e&&(i=$h(),i===e&&(i=Ch(),i===e&&(i=Mh(),i===e&&(i=Th(),i===e&&(i=Dh(),i===e&&(i=Eh(),i===e&&(i=Rh(),i===e&&(i=Oh(),i===e&&(i=Ih(),i===e&&(i=Nh(),i===e&&(i=Lh(),i===e&&(i=_h(),i===e&&(i=Bh(),i===e&&(i=Fh(),i===e&&(i=Vh(),i===e&&(i=Hh(),i===e&&(i=Wh(),i===e&&(i=zh(),i===e&&(i=Uh(),i===e&&(i=qh(),i===e&&(i=Gh(),i===e&&(i=jh(),i===e&&(i=Kh(),i===e&&(i=Xh(),i===e&&(i=Yh(),i===e&&(i=Jh(),i===e&&(i=Zh(),i===e&&(i=Qh(),i===e&&(i=ec(),i===e&&(i=tc(),i===e&&(i=ic(),i===e&&(i=rc(),i===e&&(i=sc(),i===e&&(i=nc(),i===e&&(i=lc(),i===e&&(i=oc(),i===e&&(i=ac(),i===e&&(i=fc(),i===e&&(i=uc(),i===e&&(i=hc(),i===e&&(i=cc(),i===e&&(i=dc(),i===e&&(i=pc(),i===e&&(i=gc(),i===e&&(i=mc(),i===e&&(i=vc(),i===e&&(i=yc(),i===e&&(i=xc(),i===e&&(i=bc(),i===e&&(i=wc(),i===e&&(i=kc(),i===e&&(i=Sc(),i===e&&(i=Ac(),i===e&&(i=Pc(),i===e&&(i=$c(),i===e&&(i=Cc(),i===e&&(i=Mc(),i===e&&(i=Tc(),i===e&&(i=Dc(),i===e&&(i=Ec(),i===e&&(i=Rc(),i===e&&(i=Oc(),i===e&&(i=Ic(),i===e&&(i=Nc(),i===e&&(i=Lc(),i===e&&(i=_c(),i===e&&(i=Bc(),i===e&&(i=Fc(),i===e&&(i=Vc(),i===e&&(i=Hc(),i===e&&(i=Wc(),i===e&&(i=zc(),i===e&&(i=Uc(),i===e&&(i=qc(),i===e&&(i=Gc(),i===e&&(i=jc(),i===e&&(i=Kc(),i===e&&(i=Xc(),i===e&&(i=Yc(),i===e&&(i=Jc(),i===e&&(i=Zc(),i===e&&(i=Qc(),i===e&&(i=Ks(),i===e&&(i=Xs(),i===e&&(i=ed(),i===e&&(i=td(),i===e&&(i=id(),i===e&&(i=rd(),i===e&&(i=sd(),i===e&&(i=nd()))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))),w--,i===e&&w===0&&A(Jy),v[o]={nextPos:s,result:i},i)}function od(){var i,o,f,c=s*309+167,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Tf?(o=Tf,s+=2):(o=e,w===0&&A(Zy)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ad(){var i,o,f,c=s*309+168,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Df?(o=Df,s+=2):(o=e,w===0&&A(Qy)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function fd(){var i,o,f,c=s*309+169,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Ef?(o=Ef,s+=2):(o=e,w===0&&A(ex)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ud(){var i,o,f,c=s*309+170,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Rf?(o=Rf,s+=2):(o=e,w===0&&A(tx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function hd(){var i,o,f,c=s*309+171,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Of?(o=Of,s+=2):(o=e,w===0&&A(ix)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function cd(){var i,o,f,c=s*309+172,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===If?(o=If,s+=2):(o=e,w===0&&A(rx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function dd(){var i,o,f,c=s*309+173,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Nf?(o=Nf,s+=2):(o=e,w===0&&A(sx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function pd(){var i,o,f,c=s*309+174,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Lf?(o=Lf,s+=2):(o=e,w===0&&A(nx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function gd(){var i,o,f,c=s*309+175,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===_f?(o=_f,s+=2):(o=e,w===0&&A(lx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function md(){var i,o,f,c=s*309+176,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Bf?(o=Bf,s+=2):(o=e,w===0&&A(ox)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function vd(){var i,o,f,c=s*309+177,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Ff?(o=Ff,s+=2):(o=e,w===0&&A(ax)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Q2(){var i,o,f,c=s*309+178,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Vf?(o=Vf,s+=2):(o=e,w===0&&A(fx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ew(){var i,o,f,c=s*309+179,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Hf?(o=Hf,s+=2):(o=e,w===0&&A(ux)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function tw(){var i,o,f,c=s*309+180,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Wf?(o=Wf,s+=2):(o=e,w===0&&A(hx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function iw(){var i,o,f,c=s*309+181,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===zf?(o=zf,s+=2):(o=e,w===0&&A(cx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function rw(){var i,o,f,c=s*309+182,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,3)===Uf?(o=Uf,s+=3):(o=e,w===0&&A(dx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function sw(){var i,o,f,c=s*309+183,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,3)===qf?(o=qf,s+=3):(o=e,w===0&&A(px)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function nw(){var i,o,f,c=s*309+184,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Gf?(o=Gf,s+=2):(o=e,w===0&&A(gx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function lw(){var i,o,f,c=s*309+185,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===jf?(o=jf,s+=2):(o=e,w===0&&A(mx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ow(){var i,o,f,c=s*309+186,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Kf?(o=Kf,s+=2):(o=e,w===0&&A(vx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function aw(){var i,o,f,c=s*309+187,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.substr(s,2)===Xf?(o=Xf,s+=2):(o=e,w===0&&A(yx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ze(){var i,o,f,c=s*309+188,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===40?(o=x0,s++):(o=e,w===0&&A(xx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function nt(){var i,o,f,c=s*309+189,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===41?(o=b0,s++):(o=e,w===0&&A(bx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ys(){var i,o,f,c=s*309+190,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===91?(o=w0,s++):(o=e,w===0&&A(wx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Js(){var i,o,f,c=s*309+191,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===93?(o=k0,s++):(o=e,w===0&&A(kx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function fi(){var i,o,f,c=s*309+192,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===123?(o=S0,s++):(o=e,w===0&&A(Sx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ui(){var i,o,f,c=s*309+193,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===125?(o=A0,s++):(o=e,w===0&&A(Ax)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function fw(){var i,o,f,c=s*309+194,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===46?(o=Yf,s++):(o=e,w===0&&A(nu)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Pe(){var i,o,f,c=s*309+195,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===44?(o=P0,s++):(o=e,w===0&&A(Px)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Zs(){var i,o,f,c=s*309+196,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===58?(o=$0,s++):(o=e,w===0&&A($x)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Vi(){var i,o,f,c=s*309+197,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===61?(o=C0,s++):(o=e,w===0&&A(Cx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ze(){var i,o,f,c=s*309+198,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===59?(o=M0,s++):(o=e,w===0&&A(Mx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function uw(){var i,o,f,c=s*309+199,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===33?(o=T0,s++):(o=e,w===0&&A(Tx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Qs(){var i,o,f,c=s*309+200,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===45?(o=D0,s++):(o=e,w===0&&A(Dx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function hw(){var i,o,f,c=s*309+201,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===126?(o=E0,s++):(o=e,w===0&&A(Ex)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function en(){var i,o,f,c=s*309+202,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===43?(o=R0,s++):(o=e,w===0&&A(Rx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function yd(){var i,o,f,c=s*309+203,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===42?(o=O0,s++):(o=e,w===0&&A(Ox)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function xd(){var i,o,f,c=s*309+204,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===47?(o=I0,s++):(o=e,w===0&&A(Ix)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function bd(){var i,o,f,c=s*309+205,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===37?(o=N0,s++):(o=e,w===0&&A(Nx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function wd(){var i,o,f,c=s*309+206,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===60?(o=L0,s++):(o=e,w===0&&A(Lx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function kd(){var i,o,f,c=s*309+207,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===62?(o=_0,s++):(o=e,w===0&&A(_x)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Sd(){var i,o,f,c=s*309+208,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===124?(o=B0,s++):(o=e,w===0&&A(Bx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Ad(){var i,o,f,c=s*309+209,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===94?(o=F0,s++):(o=e,w===0&&A(Fx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Pd(){var i,o,f,c=s*309+210,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===38?(o=V0,s++):(o=e,w===0&&A(Vx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function cw(){var i,o,f,c=s*309+211,u=v[c];return u?(s=u.nextPos,u.result):(i=s,r.charCodeAt(s)===63?(o=H0,s++):(o=e,w===0&&A(Hx)),o!==e?(f=j(),S=i,i=Y(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Le(){var i,o,f,c,u,x,P,D=s*309+212,G=v[D];if(G)return s=G.nextPos,G.result;if(i=s,o=s,w++,f=ld(),w--,f===e?o=void 0:(s=o,o=e),o!==e){if(f=s,c=s,z0.test(r.charAt(s))?(u=r.charAt(s),s++):(u=e,w===0&&A(Wx)),u!==e){for(x=[],Os.test(r.charAt(s))?(P=r.charAt(s),s++):(P=e,w===0&&A(Is));P!==e;)x.push(P),Os.test(r.charAt(s))?(P=r.charAt(s),s++):(P=e,w===0&&A(Is));u=[u,x],c=u}else s=c,c=e;c!==e?f=r.substring(f,s):f=c,f!==e?(c=j(),S=i,i=Rb(f,c)):(s=i,i=e)}else s=i,i=e;return v[D]={nextPos:s,result:i},i}function wr(){var i,o,f,c=s*309+213,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=s,w++,f=ld(),w--,f===e?o=void 0:(s=o,o=e),o!==e?(f=Le(),f!==e?(S=i,i=Ob(f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function $d(){var i,o,f,c,u=s*309+214,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=s,f=gw(),f!==e?(c=tn(),c===e&&(c=null),f=[f,c],o=f):(s=o,o=e),o!==e?i=r.substring(i,s):i=o,i===e&&(i=s,o=s,f=dw(),f!==e?(c=tn(),c===e&&(c=null),f=[f,c],o=f):(s=o,o=e),o!==e?i=r.substring(i,s):i=o,i===e&&(i=s,o=s,f=pw(),f!==e?(c=tn(),c===e&&(c=null),f=[f,c],o=f):(s=o,o=e),o!==e?i=r.substring(i,s):i=o)),v[u]={nextPos:s,result:i},i)}function tn(){var i,o=s*309+215,f=v[o];return f?(s=f.nextPos,f.result):(U0.test(r.charAt(s))?(i=r.charAt(s),s++):(i=e,w===0&&A(zx)),v[o]={nextPos:s,result:i},i)}function dw(){var i,o,f,c,u,x=s*309+216,P=v[x];if(P)return s=P.nextPos,P.result;if(i=s,o=s,q0.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(Ux)),f!==e){for(c=[],u=kr();u!==e;)c.push(u),u=kr();f=[f,c],o=f}else s=o,o=e;return o!==e?i=r.substring(i,s):i=o,v[x]={nextPos:s,result:i},i}function pw(){var i,o,f,c,u=s*309+217,x=v[u];if(x)return s=x.nextPos,x.result;if(i=s,r.charCodeAt(s)===48?(o=Jf,s++):(o=e,w===0&&A(lu)),o!==e){for(f=[],iu.test(r.charAt(s))?(c=r.charAt(s),s++):(c=e,w===0&&A(ou));c!==e;)f.push(c),iu.test(r.charAt(s))?(c=r.charAt(s),s++):(c=e,w===0&&A(ou));o=[o,f],i=o}else s=i,i=e;return v[u]={nextPos:s,result:i},i}function gw(){var i,o,f,c,u,x=s*309+218,P=v[x];if(P)return s=P.nextPos,P.result;if(i=s,r.charCodeAt(s)===48?(o=Jf,s++):(o=e,w===0&&A(lu)),o!==e)if(G0.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(qx)),f!==e){for(c=[],ru.test(r.charAt(s))?(u=r.charAt(s),s++):(u=e,w===0&&A(au));u!==e;)c.push(u),ru.test(r.charAt(s))?(u=r.charAt(s),s++):(u=e,w===0&&A(au));o=[o,f,c],i=o}else s=i,i=e;else s=i,i=e;return v[x]={nextPos:s,result:i},i}function kr(){var i,o=s*309+219,f=v[o];return f?(s=f.nextPos,f.result):(j0.test(r.charAt(s))?(i=r.charAt(s),s++):(i=e,w===0&&A(Gx)),v[o]={nextPos:s,result:i},i)}function Cd(){var i,o,f,c,u,x=s*309+220,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=s,f=mw(),f!==e?(c=Md(),c===e&&(c=null),u=Td(),u===e&&(u=null),f=[f,c,u],o=f):(s=o,o=e),o!==e?i=r.substring(i,s):i=o,i===e&&(i=s,o=s,f=Sr(),f!==e?(c=Md(),c!==e?(u=Td(),u===e&&(u=null),f=[f,c,u],o=f):(s=o,o=e)):(s=o,o=e),o!==e?i=r.substring(i,s):i=o),v[x]={nextPos:s,result:i},i)}function mw(){var i,o,f,c,u,x=s*309+221,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=s,f=Sr(),f===e&&(f=null),r.charCodeAt(s)===46?(c=Yf,s++):(c=e,w===0&&A(nu)),c!==e?(u=Sr(),u===e&&(u=null),f=[f,c,u],o=f):(s=o,o=e),o!==e?i=r.substring(i,s):i=o,v[x]={nextPos:s,result:i},i)}function Md(){var i,o,f,c,u,x=s*309+222,P=v[x];return P?(s=P.nextPos,P.result):(w++,i=s,o=s,K0.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(Kx)),f!==e?(X0.test(r.charAt(s))?(c=r.charAt(s),s++):(c=e,w===0&&A(Xx)),c===e&&(c=null),u=Sr(),u!==e?(f=[f,c,u],o=f):(s=o,o=e)):(s=o,o=e),o!==e?i=r.substring(i,s):i=o,w--,i===e&&(o=e,w===0&&A(jx)),v[x]={nextPos:s,result:i},i)}function Sr(){var i,o,f,c=s*309+223,u=v[c];if(u)return s=u.nextPos,u.result;if(i=s,o=[],f=kr(),f!==e)for(;f!==e;)o.push(f),f=kr();else o=e;return o!==e?i=r.substring(i,s):i=o,v[c]={nextPos:s,result:i},i}function Td(){var i,o=s*309+224,f=v[o];return f?(s=f.nextPos,f.result):(Y0.test(r.charAt(s))?(i=r.charAt(s),s++):(i=e,w===0&&A(Yx)),i===e&&(r.substr(s,2)===Zf?(i=Zf,s+=2):(i=e,w===0&&A(Jx)),i===e&&(r.substr(s,2)===Qf?(i=Qf,s+=2):(i=e,w===0&&A(Zx)))),v[o]={nextPos:s,result:i},i)}function vw(){var i,o,f,c,u=s*309+225,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=K2(),i===e&&(i=Y2(),i===e&&(i=J2(),i===e&&(i=Z2(),i===e&&(i=X2(),i===e&&(i=s,o=Ze(),o!==e?(f=at(),f!==e?(c=nt(),c!==e?(S=i,i=Ib(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Le(),o!==e&&(S=i,o=Nb(o)),i=o)))))),w--,i===e&&(o=e,w===0&&A(Qx)),v[u]={nextPos:s,result:i},i)}function yw(){var i,o,f,c,u,x=s*309+226,P=v[x];if(P)return s=P.nextPos,P.result;if(i=s,o=s,f=xw(),f!==e){for(c=[],u=Ar();u!==e;)c.push(u),u=Ar();f=[f,c],o=f}else s=o,o=e;if(o===e)if(o=s,f=vw(),f!==e){for(c=[],u=Ar();u!==e;)c.push(u),u=Ar();f=[f,c],o=f}else s=o,o=e;return o!==e&&(S=i,o=Lb(o)),i=o,v[x]={nextPos:s,result:i},i}function Ar(){var i,o=s*309+227,f=v[o];return f?(s=f.nextPos,f.result):(i=Dd(),i===e&&(i=Ed(),i===e&&(i=fd(),i===e&&(i=ud()))),v[o]={nextPos:s,result:i},i)}function Dd(){var i,o,f,c,u=s*309+228,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=Ys(),o!==e?(f=at(),f!==e?(c=Js(),c!==e?(S=i,i=_b(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),v[u]={nextPos:s,result:i},i)}function Ed(){var i,o,f,c=s*309+229,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=fw(),o!==e?(f=Le(),f!==e?(S=i,i=Bb(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function xw(){var i,o,f,c,u=s*309+230,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=bw(),o!==e?(f=Rd(),f===e&&(f=null),c=nt(),c!==e?(S=i,i=Fb(o,f,c)):(s=i,i=e)):(s=i,i=e),v[u]={nextPos:s,result:i},i)}function Rd(){var i,o,f,c,u,x,P=s*309+231,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=Ks(),o!==e&&(S=i,o=Vb(o)),i=o,i===e)if(i=s,o=$t(),o!==e){for(f=[],c=s,u=Pe(),u!==e?(x=$t(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Pe(),u!==e?(x=$t(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=Hb(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function bw(){var i,o,f,c,u,x=s*309+232,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=s,f=ww(),f!==e?(c=Od(),c!==e?(u=Ze(),u!==e?(S=o,o=cu(f,c,u)):(s=o,o=e)):(s=o,o=e)):(s=o,o=e),o===e&&(o=s,f=hi(),f!==e?(c=Od(),c===e&&(c=null),u=Ze(),u!==e?(S=o,o=cu(f,c,u)):(s=o,o=e)):(s=o,o=e)),o!==e&&(S=i,o=Wb(o)),i=o,v[x]={nextPos:s,result:i},i)}function Od(){var i,o=s*309+233,f=v[o];return f?(s=f.nextPos,f.result):(i=Dd(),i===e&&(i=Ed()),v[o]={nextPos:s,result:i},i)}function ww(){var i,o,f,c,u,x=s*309+234,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=hi(),o!==e?(f=Ze(),f!==e?(c=Rd(),c===e&&(c=null),u=nt(),u!==e?(S=i,i=zb(o,f,c,u)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),v[x]={nextPos:s,result:i},i)}function Hi(){var i,o,f,c=s*309+235,u=v[c];return u?(s=u.nextPos,u.result):(w++,i=yw(),i===e&&(i=s,o=fd(),o===e&&(o=ud(),o===e&&(o=en(),o===e&&(o=Qs(),o===e&&(o=uw(),o===e&&(o=hw()))))),o!==e?(f=Hi(),f!==e?(S=i,i=Ub(o,f)):(s=i,i=e)):(s=i,i=e)),w--,i===e&&(o=e,w===0&&A(eb)),v[c]={nextPos:s,result:i},i)}function rn(){var i,o,f,c,u,x,P=s*309+236,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=Hi(),o!==e){for(f=[],c=s,u=yd(),u===e&&(u=xd(),u===e&&(u=bd())),u!==e?(x=Hi(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=yd(),u===e&&(u=xd(),u===e&&(u=bd())),u!==e?(x=Hi(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function sn(){var i,o,f,c,u,x,P=s*309+237,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=rn(),o!==e){for(f=[],c=s,u=en(),u===e&&(u=Qs()),u!==e?(x=rn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=en(),u===e&&(u=Qs()),u!==e?(x=rn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function nn(){var i,o,f,c,u,x,P=s*309+238,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=sn(),o!==e){for(f=[],c=s,u=ad(),u===e&&(u=od()),u!==e?(x=sn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=ad(),u===e&&(u=od()),u!==e?(x=sn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function ln(){var i,o,f,c,u,x,P=s*309+239,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=nn(),o!==e){for(f=[],c=s,u=hd(),u===e&&(u=cd(),u===e&&(u=wd(),u===e&&(u=kd()))),u!==e?(x=nn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=hd(),u===e&&(u=cd(),u===e&&(u=wd(),u===e&&(u=kd()))),u!==e?(x=nn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function on(){var i,o,f,c,u,x,P=s*309+240,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=ln(),o!==e){for(f=[],c=s,u=dd(),u===e&&(u=pd()),u!==e?(x=ln(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=dd(),u===e&&(u=pd()),u!==e?(x=ln(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return w--,i===e&&(o=e,w===0&&A(tb)),v[P]={nextPos:s,result:i},i}function an(){var i,o,f,c,u,x,P=s*309+241,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=on(),o!==e){for(f=[],c=s,u=Pd(),u!==e?(x=on(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Pd(),u!==e?(x=on(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return w--,i===e&&(o=e,w===0&&A(ib)),v[P]={nextPos:s,result:i},i}function fn(){var i,o,f,c,u,x,P=s*309+242,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=an(),o!==e){for(f=[],c=s,u=Ad(),u!==e?(x=an(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Ad(),u!==e?(x=an(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function un(){var i,o,f,c,u,x,P=s*309+243,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=fn(),o!==e){for(f=[],c=s,u=Sd(),u!==e?(x=fn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Sd(),u!==e?(x=fn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function hn(){var i,o,f,c,u,x,P=s*309+244,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=un(),o!==e){for(f=[],c=s,u=gd(),u!==e?(x=un(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=gd(),u!==e?(x=un(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function cn(){var i,o,f,c,u,x,P=s*309+245,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=hn(),o!==e){for(f=[],c=s,u=vd(),u!==e?(x=hn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=vd(),u!==e?(x=hn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function kw(){var i,o,f,c,u,x,P=s*309+246,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=cn(),o!==e){for(f=[],c=s,u=md(),u!==e?(x=cn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=md(),u!==e?(x=cn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function Pr(){var i,o,f,c,u,x,P,D=s*309+247,G=v[D];return G?(s=G.nextPos,G.result):(i=s,o=kw(),o!==e?(f=s,c=cw(),c!==e?(u=at(),u!==e?(x=Zs(),x!==e?(P=$t(),P!==e?(S=f,f=qb(o,c,u,x,P)):(s=f,f=e)):(s=f,f=e)):(s=f,f=e)):(s=f,f=e),f===e&&(f=null),S=i,i=Gb(o,f)):(s=i,i=e),v[D]={nextPos:s,result:i},i)}function $t(){var i,o,f,c,u=s*309+248,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=Hi(),o!==e?(f=Sw(),f!==e?(c=$t(),c!==e?(S=i,i=jb(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=Pr()),v[u]={nextPos:s,result:i},i)}function Sw(){var i,o=s*309+249,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=Vi(),i===e&&(i=Q2(),i===e&&(i=ew(),i===e&&(i=iw(),i===e&&(i=tw(),i===e&&(i=aw(),i===e&&(i=rw(),i===e&&(i=sw(),i===e&&(i=nw(),i===e&&(i=lw(),i===e&&(i=ow())))))))))),w--,i===e&&w===0&&A(rb),v[o]={nextPos:s,result:i},i)}function at(){var i,o,f,c,u,x,P=s*309+250,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=$t(),o!==e){for(f=[],c=s,u=Pe(),u!==e?(x=$t(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Pe(),u!==e?(x=$t(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=st(o,f)}else s=i,i=e;return w--,i===e&&(o=e,w===0&&A(sb)),v[P]={nextPos:s,result:i},i}function dn(){var i,o,f=s*309+251,c=v[f];return c?(s=c.nextPos,c.result):(i=s,o=Aw(),o!==e&&(S=i,o=Kb(o)),i=o,v[f]={nextPos:s,result:i},i)}function Aw(){var i,o,f,c=s*309+252,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Id(),o!==e?(f=ze(),f!==e?(o=[o,f],i=o):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Cw(),o!==e?(f=ze(),f!==e?(o=[o,f],i=o):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=$w(),o!==e?(f=ze(),f!==e?(o=[o,f],i=o):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Pw(),o!==e?(f=ze(),f!==e?(o=[o,f],i=o):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Ow(),o!==e?(f=ze(),f!==e?(o=[o,f],i=o):(s=i,i=e)):(s=i,i=e))))),v[c]={nextPos:s,result:i},i)}function Pw(){var i,o,f,c,u,x,P,D=s*309+253,G=v[D];if(G)return s=G.nextPos,G.result;if(i=s,o=mn(),o!==e){for(f=Le(),f===e&&(f=null),c=[],u=s,x=Pe(),x!==e?(P=Le(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);u!==e;)c.push(u),u=s,x=Pe(),x!==e?(P=Le(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);S=i,i=Xb(o,f,c)}else s=i,i=e;return v[D]={nextPos:s,result:i},i}function $w(){var i,o,f,c,u,x,P,D=s*309+254,G=v[D];return G?(s=G.nextPos,G.result):(i=s,o=mn(),o!==e?(f=Le(),f!==e?(c=fi(),c!==e?(u=Fd(),u!==e?(x=ui(),x!==e?(P=$r(),P===e&&(P=null),S=i,i=Yb(o,f,c,u,x,P)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),v[D]={nextPos:s,result:i},i)}function Cw(){var i,o,f,c,u=s*309+255,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=nd(),o!==e?(f=vn(),f!==e?(c=hi(),c!==e?(S=i,i=Jb(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(nb)),v[u]={nextPos:s,result:i},i)}function Mw(){var i,o,f,c,u=s*309+256,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=Tw(),o!==e?(f=Nd(),f===e&&(f=null),c=nt(),c!==e?(S=i,i=Zb(o,f,c)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(lb)),v[u]={nextPos:s,result:i},i)}function Tw(){var i,o,f,c,u=s*309+257,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=Wi(),o!==e?(f=Le(),f!==e?(c=Ze(),c!==e?(S=i,i=Qb(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(ob)),v[u]={nextPos:s,result:i},i)}function Id(){var i,o,f,c,u=s*309+258,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=Dw(),o!==e?(f=Nd(),f===e&&(f=null),c=nt(),c!==e?(S=i,i=e2(o,f,c)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(ab)),v[u]={nextPos:s,result:i},i)}function Dw(){var i,o,f,c,u=s*309+259,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=Wi(),o!==e?(f=Le(),f!==e?(c=Ze(),c!==e?(S=i,i=t2(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(fb)),v[u]={nextPos:s,result:i},i)}function Nd(){var i,o,f,c,u,x,P=s*309+260,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=pn(),o!==e){for(f=[],c=s,u=Pe(),u!==e?(x=pn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Pe(),u!==e?(x=pn(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=i2(o,f)}else s=i,i=e;return w--,i===e&&(o=e,w===0&&A(ub)),v[P]={nextPos:s,result:i},i}function pn(){var i,o,f,c=s*309+261,u=v[c];if(u)return s=u.nextPos,u.result;for(w++,i=s,o=[],f=Ld();f!==e;)o.push(f),f=Ld();return f=Ew(),f===e&&(f=hi()),f!==e?(S=i,i=r2(o,f)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(hb)),v[c]={nextPos:s,result:i},i}function Ew(){var i,o,f,c,u=s*309+262,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=hi(),o!==e?(f=Le(),f!==e?(c=zi(),c===e&&(c=null),S=i,i=s2(o,f,c)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(cb)),v[u]={nextPos:s,result:i},i)}function Ld(){var i,o=s*309+263,f=v[o];return f?(s=f.nextPos,f.result):(i=Bs(),i===e&&(i=Fs(),i===e&&(i=Vs(),i===e&&(i=Hs(),i===e&&(i=Rw(),i===e&&(i=vn()))))),v[o]={nextPos:s,result:i},i)}function Rw(){var i,o=s*309+264,f=v[o];return f?(s=f.nextPos,f.result):(i=zs(),i===e&&(i=Us(),i===e&&(i=qs(),i===e&&(i=Gs(),i===e&&(i=js())))),v[o]={nextPos:s,result:i},i)}function Ow(){var i,o,f,c,u,x,P=s*309+265,D=v[P];if(D)return s=D.nextPos,D.result;if(i=s,o=Iw(),o!==e){for(f=[],c=s,u=Pe(),u!==e?(x=_d(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=Pe(),u!==e?(x=_d(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e);S=i,i=n2(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function _d(){var i,o,f,c,u,x,P=s*309+266,D=v[P];return D?(s=D.nextPos,D.result):(i=s,o=Le(),o!==e?(f=zi(),f===e&&(f=null),c=s,u=Vi(),u!==e?(x=ci(),x!==e?(u=[u,x],c=u):(s=c,c=e)):(s=c,c=e),c===e&&(c=null),S=i,i=l2(o,f,c)):(s=i,i=e),v[P]={nextPos:s,result:i},i)}function Iw(){var i,o,f,c,u,x,P,D,G=s*309+267,ve=v[G];return ve?(s=ve.nextPos,ve.result):(i=s,o=Wi(),o!==e?(f=s,c=Le(),c!==e?(u=zi(),u===e&&(u=null),x=s,P=Vi(),P!==e?(D=ci(),D!==e?(P=[P,D],x=P):(s=x,x=e)):(s=x,x=e),x===e&&(x=null),c=[c,u,x],f=c):(s=f,f=e),f===e&&(f=null),S=i,i=o2(o,f)):(s=i,i=e),v[G]={nextPos:s,result:i},i)}function Wi(){var i,o,f,c=s*309+268,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=mn(),o===e&&(o=null),f=hi(),f!==e?(S=i,i=a2(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Nw(){var i,o,f,c,u,x,P,D,G,ve=s*309+269,Ee=v[ve];if(Ee)return s=Ee.nextPos,Ee.result;if(i=s,o=ph(),o!==e)if(f=Ze(),f!==e){if(c=s,u=gn(),u!==e){for(x=[],P=s,D=Pe(),D!==e?(G=gn(),G!==e?(D=[D,G],P=D):(s=P,P=e)):(s=P,P=e);P!==e;)x.push(P),P=s,D=Pe(),D!==e?(G=gn(),G!==e?(D=[D,G],P=D):(s=P,P=e)):(s=P,P=e);S=c,c=f2(o,f,u,x)}else s=c,c=e;c!==e?(u=nt(),u!==e?(S=i,i=u2(o,f,c,u)):(s=i,i=e)):(s=i,i=e)}else s=i,i=e;else s=i,i=e;return v[ve]={nextPos:s,result:i},i}function gn(){var i,o,f,c,u,x=s*309+270,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=Le(),o!==e?(f=s,c=Vi(),c!==e?(u=Pr(),u!==e?(c=[c,u],f=c):(s=f,f=e)):(s=f,f=e),f===e&&(f=null),S=i,i=h2(o,f)):(s=i,i=e),i===e&&(i=Ws()),v[x]={nextPos:s,result:i},i)}function mn(){var i,o,f=s*309+271,c=v[f];if(c)return s=c.nextPos,c.result;if(i=[],o=Bd(),o!==e)for(;o!==e;)i.push(o),o=Bd();else i=e;return v[f]={nextPos:s,result:i},i}function Bd(){var i,o=s*309+272,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=_w(),i===e&&(i=Nw(),i===e&&(i=vn(),i===e&&(i=Lw(),i===e&&(i=ed(),i===e&&(i=td()))))),w--,i===e&&w===0&&A(db),v[o]={nextPos:s,result:i},i)}function Lw(){var i,o=s*309+273,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=dh(),i===e&&(i=ch(),i===e&&(i=hh())),w--,i===e&&w===0&&A(pb),v[o]={nextPos:s,result:i},i)}function _w(){var i,o,f,c,u,x,P,D,G,ve=s*309+274,Ee=v[ve];if(Ee)return s=Ee.nextPos,Ee.result;if(w++,i=Bs(),i===e&&(i=Hs(),i===e&&(i=Fs(),i===e&&(i=Vs(),i===e&&(i=eh(),i===e&&(i=ih(),i===e&&(i=rh(),i===e&&(i=th(),i===e&&(i=sh(),i===e&&(i=Ws(),i===e&&(i=zs(),i===e&&(i=Us(),i===e&&(i=qs(),i===e&&(i=Gs(),i===e&&(i=js(),i===e&&(i=wu(),i===e&&(i=bu(),i===e)))))))))))))))))if(i=s,o=Bu(),o!==e){if(f=s,c=Ze(),c!==e)if(u=wr(),u!==e){for(x=[],P=s,D=Pe(),D!==e?(G=wr(),G!==e?(D=[D,G],P=D):(s=P,P=e)):(s=P,P=e);P!==e;)x.push(P),P=s,D=Pe(),D!==e?(G=wr(),G!==e?(D=[D,G],P=D):(s=P,P=e)):(s=P,P=e);P=nt(),P!==e?(S=f,f=c2(o,c,u,x,P)):(s=f,f=e)}else s=f,f=e;else s=f,f=e;f===e&&(f=null),S=i,i=d2(o,f)}else s=i,i=e;return w--,i===e&&(o=e,w===0&&A(gb)),v[ve]={nextPos:s,result:i},i}function hi(){var i,o,f,c=s*309+275,u=v[c];return u?(s=u.nextPos,u.result):(w++,i=s,o=Bw(),o!==e?(f=zi(),f===e&&(f=null),S=i,i=p2(o,f)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(fu)),v[c]={nextPos:s,result:i},i)}function Bw(){var i,o=s*309+276,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=Ks(),i===e&&(i=Su(),i===e&&(i=Au(),i===e&&(i=Pu(),i===e&&(i=$u(),i===e&&(i=ku(),i===e&&(i=Ku(),i===e&&(i=Xu(),i===e&&(i=Yu(),i===e&&(i=nh(),i===e&&(i=lh(),i===e&&(i=oh(),i===e&&(i=Fu(),i===e&&(i=Vu(),i===e&&(i=Hu(),i===e&&(i=Wu(),i===e&&(i=zu(),i===e&&(i=Uu(),i===e&&(i=qu(),i===e&&(i=Gu(),i===e&&(i=ju(),i===e&&(i=Ju(),i===e&&(i=Zu(),i===e&&(i=Qu(),i===e&&(i=gh(),i===e&&(i=mh(),i===e&&(i=vh(),i===e&&(i=yh(),i===e&&(i=xh(),i===e&&(i=bh(),i===e&&(i=wh(),i===e&&(i=kh(),i===e&&(i=Sh(),i===e&&(i=ah(),i===e&&(i=fh(),i===e&&(i=uh(),i===e&&(i=Ah(),i===e&&(i=Ph(),i===e&&(i=$h(),i===e&&(i=Ch(),i===e&&(i=Mh(),i===e&&(i=Th(),i===e&&(i=Dh(),i===e&&(i=Eh(),i===e&&(i=Rh(),i===e&&(i=Oh(),i===e&&(i=Ih(),i===e&&(i=Nh(),i===e&&(i=Lh(),i===e&&(i=_h(),i===e&&(i=Bh(),i===e&&(i=Fh(),i===e&&(i=Vh(),i===e&&(i=Hh(),i===e&&(i=Wh(),i===e&&(i=zh(),i===e&&(i=Uh(),i===e&&(i=uc(),i===e&&(i=hc(),i===e&&(i=qh(),i===e&&(i=Gh(),i===e&&(i=jh(),i===e&&(i=Kh(),i===e&&(i=Xh(),i===e&&(i=Yh(),i===e&&(i=cc(),i===e&&(i=Jh(),i===e&&(i=Zh(),i===e&&(i=Qh(),i===e&&(i=ec(),i===e&&(i=tc(),i===e&&(i=ic(),i===e&&(i=dc(),i===e&&(i=rc(),i===e&&(i=sc(),i===e&&(i=nc(),i===e&&(i=lc(),i===e&&(i=oc(),i===e&&(i=ac(),i===e&&(i=fc(),i===e&&(i=pc(),i===e&&(i=gc(),i===e&&(i=mc(),i===e&&(i=vc(),i===e&&(i=yc(),i===e&&(i=xc(),i===e&&(i=bc(),i===e&&(i=wc(),i===e&&(i=kc(),i===e&&(i=Sc(),i===e&&(i=Ac(),i===e&&(i=Pc(),i===e&&(i=$c(),i===e&&(i=Cc(),i===e&&(i=Mc(),i===e&&(i=Tc(),i===e&&(i=Dc(),i===e&&(i=Ec(),i===e&&(i=Rc(),i===e&&(i=Oc(),i===e&&(i=Ic(),i===e&&(i=Nc(),i===e&&(i=Lc(),i===e&&(i=_c(),i===e&&(i=Bc(),i===e&&(i=Fc(),i===e&&(i=Vc(),i===e&&(i=Hc(),i===e&&(i=Wc(),i===e&&(i=zc(),i===e&&(i=Uc(),i===e&&(i=qc(),i===e&&(i=Gc(),i===e&&(i=jc(),i===e&&(i=Kc(),i===e&&(i=Xc(),i===e&&(i=Yc(),i===e&&(i=Jc(),i===e&&(i=Zc(),i===e&&(i=Fw(),i===e&&(i=wr())))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))),w--,i===e&&w===0&&A(fu),v[o]={nextPos:s,result:i},i)}function zi(){var i,o,f,c,u,x,P=s*309+277,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=[],f=s,c=Ys(),c!==e?(u=Pr(),u===e&&(u=null),x=Js(),x!==e?(S=f,f=du(c,u,x)):(s=f,f=e)):(s=f,f=e),f!==e)for(;f!==e;)o.push(f),f=s,c=Ys(),c!==e?(u=Pr(),u===e&&(u=null),x=Js(),x!==e?(S=f,f=du(c,u,x)):(s=f,f=e)):(s=f,f=e);else o=e;return o!==e&&(S=i,o=g2(o)),i=o,w--,i===e&&(o=e,w===0&&A(mb)),v[P]={nextPos:s,result:i},i}function vn(){var i,o=s*309+278,f=v[o];return f?(s=f.nextPos,f.result):(w++,i=id(),i===e&&(i=rd(),i===e&&(i=sd())),w--,i===e&&w===0&&A(vb),v[o]={nextPos:s,result:i},i)}function Fw(){var i,o,f,c,u,x,P=s*309+279,D=v[P];return D?(s=D.nextPos,D.result):(w++,i=s,o=Qc(),o!==e?(f=Le(),f===e&&(f=null),c=fi(),c!==e?(u=Fd(),u!==e?(x=ui(),x!==e?(S=i,i=m2(o,f,c,u,x)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(yb)),v[P]={nextPos:s,result:i},i)}function Fd(){var i,o,f,c,u=s*309+280,x=v[u];if(x)return s=x.nextPos,x.result;if(i=[],o=s,f=Vd(),f!==e?(c=ze(),c!==e?(S=o,o=pu(f,c)):(s=o,o=e)):(s=o,o=e),o!==e)for(;o!==e;)i.push(o),o=s,f=Vd(),f!==e?(c=ze(),c!==e?(S=o,o=pu(f,c)):(s=o,o=e)):(s=o,o=e);else i=e;return v[u]={nextPos:s,result:i},i}function Vd(){var i,o,f,c,u,x,P,D=s*309+281,G=v[D];if(G)return s=G.nextPos,G.result;if(i=s,o=Wi(),o!==e)if(f=$r(),f!==e){for(c=[],u=s,x=Pe(),x!==e?(P=$r(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);u!==e;)c.push(u),u=s,x=Pe(),x!==e?(P=$r(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);S=i,i=v2(o,f,c)}else s=i,i=e;else s=i,i=e;return v[D]={nextPos:s,result:i},i}function $r(){var i,o,f,c=s*309+282,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Le(),o!==e?(f=zi(),f===e&&(f=null),S=i,i=y2(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function ci(){var i,o,f,c,u,x,P,D=s*309+283,G=v[D];if(G)return s=G.nextPos,G.result;if(i=$t(),i===e)if(i=s,o=fi(),o!==e)if(f=ci(),f!==e){for(c=[],u=s,x=Pe(),x!==e?(P=ci(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);u!==e;)c.push(u),u=s,x=Pe(),x!==e?(P=ci(),P!==e?(x=[x,P],u=x):(s=u,u=e)):(s=u,u=e);u=Pe(),u===e&&(u=null),x=ui(),x!==e?(S=i,i=x2(o,f,c,u,x)):(s=i,i=e)}else s=i,i=e;else s=i,i=e;return v[D]={nextPos:s,result:i},i}function Ui(){var i,o=s*309+284,f=v[o];return f?(s=f.nextPos,f.result):(i=Vw(),i===e&&(i=Hd()),v[o]={nextPos:s,result:i},i)}function Hd(){var i,o=s*309+285,f=v[o];return f?(s=f.nextPos,f.result):(i=qw(),i===e&&(i=dn(),i===e&&(i=Ud(),i===e&&(i=Hw(),i===e&&(i=Ww(),i===e&&(i=zw(),i===e&&(i=Uw())))))),v[o]={nextPos:s,result:i},i)}function Vw(){var i,o,f,c,u=s*309+286,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=s,f=fi(),f!==e&&(S=o,f=b2(f)),o=f,o!==e?(f=yn(),f===e&&(f=null),c=ui(),c!==e?(S=i,i=w2(o,f,c)):(s=i,i=e)):(s=i,i=e),v[u]={nextPos:s,result:i},i)}function Wd(){var i,o,f,c,u=s*309+287,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=fi(),o!==e?(f=yn(),f===e&&(f=null),c=ui(),c!==e?(S=i,i=k2(o,f,c)):(s=i,i=e)):(s=i,i=e),v[u]={nextPos:s,result:i},i)}function zd(){var i,o=s*309+288,f=v[o];return f?(s=f.nextPos,f.result):(i=Wd(),i===e&&(i=Hd()),v[o]={nextPos:s,result:i},i)}function yn(){var i,o,f=s*309+289,c=v[f];if(c)return s=c.nextPos,c.result;if(i=[],o=Ui(),o===e&&(o=Cr()),o!==e)for(;o!==e;)i.push(o),o=Ui(),o===e&&(o=Cr());else i=e;return v[f]={nextPos:s,result:i},i}function Ud(){var i,o,f,c=s*309+290,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=at(),o===e&&(o=null),f=ze(),f!==e?(S=i,i=S2(o,f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Hw(){var i,o,f,c,u,x,P,D,G,ve,Ee=s*309+291,bn=v[Ee];return bn?(s=bn.nextPos,bn.result):(i=s,o=Ru(),o!==e?(f=Ze(),f!==e?(c=at(),c!==e?(u=nt(),u!==e?(x=s,P=Ui(),P!==e?(D=s,G=Du(),G!==e?(ve=Ui(),ve!==e?(G=[G,ve],D=G):(s=D,D=e)):(s=D,D=e),D===e&&(D=null),P=[P,D],x=P):(s=x,x=e),x!==e?(S=i,i=A2(o,f,c,u,x)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),v[Ee]={nextPos:s,result:i},i)}function Ww(){var i,o,f,c,u,x,P,D,G=s*309+292,ve=v[G];return ve?(s=ve.nextPos,ve.result):(i=s,o=Nu(),o!==e?(f=Ze(),f!==e?(c=at(),c!==e?(u=nt(),u!==e?(x=fi(),x!==e?(P=yn(),P!==e?(D=ui(),D!==e?(S=i,i=P2(o,f,c,u,x,P,D)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),v[G]={nextPos:s,result:i},i)}function zw(){var i,o,f,c,u=s*309+293,x=v[u];return x?(s=x.nextPos,x.result):(i=s,o=Lu(),o!==e?(f=at(),f!==e?(c=Zs(),c!==e?(S=i,i=$2(o,f,c)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=_u(),o!==e?(f=Zs(),f!==e?(S=i,i=C2(o,f)):(s=i,i=e)):(s=i,i=e)),v[u]={nextPos:s,result:i},i)}function Uw(){var i,o,f,c,u,x,P,D,G,ve=s*309+294,Ee=v[ve];return Ee?(s=Ee.nextPos,Ee.result):(w++,i=s,o=s,f=Xs(),f!==e&&(S=o,f=M2(f)),o=f,o!==e?(f=Ze(),f!==e?(c=qd(),c!==e?(u=nt(),u!==e?(x=zd(),x!==e?(S=i,i=T2(o,f,c,u,x)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Tu(),o!==e?(f=Ui(),f!==e?(c=Xs(),c!==e?(u=Ze(),u!==e?(x=at(),x!==e?(P=nt(),P!==e?(D=ze(),D!==e?(S=i,i=D2(o,f,c,u,x,P,D)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=s,f=Eu(),f!==e&&(S=o,f=E2(f)),o=f,o!==e?(f=Ze(),f!==e?(c=Ud(),c===e&&(c=dn()),c===e&&(c=null),u=qd(),u===e&&(u=null),x=ze(),x!==e?(P=at(),P===e&&(P=null),D=nt(),D!==e?(G=zd(),G!==e?(S=i,i=R2(o,f,c,u,x,P,D,G)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e))),w--,i===e&&(o=e,w===0&&A(xb)),v[ve]={nextPos:s,result:i},i)}function qd(){var i,o,f,c,u,x=s*309+295,P=v[x];return P?(s=P.nextPos,P.result):(i=s,o=Wi(),o!==e?(f=Le(),f!==e?(c=Vi(),c!==e?(u=ci(),u!==e?(S=i,i=O2(o,f,c,u)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e)):(s=i,i=e),i===e&&(i=at()),v[x]={nextPos:s,result:i},i)}function qw(){var i,o,f,c,u=s*309+296,x=v[u];return x?(s=x.nextPos,x.result):(w++,i=s,o=Mu(),o!==e?(f=ze(),f!==e?(S=i,i=I2(o,f)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Cu(),o!==e?(f=ze(),f!==e?(S=i,i=N2(o,f)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Iu(),o!==e?(f=at(),f===e&&(f=null),c=ze(),c!==e?(S=i,i=L2(o,f,c)):(s=i,i=e)):(s=i,i=e),i===e&&(i=s,o=Ou(),o!==e?(f=ze(),f!==e?(S=i,i=_2(o,f)):(s=i,i=e)):(s=i,i=e)))),w--,i===e&&(o=e,w===0&&A(bb)),v[u]={nextPos:s,result:i},i)}function Cr(){var i,o,f,c,u,x,P=s*309+297,D=v[P];if(D)return s=D.nextPos,D.result;if(w++,i=s,o=s,f=s,r.charCodeAt(s)===35?(c=W0,s++):(c=e,w===0&&A(kb)),c!==e){for(u=[],vr.test(r.charAt(s))?(x=r.charAt(s),s++):(x=e,w===0&&A(yr));x!==e;)u.push(x),vr.test(r.charAt(s))?(x=r.charAt(s),s++):(x=e,w===0&&A(yr));c=[c,u],f=c}else s=f,f=e;return f!==e?o=r.substring(o,s):o=f,o!==e?(f=j(),S=i,i=B2(o,f)):(s=i,i=e),w--,i===e&&(o=e,w===0&&A(wb)),v[P]={nextPos:s,result:i},i}function Gw(){var i,o,f=s*309+298,c=v[f];if(c)return s=c.nextPos,c.result;if(i=[],o=Gd(),o===e&&(o=Cr()),o!==e)for(;o!==e;)i.push(o),o=Gd(),o===e&&(o=Cr());else i=e;return v[f]={nextPos:s,result:i},i}function jw(){var i,o,f,c=s*309+299,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Id(),o!==e?(f=ze(),f!==e?(S=i,i=F2(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function Gd(){var i,o=s*309+301,f=v[o];return f?(s=f.nextPos,f.result):(i=jw(),i===e&&(i=Kw(),i===e&&(i=dn())),v[o]={nextPos:s,result:i},i)}function Kw(){var i,o,f,c=s*309+302,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=Mw(),o!==e?(f=Wd(),f!==e?(S=i,i=V2(o,f)):(s=i,i=e)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}function j(){var i,o,f,c,u,x,P=s*309+303,D=v[P];if(D)return s=D.nextPos,D.result;for(w++,i=s,o=qi(),o===e&&(o=null),f=[],c=s,u=Mr(),u!==e?(x=qi(),x===e&&(x=null),u=[u,x],c=u):(s=c,c=e);c!==e;)f.push(c),c=s,u=Mr(),u!==e?(x=qi(),x===e&&(x=null),u=[u,x],c=u):(s=c,c=e);return S=i,i=H2(o,f),w--,o=e,w===0&&A(Sb),v[P]={nextPos:s,result:i},i}function Mr(){var i,o,f,c,u,x,P=s*309+304,D=v[P];if(D)return s=D.nextPos,D.result;if(i=Xw(),i===e)if(i=s,o=Yw(),o!==e){for(f=[],c=s,u=qi(),u!==e?(x=Mr(),x!==e?(S=c,c=gu(o,u,x)):(s=c,c=e)):(s=c,c=e);c!==e;)f.push(c),c=s,u=qi(),u!==e?(x=Mr(),x!==e?(S=c,c=gu(o,u,x)):(s=c,c=e)):(s=c,c=e);S=i,i=W2(o,f)}else s=i,i=e;return v[P]={nextPos:s,result:i},i}function Xw(){var i,o,f,c,u,x=s*309+305,P=v[x];if(P)return s=P.nextPos,P.result;if(i=s,o=s,r.substr(s,2)===eu?(f=eu,s+=2):(f=e,w===0&&A(Ab)),f!==e){for(c=[],vr.test(r.charAt(s))?(u=r.charAt(s),s++):(u=e,w===0&&A(yr));u!==e;)c.push(u),vr.test(r.charAt(s))?(u=r.charAt(s),s++):(u=e,w===0&&A(yr));f=[f,c],o=f}else s=o,o=e;return o!==e?i=r.substring(i,s):i=o,v[x]={nextPos:s,result:i},i}function Yw(){var i,o,f,c,u,x,P,D=s*309+306,G=v[D];if(G)return s=G.nextPos,G.result;if(i=s,o=s,r.substr(s,2)===tu?(f=tu,s+=2):(f=e,w===0&&A(Pb)),f!==e){for(c=[],u=s,x=s,w++,r.substr(s,2)===ai?(P=ai,s+=2):(P=e,w===0&&A(Ns)),w--,P===e?x=void 0:(s=x,x=e),x!==e?(r.length>s?(P=r.charAt(s),s++):(P=e,w===0&&A(uu)),P!==e?(S=u,u=mu(P)):(s=u,u=e)):(s=u,u=e);u!==e;)c.push(u),u=s,x=s,w++,r.substr(s,2)===ai?(P=ai,s+=2):(P=e,w===0&&A(Ns)),w--,P===e?x=void 0:(s=x,x=e),x!==e?(r.length>s?(P=r.charAt(s),s++):(P=e,w===0&&A(uu)),P!==e?(S=u,u=mu(P)):(s=u,u=e)):(s=u,u=e);r.substr(s,2)===ai?(u=ai,s+=2):(u=e,w===0&&A(Ns)),u!==e?(f=[f,c,u],o=f):(s=o,o=e)}else s=o,o=e;return o!==e?i=r.substring(i,s):i=o,v[D]={nextPos:s,result:i},i}function qi(){var i,o,f,c=s*309+307,u=v[c];if(u)return s=u.nextPos,u.result;if(i=s,o=[],su.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(hu)),f!==e)for(;f!==e;)o.push(f),su.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(hu));else o=e;return o!==e?i=r.substring(i,s):i=o,v[c]={nextPos:s,result:i},i}function R(){var i,o,f,c=s*309+308,u=v[c];return u?(s=u.nextPos,u.result):(i=s,o=s,w++,Os.test(r.charAt(s))?(f=r.charAt(s),s++):(f=e,w===0&&A(Is)),w--,f===e?o=void 0:(s=o,o=e),o!==e?(f=j(),S=i,i=z2(f)):(s=i,i=e),v[c]={nextPos:s,result:i},i)}const xn=i=>{if(!t.includeLocation)return;const{start:o,end:f}=i||U2();return{start:o,end:f}},z=(i,o)=>{const f={type:i,...o};return t.includeLocation&&(f.location=xn()),f},Gi=(i,o,f)=>{let c=xn(f);return{name:i,parent:o,...c?{location:c}:!1,bindings:{},types:{},functions:{}}},Jw=(...i)=>!t.quiet&&console.warn(...i);let ee=Gi("global"),jd=[ee];const Tr=i=>(jd.push(i),i),Dr=i=>{if(!i.parent)throw new Error("popped bad scope",i,"at",vu());return i.parent},ji=(i,o)=>{t.includeLocation&&(i.location||console.error("no end location at",vu()),i.location.end=o)},Zw=i=>i.reduce((o,f)=>{const c=f.partial||{};if(c.type==="case_label")return[...o,z("switch_case",{statements:[],case:c.case,test:c.test,colon:c.colon})];if(c.type==="default_label")return[...o,z("default_case",{statements:[],default:c.default,colon:c.colon})];if(o.length){const u=o.slice(-1)[0];return[...o.slice(0,-1),{...u,statements:[...u.statements,f]}]}else throw new Error("A switch statement body must start with a case or default label")},[]);if(br=a(),br!==e&&s===r.length)return br;throw br!==e&&s<r.length&&A(G2()),j2(Ls,dt<r.length?r.charAt(dt):null,dt<r.length?_s(dt,dt+1):_s(dt,dt))}var Lk={SyntaxError:ii,parse:Nk},Cg=vi&&vi.__importDefault||function(r){return r&&r.__esModule?r:{default:r}},_k=Cg(Il),Bk=Cg(Lk),Fk={generate:_k.default,parser:Bk.default};function Vk(r){return r.scopes.find(t=>t.name=="global")}const Pn=new Map;function Hk(r){let t=r;if(Pn.has(r))return Pn.get(r);try{const e=Fk.parser.parse(r),n=Vk(e);return n.functions.sceneDiffuseColor||(t+=`vec3 sceneDiffuseColor(vec3 position) {
      if (length(position) > 35.0) return vec3(0.0);
      return vec3(0.6);
    }`),n.functions.sceneSpecularColor||(t+=`vec3 sceneSpecularColor(vec3 position) {
      if (length(position) > 35.0) return vec3(0.0);
      return vec3(0.6);
    }`),n.functions.sceneSpecularRoughness||(t+=`float sceneSpecularRoughness(vec3 position) {
      return 0.2;
    }`),n.functions.sceneSubsurfaceScattering||(t+=`float sceneSubsurfaceScattering(vec3 position) {
      return 11111115.0;
    }`),n.functions.sceneSubsurfaceScatteringColor||(t+=`vec3 sceneSubsurfaceScatteringColor(vec3 position) {
      if (length(position) > 30.0) return vec3(1.0);
      return vec3(1.0);
    }
    `),n.functions.sceneIOR||(t+=`float sceneIOR(vec3 position) {
      return 100.0;
    }`),n.functions.sceneEmission||(t+=`vec3 sceneEmission(vec3 position) {
      float d = max(normalize(position).y, 0.2);
      vec3 brightColor = vec3(0.7, 0.8, 1.0) * d * 1.0;
      return (length(position) > 36.0) ? (brightColor * 2.00) : vec3(0.0);
    }`),Pn.set(r,t),t}catch{return r}}const Wk=/^(u?int|float|[iu]?vec[234])\s+[a-zA-Z_][a-zA-Z_0-9]*/g;function*Mg(r){let t=0,e=1;for(;;){let n=e-t;if(n==1)t=1,e*=r;else{let l=e;for(;n<=l;)l/=r;t=(r+1)*l-n}yield t/e}return 0}let ne;(function(r){r.float=t=>({count:1,data:[t],type:"f"}),r.vec2=(t,e)=>({count:2,data:[t,e],type:"f"}),r.vec3=(t,e,n)=>({count:3,data:[t,e,n],type:"f"}),r.vec4=(t,e,n,l)=>({count:4,data:[t,e,n,l],type:"f"}),r.int=t=>({count:1,data:[t],type:"i"})})(ne||(ne={}));function jr(r,t,e){for(const[n,l]of Object.entries(e))r["uniform"+l.count+l.type+"v"](r.getUniformLocation(t,n),l.data)}function _l(r,t,e){for(const n of t)if(r[n]===void 0){e&&e(n);return}return r}const zk=Mg(2),Uk=Mg(3);function qk(r){return{type:"general",infoLog:r}}async function Gk(r,t){const e=t.gl;e.bindVertexArray(t.vao);const n=t.fbo.create(r.render.width,r.render.height,r.render.frameid);if(!n)return function*(){return{success:!1,why:qk("Failed to load framebuffers.")}};const l=t.programCache.getProgram(await It("./shader/raymarcher.vert"),(await It("./shader/raymarcher.frag")).replace("//SCENESDFHERE",Hk(r.sdfShaderSource)));if(!(l instanceof WebGLProgram))return function*(){return{success:!1,why:l}};let a=0;return function*(h){for(let d=0;d<r.render.subdivisions;d++)for(let p=0;p<r.render.subdivisions;p++)for(let g=0;g<r.render.samplesPerPixel;g++){a%r.render.sampleYieldInterval==0&&(h(e,r,t,n,a),yield);let m=Math.floor(r.render.width/r.render.subdivisions*p),y=Math.floor(r.render.height/r.render.subdivisions*d),b=Math.ceil(r.render.width/r.render.subdivisions*(p+1)),k=Math.ceil(r.render.height/r.render.subdivisions*(d+1));e.enable(e.SCISSOR_TEST),e.scissor(m,y,b,k),e.useProgram(l),e.bindBuffer(e.ARRAY_BUFFER,t.fullscreenQuadBuffer);const C=e.getAttribLocation(l,"vertex_position");e.vertexAttribPointer(C,2,e.FLOAT,!1,8,0),e.enableVertexAttribArray(C),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n.prevTex.color),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n.prevTex.normalAndDofRadius),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,n.prevTex.albedoAndDepth),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n.curr),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1,e.COLOR_ATTACHMENT2]),jr(e,l,{blendWithPreviousFactor:ne.float(r.render.blendWithPreviousFrameFactor),previousColor:ne.int(0),previousNormalAndDofRadius:ne.int(1),previousAlbedoAndDepth:ne.int(2),randNoise:ne.vec2(zk.next().value,Uk.next().value),position:ne.vec3(...r.camera.position),dofAmount:ne.float(r.dof.amount),dofFocalPlaneDistance:ne.float(r.dof.distance),cameraMode:ne.int(["perspective","orthographic","panoramic"].indexOf(r.camera.mode.type)),fov:ne.float(r.camera.mode.type=="perspective"?r.camera.mode.fov:r.camera.mode.type=="orthographic"?r.camera.mode.size:1),reflections:ne.float(r.reflectionIterationCounts.length),raymarchingSteps:ne.float(r.reflectionIterationCounts[0]),indirectLightingRaymarchingSteps:ne.float(r.reflectionIterationCounts[1]??r.reflectionIterationCounts[0]),aspect:ne.float(r.render.width/r.render.height),fogDensity:ne.float(r.fogDensity),exposure:ne.float(r.render.exposure/r.render.samplesPerPixel),blendMode:ne.int(r.render.blendMode=="additive"?1:0),renderMode:ne.int(r.render.renderMode=="preview"?1:0),lightCount:ne.int(r.lights.length),showDofFocalPlane:ne.int(r.dof.showFocusedArea?1:0)}),jr(e,l,r.customShaderParameters),e.uniform1fv(e.getUniformLocation(l,"raymarchingStepCountsArray"),r.reflectionIterationCounts),r.lights.length>0&&(e.uniform3fv(e.getUniformLocation(l,"lightPositions"),r.lights.map(O=>O.type=="point"?O.position:O.direction).flat()),e.uniform3fv(e.getUniformLocation(l,"lightColors"),r.lights.map(O=>O.color).flat()),e.uniform1fv(e.getUniformLocation(l,"lightSizes"),r.lights.map(O=>O.type=="point"?O.size:0))),e.uniformMatrix4fv(e.getUniformLocation(l,"rotation"),!1,r.camera.rotation),e.drawArrays(e.TRIANGLES,0,6),e.useProgram(t.program.blit),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n.prev),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1,e.COLOR_ATTACHMENT2]);for(let O=0;O<3;O++)e.activeTexture(e.TEXTURE0+O),e.bindTexture(e.TEXTURE_2D,[n.currTex.color,n.currTex.normalAndDofRadius,n.currTex.albedoAndDepth][O]);jr(e,t.program.blit,{inputImage1:ne.int(0),inputImage2:ne.int(1),inputImage3:ne.int(2)}),e.drawArrays(e.TRIANGLES,0,6),a++}return t.fbo.delete(r.render.width,r.render.height,r.render.frameid),h(e,r,t,n,a),{success:!0}}}function jk(r,t,e){const n=r.createShader(e);if(!n)return{type:e==r.VERTEX_SHADER?"vertex":"fragment",infoLog:"Failed to create shader."};if(r.shaderSource(n,t),r.compileShader(n),!r.getShaderParameter(n,r.COMPILE_STATUS)){const l=r.getShaderInfoLog(n);return console.error(`Shader compile error: 
`+l),{type:e==r.VERTEX_SHADER?"vertex":"fragment",infoLog:l}}return n}function Kk(r){const t=new Map;return{getShader:(e,n)=>{let l=t.get(e);return l===void 0&&(l=jk(r,e,n),t.set(e,l)),l}}}function Xk(r,t,e){const n=r.createProgram();if(!n)return{type:"program",infoLog:"Failed to create program."};if(r.attachShader(n,t),r.attachShader(n,e),r.linkProgram(n),!r.getProgramParameter(n,r.LINK_STATUS)){const l=r.getProgramInfoLog(n);return console.error(`Program link error: 
`+l),{type:"program",infoLog:l}}return n}function Yk(r,t,e,n){const l=t.getShader(e,r.VERTEX_SHADER),a=t.getShader(n,r.FRAGMENT_SHADER);return l instanceof WebGLShader?a instanceof WebGLShader?Xk(r,l,a):a:l}function Jk(r){const t=Kk(r),e=new Map;return{getProgram:(n,l)=>{let a=e.get(n);a||(a=new Map,e.set(n,a));let h=a.get(l);if(h===void 0)if(h=Yk(r,t,n,l),a)a.set(l,h??null);else{const d=new Map;d.set(l,h),e.set(n,d)}return h??void 0}}}function $n(r){if(r instanceof WebGLProgram)return r}async function Zk(r){return _l({merge:$n(r.getProgram(await It("./shader/merge.vert"),await It("./shader/merge.frag"))),display:$n(r.getProgram(await It("./shader/display.vert"),await It("./shader/display.frag"))),blit:$n(r.getProgram(await It("./shader/blit.vert"),await It("./shader/blit.frag")))},["merge","display","blit"],t=>console.log(t))}function Cn(r){r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT)}function Jd(r,t,e){const n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA32F,t,e,0,r.RGBA,r.FLOAT,null),Cn(r),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const l=r.createTexture();r.bindTexture(r.TEXTURE_2D,l),r.texImage2D(r.TEXTURE_2D,0,r.RGBA16F,t,e,0,r.RGBA,r.HALF_FLOAT,null),Cn(r),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT1,r.TEXTURE_2D,l,0);const a=r.createTexture();if(r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.RGBA16F,t,e,0,r.RGBA,r.HALF_FLOAT,null),Cn(r),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT2,r.TEXTURE_2D,a,0),!(!n||!l||!a))return{color:n,normalAndDofRadius:l,albedoAndDepth:a}}function Qk(r,t,e,n){const l=r.createFramebuffer();if(!l)return;r.bindFramebuffer(r.FRAMEBUFFER,l);const a=Jd(r,t,e),h=r.createFramebuffer();if(!h)return;r.bindFramebuffer(r.FRAMEBUFFER,h);const d=Jd(r,t,e);return console.log(r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE),_l({prev:l,curr:h,prevTex:a,currTex:d,width:t,height:e,frameid:n},["prevTex","currTex"])}function eS(r){const t=pk(n=>n.width+1e4*n.height+1e8*n.frameid,(n,l)=>n.width==l.width&&n.height==l.height&&n.frameid==l.frameid),e=[];return{create:(n,l,a)=>{const h=t.get({width:n,height:l,frameid:a});if(h)return h;{const d=e.findIndex(p=>n==p.width&&l==p.height);if(d!=-1){let p=e.splice(d,1)[0];return t.set({width:n,height:l,frameid:a},p),p.frameid!=a&&(r.bindFramebuffer(r.DRAW_FRAMEBUFFER,p.prev),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),p.frameid=a),p}else{let p=Qk(r,n,l,a);return p?(t.set({width:n,height:l,frameid:a},p),p):void 0}}},delete:(n,l,a)=>{const h={width:n,height:l,frameid:a},d=t.get(h);if(d&&(e.push(d),e.length>3)){const p=e.shift();p&&(r.deleteFramebuffer(p.curr),r.deleteFramebuffer(p.prev),r.deleteTexture(p.currTex.color),r.deleteTexture(p.prevTex.color))}t.delete(h)}}}function tS(r){const t=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),r.STATIC_DRAW),t??void 0}async function iS(r){const t=Jk(r),e=r.createVertexArray();return r.bindVertexArray(e),_l({gl:r,programCache:t,program:await Zk(t),fbo:eS(r),fullscreenQuadBuffer:tS(r),vao:e??void 0},["program","fbo","vao"],n=>console.log(n))}var rS=1e-6,as=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});function sS(){var r=new as(16);return as!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function nS(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Zd(r,t,e,n){var l=n[0],a=n[1],h=n[2],d=Math.hypot(l,a,h),p,g,m,y,b,k,C,O,M,I,L,F,N,H,W,Z,re,X,J,ie,me,ke,We,De;return d<rS?null:(d=1/d,l*=d,a*=d,h*=d,p=Math.sin(e),g=Math.cos(e),m=1-g,y=t[0],b=t[1],k=t[2],C=t[3],O=t[4],M=t[5],I=t[6],L=t[7],F=t[8],N=t[9],H=t[10],W=t[11],Z=l*l*m+g,re=a*l*m+h*p,X=h*l*m-a*p,J=l*a*m-h*p,ie=a*a*m+g,me=h*a*m+l*p,ke=l*h*m+a*p,We=a*h*m-l*p,De=h*h*m+g,r[0]=y*Z+O*re+F*X,r[1]=b*Z+M*re+N*X,r[2]=k*Z+I*re+H*X,r[3]=C*Z+L*re+W*X,r[4]=y*J+O*ie+F*me,r[5]=b*J+M*ie+N*me,r[6]=k*J+I*ie+H*me,r[7]=C*J+L*ie+W*me,r[8]=y*ke+O*We+F*De,r[9]=b*ke+M*We+N*De,r[10]=k*ke+I*We+H*De,r[11]=C*ke+L*We+W*De,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)}function Tg(){var r=new as(3);return as!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Qd(r){var t=r[0],e=r[1],n=r[2];return Math.hypot(t,e,n)}function lS(r,t,e){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r}function oS(r,t,e){var n=t[0],l=t[1],a=t[2],h=e[3]*n+e[7]*l+e[11]*a+e[15];return h=h||1,r[0]=(e[0]*n+e[4]*l+e[8]*a+e[12])/h,r[1]=(e[1]*n+e[5]*l+e[9]*a+e[13])/h,r[2]=(e[2]*n+e[6]*l+e[10]*a+e[14])/h,r}(function(){var r=Tg();return function(t,e,n,l,a,h){var d,p;for(e||(e=3),n||(n=0),l?p=Math.min(l*e+n,t.length):p=t.length,d=n;d<p;d+=e)r[0]=t[d],r[1]=t[d+1],r[2]=t[d+2],a(r,r,h),t[d]=r[0],t[d+1]=r[1],t[d+2]=r[2];return t}})();const aS=oe('<div class="enum-input"></div>',2),fS=oe("<button></button>",2);function Bl(r){return(()=>{const t=aS.cloneNode(!0);return te(t,V(fk,{get each(){return r.variants},children:(e,n)=>(()=>{const l=fS.cloneNode(!0);return l.$$click=()=>{r.setValue(e[0])},te(l,()=>e[1]),Fe(()=>Ms(l,r.value()==e[0]?"selected-variant":"variant")),l})()})),t})()}Gt(["click"]);const uS=oe("<div><label></label></div>",4),hS=oe('<div class="collapsible"></div>',2),cS=oe('<div class="collapsible-header"><h2> </h2></div>',4),dS=oe('<div><div class="collapsible-header"><h2> </h2></div></div>',6),Dg=tk([()=>({name:"Name",tooltip:"Tooltip",visible:!1,x:0,y:0}),r=>{}]);function pe(r){const t=rr(()=>r.children),e=rr(()=>r.name),n=rr(()=>r.tooltip),[l,a]=He(!1),[h,d]=ik(Dg);return(()=>{const p=uS.cloneNode(!0),g=p.firstChild;return p.addEventListener("mouseleave",()=>{d({name:"",tooltip:"",visible:!1,x:0,y:0}),a(!1)}),p.addEventListener("mouseenter",m=>{const y=m.currentTarget.getBoundingClientRect();d({name:e(),tooltip:n(),visible:!0,x:y.right,y:y.top}),a(!0)}),te(g,e),te(p,t,null),Fe(()=>Ms(p,r.vertical?"named-input-vertical":"named-input")),p})()}function ri(r){const t=rr(()=>r.children),[e,n]=He(r.startOpen??!1);return(()=>{const l=hS.cloneNode(!0);return te(l,(()=>{const a=be(()=>!e());return()=>a()?(()=>{const h=cS.cloneNode(!0),d=h.firstChild;return d.firstChild,h.$$click=p=>{n(!0),console.log("got here")},te(d,()=>r.name,null),h})():(()=>{const h=dS.cloneNode(!0),d=h.firstChild,p=d.firstChild;return p.firstChild,d.$$click=g=>{n(!1),console.log("got here")},te(p,()=>r.name,null),te(h,t,null),h})()})()),l})()}Gt(["click"]);const pS=oe('<input type="number">',1);function je(r){const{min:t,max:e,step:n,sensitivity:l,defaultValue:a,updateInRealTime:h,slideMode:d}={min:r.min??-1/0,max:r.max??1/0,step:r.step??152587890625e-16,sensitivity:r.sensitivity??1,defaultValue:r.default??0,updateInRealTime:r.updateInRealTime??!1,slideMode:r.slideMode};let[p,g]=He(0),[m,y]=He(r.value());function b(k,C){const O=d=="log"?k*Math.exp(C*l):k+C*l,M=Math.floor(O/n)*n;return Math.max(Math.min(M,e),t)}return(()=>{const k=pS.cloneNode(!0);return k.addEventListener("change",C=>{const O=Number(C.currentTarget.value),M=b(O,0);isNaN(M)?r.setValue(a):r.setValue(M)}),k.$$mousemove=C=>{document.pointerLockElement===C.currentTarget&&(g(p()+C.movementX),h&&r.setValue(b(m(),p())))},k.$$mouseup=C=>{var O;document.exitPointerLock(),(O=r.onSlideEnd)==null||O.call(r),h||r.setValue(b(r.value(),p())),g(0)},k.$$mousedown=C=>{var O;C.currentTarget.requestPointerLock(),(O=r.onSlideStart)==null||O.call(r),y(r.value())},Fe(()=>k.value=b(r.value(),h?0:p()).toPrecision(6).replace(/\.?0+$/g,"")),k})()}Gt(["mousedown","mouseup","mousemove"]);const gS=oe("<div></div>",2);function mS(r){const t=Kt(r.value,r.setValue);return V(ri,{name:"Camera",get children(){return[V(pe,{name:"Camera Mode",tooltip:"The projection used by the camera.",get children(){return V(Bl,{value:()=>r.value().cameraMode,get setValue(){return t("cameraMode")},variants:[["perspective","Perspective"],["orthographic","Orthographic"],["panoramic","Panoramic"]]})}}),be(()=>be(()=>r.value().cameraMode=="perspective")()?V(pe,{name:"FOV (radians)",tooltip:"Field of view on the Y-axis in radians.",get children(){return V(je,{min:0,value:()=>r.value().fov,get setValue(){return t("fov")},sensitivity:3e-4,updateInRealTime:!0})}}):be(()=>r.value().cameraMode=="orthographic")()?(()=>{const e=gS.cloneNode(!0);return te(e,V(pe,{name:"Size",tooltip:"Size of the orthographic camera sensor.",get children(){return V(je,{min:0,value:()=>r.value().orthographicSize,get setValue(){return t("orthographicSize")},sensitivity:3e-4,updateInRealTime:!0})}})),e})():void 0)]}})}const vS=oe('<input type="checkbox">',1);function fs(r){return(()=>{const t=vS.cloneNode(!0);return t.addEventListener("change",e=>{r.setValue(e.currentTarget.checked)}),Fe(()=>t.checked=r.value()),t})()}const yS=oe("<ul><li>Always Visible: Always show the menu.</li><li>Hidden: Hide the menu when not in use. Hover over it to view.</li><li>Separate Tab: Split the screen, putting the menu on one side and the display on the other.</li></ul>",8);function xS(r){const t=Kt(r.value,r.setValue);return V(ri,{name:"Controls",get children(){return[V(pe,{name:"Speed",tooltip:"Speed of the viewer.",get children(){return V(je,{min:0,value:()=>r.value().cameraSpeed,get setValue(){return t("cameraSpeed")},sensitivity:.001,updateInRealTime:!0,slideMode:"log"})}}),V(pe,{name:"Render while in Menu",tooltip:"Keep rendering even when not controlling the viewer.",get children(){return V(fs,{value:()=>r.value().renderWhileInMenu,get setValue(){return t("renderWhileInMenu")}})}}),V(pe,{name:"Menu Display Mode",get tooltip(){return yS.cloneNode(!0)},get children(){return V(Bl,{value:()=>r.value().menuDisplayMode,get setValue(){return t("menuDisplayMode")},variants:[["always-visible","Always Visible"],["hide","Hidden"],["separate-tab","Separate Tab"]]})}})]}})}var Mn=Symbol("fallback");function ep(r){for(const t of r)t.dispose()}function bS(r,t,e,n={}){const l=new Map;return mg(()=>ep(l.values())),()=>{const h=r()||[];return h[cg],ht(()=>{var m,y;if(!h.length)return ep(l.values()),l.clear(),n.fallback?[wi(k=>(l.set(Mn,{dispose:k}),n.fallback()))]:[];const d=new Array(h.length),p=l.get(Mn);if(!l.size||p){p==null||p.dispose(),l.delete(Mn);for(let b=0;b<h.length;b++){const k=h[b],C=t(k);a(d,k,b,C)}return d}const g=new Set(l.keys());for(let b=0;b<h.length;b++){const k=h[b],C=t(k);g.delete(C);const O=l.get(C);O?(d[b]=O.mapped,(m=O.setIndex)==null||m.call(O,b),O.setItem(()=>k)):a(d,k,b,C)}for(const b of g)(y=l.get(b))==null||y.dispose(),l.delete(b);return d})};function a(h,d,p,g){wi(m=>{const[y,b]=He(d),k={setItem:b,dispose:m};if(e.length>1){const[C,O]=He(p);k.setIndex=O,k.mapped=e(y,C)}else k.mapped=e(y);l.set(g,k),h[p]=k.mapped})}}function wS(r){const{by:t}=r;return be(bS(()=>r.each,typeof t=="function"?t:e=>e[t],r.children,"fallback"in r?{fallback:()=>r.fallback}:void 0))}const kS=oe('<div class="array-input"><ul></ul><button>Add</button></div>',6),SS=oe("<li></li>",2),AS=oe("<button>X</button>",2);function Eg(r){const[t,e]=He(0);return(()=>{const n=kS.cloneNode(!0),l=n.firstChild,a=l.nextSibling;return te(l,V(wS,{get each(){return r.value()},by:"id",children:(h,d)=>(()=>{const p=SS.cloneNode(!0);return te(p,V(r.children,{get deleteButton(){return(()=>{const g=AS.cloneNode(!0);return g.$$click=m=>{r.setValue(r.value().filter((y,b)=>b!=d()))},g})()},value:h,setValue:g=>{r.setValue(r.value().map((m,y)=>y==d()?g:m))},get index(){return d()}})),p})()})),a.$$click=()=>{r.setValue([...r.value(),{...r.defaultValue,id:t()}]),e(t()+1)},n})()}Gt(["click"]);const PS=oe('<input type="color">',1);function $S(r){return"#"+r.map(t=>t.toString(16).padStart(2,"0")).join("")}function CS(r){return[parseInt(r.slice(1,3),16),parseInt(r.slice(3,5),16),parseInt(r.slice(5,7),16)]}function Rg(r){return(()=>{const t=PS.cloneNode(!0);return t.addEventListener("change",e=>{r.setValue(CS(e.currentTarget.value))}),Fe(()=>t.value=$S(r.value())),t})()}const MS=oe("<button>Reposition</button>",2),TS=oe('<div class="horizontal-container single-light"><div class="vertical-container"></div><div class="vertical-container"></div></div>',6),DS=oe('<div class="horizontal-container"></div>',2);function ES(r){const t=Kt(r.value,r.setValue);return(()=>{const e=TS.cloneNode(!0),n=e.firstChild,l=n.nextSibling;return te(n,V(pe,{name:"Color",tooltip:"Color of the light source. Click to modify.",get children(){return V(Rg,{value:()=>r.value().color,get setValue(){return t("color")}})}}),null),te(n,V(pe,{name:"",tooltip:"Click to set the position of the light source to the current position of the viewer.",get children(){const a=MS.cloneNode(!0);return a.$$click=h=>{t("position")(r.lightPosition()),console.log(r.lightPosition())},a}}),null),te(l,V(pe,{name:"Radius",tooltip:"Radius of the point light source. Lights are treated as spheres.",get children(){return V(je,{value:()=>r.value().size,get setValue(){return t("size")},sensitivity:.01,updateInRealTime:!0})}}),null),te(l,V(pe,{name:"Strength",tooltip:"Brightness of the light source.",get children(){return V(je,{value:()=>r.value().strength,get setValue(){return t("strength")},sensitivity:.01,updateInRealTime:!0})}}),null),e})()}function RS(r){const t=Kt(r.value,r.setValue);return V(ri,{name:"Lights",get children(){return V(Eg,{value:()=>r.value().lights,get setValue(){return t("lights")},defaultValue:{position:[0,0,0],strength:3,size:0,color:[255,255,255]},children:e=>(()=>{const n=DS.cloneNode(!0);return te(n,V(ES,{get value(){return e.value},get setValue(){return e.setValue},get lightPosition(){return r.lightPosition}}),null),te(n,()=>e.deleteButton,null),n})()})}})}Gt(["click"]);const OS=oe('<div class="subsection"></div>',2);function IS(r){const t=Kt(r.value,r.setValue,e=>{let n=e.resolutionFactor*(e.previewMode?e.previewModeDownscaling:1),l=e.matchScreenResolution?window.innerWidth:e.rawWidth,a=e.matchScreenResolution?window.innerHeight:e.rawHeight;return{...e,width:Math.round(l*n),height:Math.round(a*n),requestingNewFrame:!0}});return V(ri,{name:"Render",get children(){return[V(pe,{name:"Preview Mode",tooltip:"Enable/disable preview mode for quick camera positioning.",get children(){return V(fs,{value:()=>r.value().previewMode,get setValue(){return t("previewMode")}})}}),be(()=>be(()=>!!r.value().previewMode)()&&V(pe,{name:"Preview Mode Downscaling",tooltip:"When in preview mode, reduce resolution by this proportion. E.g. if this is 0.5 and the normal resolution is 1000x500, preview mode resolution will be 500x250.",get children(){return V(je,{value:()=>r.value().previewModeDownscaling,get setValue(){return t("previewModeDownscaling")},sensitivity:.001})}})),V(pe,{name:"Match Screen Resolution",tooltip:"Automatically adjust render resolution to match screen resolution.",get children(){return V(fs,{value:()=>r.value().matchScreenResolution,get setValue(){return t("matchScreenResolution")}})}}),(()=>{const e=OS.cloneNode(!0);return te(e,(()=>{const n=be(()=>!!r.value().matchScreenResolution);return()=>n()&&V(pe,{name:"Resolution Factor",tooltip:"Proportionality constant between render resolution and screen resolution. For instance, if this is 0.25 and the screen is 2000x1000, the render will be 500x250.",get children(){return V(je,{min:0,value:()=>r.value().resolutionFactor,get setValue(){return t("resolutionFactor")},sensitivity:.001})}})})(),null),te(e,(()=>{const n=be(()=>!r.value().matchScreenResolution);return()=>n()&&[V(pe,{name:"Width",tooltip:"Measured in pixels.",get children(){return V(je,{min:0,step:1,value:()=>r.value().rawWidth,get setValue(){return t("rawWidth")},sensitivity:.1})}}),V(pe,{name:"Height",tooltip:"Measured in pixels.",get children(){return V(je,{min:0,step:1,value:()=>r.value().rawHeight,get setValue(){return t("rawHeight")},sensitivity:.1})}})]})(),null),e})(),V(pe,{name:"Raymarching Step Counts",tooltip:"Number of raymarching steps for each reflection. The first entry is the first reflection, the next is the next reflection, et cetera. The number of entries in this list is the number of reflections.",vertical:!0,get children(){return V(Eg,{value:()=>r.value().reflectionIterationCounts,get setValue(){return t("reflectionIterationCounts")},defaultValue:{count:32},children:e=>[V(je,{value:()=>e.value().count,setValue:n=>e.setValue({id:e.value().id,count:n}),min:0,step:1,sensitivity:.1}),be(()=>e.deleteButton)]})}})]}})}class le{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,n){let l=[];return this.decompose(0,t,l,2),n.length&&n.decompose(0,n.length,l,3),this.decompose(e,this.length,l,1),yt.from(l,this.length-(e-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let n=[];return this.decompose(t,e,n,0),yt.from(n,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),l=new sr(this),a=new sr(t);for(let h=e,d=e;;){if(l.next(h),a.next(h),h=0,l.lineBreak!=a.lineBreak||l.done!=a.done||l.value!=a.value)return!1;if(d+=l.value.length,l.done||d>=n)return!0}}iter(t=1){return new sr(this,t)}iterRange(t,e=this.length){return new Og(this,t,e)}iterLines(t,e){let n;if(t==null)n=this.iter();else{e==null&&(e=this.lines+1);let l=this.line(t).from;n=this.iterRange(l,Math.max(l,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Ig(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?le.empty:t.length<=32?new we(t):yt.from(we.split(t,[]))}}class we extends le{constructor(t,e=NS(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,n,l){for(let a=0;;a++){let h=this.text[a],d=l+h.length;if((e?n:d)>=t)return new LS(l,d,n,h);l=d+1,n++}}decompose(t,e,n,l){let a=t<=0&&e>=this.length?this:new we(tp(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(l&1){let h=n.pop(),d=Kr(a.text,h.text.slice(),0,a.length);if(d.length<=32)n.push(new we(d,h.length+a.length));else{let p=d.length>>1;n.push(new we(d.slice(0,p)),new we(d.slice(p)))}}else n.push(a)}replace(t,e,n){if(!(n instanceof we))return super.replace(t,e,n);let l=Kr(this.text,Kr(n.text,tp(this.text,0,t)),e),a=this.length+n.length-(e-t);return l.length<=32?new we(l,a):yt.from(we.split(l,[]),a)}sliceString(t,e=this.length,n=`
`){let l="";for(let a=0,h=0;a<=e&&h<this.text.length;h++){let d=this.text[h],p=a+d.length;a>t&&h&&(l+=n),t<p&&e>a&&(l+=d.slice(Math.max(0,t-a),e-a)),a=p+1}return l}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let n=[],l=-1;for(let a of t)n.push(a),l+=a.length+1,n.length==32&&(e.push(new we(n,l)),n=[],l=-1);return l>-1&&e.push(new we(n,l)),e}}class yt extends le{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let n of t)this.lines+=n.lines}lineInner(t,e,n,l){for(let a=0;;a++){let h=this.children[a],d=l+h.length,p=n+h.lines-1;if((e?p:d)>=t)return h.lineInner(t,e,n,l);l=d+1,n=p+1}}decompose(t,e,n,l){for(let a=0,h=0;h<=e&&a<this.children.length;a++){let d=this.children[a],p=h+d.length;if(t<=p&&e>=h){let g=l&((h<=t?1:0)|(p>=e?2:0));h>=t&&p<=e&&!g?n.push(d):d.decompose(t-h,e-h,n,g)}h=p+1}}replace(t,e,n){if(n.lines<this.lines)for(let l=0,a=0;l<this.children.length;l++){let h=this.children[l],d=a+h.length;if(t>=a&&e<=d){let p=h.replace(t-a,e-a,n),g=this.lines-h.lines+p.lines;if(p.lines<g>>5-1&&p.lines>g>>5+1){let m=this.children.slice();return m[l]=p,new yt(m,this.length-(e-t)+n.length)}return super.replace(a,d,p)}a=d+1}return super.replace(t,e,n)}sliceString(t,e=this.length,n=`
`){let l="";for(let a=0,h=0;a<this.children.length&&h<=e;a++){let d=this.children[a],p=h+d.length;h>t&&a&&(l+=n),t<p&&e>h&&(l+=d.sliceString(t-h,e-h,n)),h=p+1}return l}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof yt))return 0;let n=0,[l,a,h,d]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;l+=e,a+=e){if(l==h||a==d)return n;let p=this.children[l],g=t.children[a];if(p!=g)return n+p.scanIdentical(g,e);n+=p.length+1}}static from(t,e=t.reduce((n,l)=>n+l.length+1,-1)){let n=0;for(let k of t)n+=k.lines;if(n<32){let k=[];for(let C of t)C.flatten(k);return new we(k,e)}let l=Math.max(32,n>>5),a=l<<1,h=l>>1,d=[],p=0,g=-1,m=[];function y(k){let C;if(k.lines>a&&k instanceof yt)for(let O of k.children)y(O);else k.lines>h&&(p>h||!p)?(b(),d.push(k)):k instanceof we&&p&&(C=m[m.length-1])instanceof we&&k.lines+C.lines<=32?(p+=k.lines,g+=k.length+1,m[m.length-1]=new we(C.text.concat(k.text),C.length+1+k.length)):(p+k.lines>l&&b(),p+=k.lines,g+=k.length+1,m.push(k))}function b(){p!=0&&(d.push(m.length==1?m[0]:yt.from(m,g)),g=-1,p=m.length=0)}for(let k of t)y(k);return b(),d.length==1?d[0]:new yt(d,e)}}le.empty=new we([""],0);function NS(r){let t=-1;for(let e of r)t+=e.length+1;return t}function Kr(r,t,e=0,n=1e9){for(let l=0,a=0,h=!0;a<r.length&&l<=n;a++){let d=r[a],p=l+d.length;p>=e&&(p>n&&(d=d.slice(0,n-l)),l<e&&(d=d.slice(e-l)),h?(t[t.length-1]+=d,h=!1):t.push(d)),l=p+1}return t}function tp(r,t,e){return Kr(r,[""],t,e)}class sr{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof we?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,l=this.nodes[n],a=this.offsets[n],h=a>>1,d=l instanceof we?l.text.length:l.children.length;if(h==(e>0?d:0)){if(n==0)return this.done=!0,this.value="",this;e>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(e>0?0:1)){if(this.offsets[n]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(l instanceof we){let p=l.text[h+(e<0?-1:0)];if(this.offsets[n]+=e,p.length>Math.max(0,t))return this.value=t==0?p:e>0?p.slice(t):p.slice(0,p.length-t),this;t-=p.length}else{let p=l.children[h+(e<0?-1:0)];t>p.length?(t-=p.length,this.offsets[n]+=e):(e<0&&this.offsets[n]--,this.nodes.push(p),this.offsets.push(e>0?1:(p instanceof we?p.text.length:p.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Og{constructor(t,e,n){this.value="",this.done=!1,this.cursor=new sr(t,e>n?-1:1),this.pos=e>n?t.length:0,this.from=Math.min(e,n),this.to=Math.max(e,n)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let n=e<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:l}=this.cursor.next(t);return this.pos+=(l.length+t)*e,this.value=l.length<=n?l:e<0?l.slice(l.length-n):l.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Ig{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:n,value:l}=this.inner.next(t);return e?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=l,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(le.prototype[Symbol.iterator]=function(){return this.iter()},sr.prototype[Symbol.iterator]=Og.prototype[Symbol.iterator]=Ig.prototype[Symbol.iterator]=function(){return this});class LS{constructor(t,e,n,l){this.from=t,this.to=e,this.number=n,this.text=l}get length(){return this.to-this.from}}let Si="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(r=>r?parseInt(r,36):1);for(let r=1;r<Si.length;r++)Si[r]+=Si[r-1];function _S(r){for(let t=1;t<Si.length;t+=2)if(Si[t]>r)return Si[t-1]<=r;return!1}function ip(r){return r>=127462&&r<=127487}const rp=8205;function Mt(r,t,e=!0,n=!0){return(e?Ng:BS)(r,t,n)}function Ng(r,t,e){if(t==r.length)return t;t&&Lg(r.charCodeAt(t))&&_g(r.charCodeAt(t-1))&&t--;let n=Xr(r,t);for(t+=Jn(n);t<r.length;){let l=Xr(r,t);if(n==rp||l==rp||e&&_S(l))t+=Jn(l),n=l;else if(ip(l)){let a=0,h=t-2;for(;h>=0&&ip(Xr(r,h));)a++,h-=2;if(a%2==0)break;t+=2}else break}return t}function BS(r,t,e){for(;t>0;){let n=Ng(r,t-2,e);if(n<t)return n;t--}return 0}function Lg(r){return r>=56320&&r<57344}function _g(r){return r>=55296&&r<56320}function Xr(r,t){let e=r.charCodeAt(t);if(!_g(e)||t+1==r.length)return e;let n=r.charCodeAt(t+1);return Lg(n)?(e-55296<<10)+(n-56320)+65536:e}function Jn(r){return r<65536?1:2}const Zn=/\r\n?|\n/;var Ke=function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r}(Ke||(Ke={}));class wt{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e+1];t+=n<0?this.sections[e]:n}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,n=0,l=0;e<this.sections.length;){let a=this.sections[e++],h=this.sections[e++];h<0?(t(n,l,a),l+=a):l+=h,n+=a}}iterChangedRanges(t,e=!1){Qn(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let n=this.sections[e++],l=this.sections[e++];l<0?t.push(n,l):t.push(l,n)}return new wt(t)}composeDesc(t){return this.empty?t:t.empty?this:Bg(this,t)}mapDesc(t,e=!1){return t.empty?this:el(this,t,e)}mapPos(t,e=-1,n=Ke.Simple){let l=0,a=0;for(let h=0;h<this.sections.length;){let d=this.sections[h++],p=this.sections[h++],g=l+d;if(p<0){if(g>t)return a+(t-l);a+=d}else{if(n!=Ke.Simple&&g>=t&&(n==Ke.TrackDel&&l<t&&g>t||n==Ke.TrackBefore&&l<t||n==Ke.TrackAfter&&g>t))return null;if(g>t||g==t&&e<0&&!d)return t==l||e<0?a:a+p;a+=p}l=g}if(t>l)throw new RangeError(`Position ${t} is out of range for changeset of length ${l}`);return a}touchesRange(t,e=t){for(let n=0,l=0;n<this.sections.length&&l<=e;){let a=this.sections[n++],h=this.sections[n++],d=l+a;if(h>=0&&l<=e&&d>=t)return l<t&&d>e?"cover":!0;l=d}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let n=this.sections[e++],l=this.sections[e++];t+=(t?" ":"")+n+(l>=0?":"+l:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new wt(t)}static create(t){return new wt(t)}}class $e extends wt{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Qn(this,(e,n,l,a,h)=>t=t.replace(l,l+(n-e),h),!1),t}mapDesc(t,e=!1){return el(this,t,e,!0)}invert(t){let e=this.sections.slice(),n=[];for(let l=0,a=0;l<e.length;l+=2){let h=e[l],d=e[l+1];if(d>=0){e[l]=d,e[l+1]=h;let p=l>>1;for(;n.length<p;)n.push(le.empty);n.push(h?t.slice(a,a+h):le.empty)}a+=h}return new $e(e,n)}compose(t){return this.empty?t:t.empty?this:Bg(this,t,!0)}map(t,e=!1){return t.empty?this:el(this,t,e,!0)}iterChanges(t,e=!1){Qn(this,t,e)}get desc(){return wt.create(this.sections)}filter(t){let e=[],n=[],l=[],a=new lr(this);e:for(let h=0,d=0;;){let p=h==t.length?1e9:t[h++];for(;d<p||d==p&&a.len==0;){if(a.done)break e;let m=Math.min(a.len,p-d);_e(l,m,-1);let y=a.ins==-1?-1:a.off==0?a.ins:0;_e(e,m,y),y>0&&Bt(n,e,a.text),a.forward(m),d+=m}let g=t[h++];for(;d<g;){if(a.done)break e;let m=Math.min(a.len,g-d);_e(e,m,-1),_e(l,m,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(m),d+=m}}return{changes:new $e(e,n),filtered:wt.create(l)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e],l=this.sections[e+1];l<0?t.push(n):l==0?t.push([n]):t.push([n].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,n){let l=[],a=[],h=0,d=null;function p(m=!1){if(!m&&!l.length)return;h<e&&_e(l,e-h,-1);let y=new $e(l,a);d=d?d.compose(y.map(d)):y,l=[],a=[],h=0}function g(m){if(Array.isArray(m))for(let y of m)g(y);else if(m instanceof $e){if(m.length!=e)throw new RangeError(`Mismatched change set length (got ${m.length}, expected ${e})`);p(),d=d?d.compose(m.map(d)):m}else{let{from:y,to:b=y,insert:k}=m;if(y>b||y<0||b>e)throw new RangeError(`Invalid change range ${y} to ${b} (in doc of length ${e})`);let C=k?typeof k=="string"?le.of(k.split(n||Zn)):k:le.empty,O=C.length;if(y==b&&O==0)return;y<h&&p(),y>h&&_e(l,y-h,-1),_e(l,b-y,O),Bt(a,l,C),h=b}}return g(t),p(!d),d}static empty(t){return new $e(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],n=[];for(let l=0;l<t.length;l++){let a=t[l];if(typeof a=="number")e.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((h,d)=>d&&typeof h!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)e.push(a[0],0);else{for(;n.length<l;)n.push(le.empty);n[l]=le.of(a.slice(1)),e.push(a[0],n[l].length)}}}return new $e(e,n)}static createSet(t,e){return new $e(t,e)}}function _e(r,t,e,n=!1){if(t==0&&e<=0)return;let l=r.length-2;l>=0&&e<=0&&e==r[l+1]?r[l]+=t:t==0&&r[l]==0?r[l+1]+=e:n?(r[l]+=t,r[l+1]+=e):r.push(t,e)}function Bt(r,t,e){if(e.length==0)return;let n=t.length-2>>1;if(n<r.length)r[r.length-1]=r[r.length-1].append(e);else{for(;r.length<n;)r.push(le.empty);r.push(e)}}function Qn(r,t,e){let n=r.inserted;for(let l=0,a=0,h=0;h<r.sections.length;){let d=r.sections[h++],p=r.sections[h++];if(p<0)l+=d,a+=d;else{let g=l,m=a,y=le.empty;for(;g+=d,m+=p,p&&n&&(y=y.append(n[h-2>>1])),!(e||h==r.sections.length||r.sections[h+1]<0);)d=r.sections[h++],p=r.sections[h++];t(l,g,a,m,y),l=g,a=m}}}function el(r,t,e,n=!1){let l=[],a=n?[]:null,h=new lr(r),d=new lr(t);for(let p=-1;;)if(h.ins==-1&&d.ins==-1){let g=Math.min(h.len,d.len);_e(l,g,-1),h.forward(g),d.forward(g)}else if(d.ins>=0&&(h.ins<0||p==h.i||h.off==0&&(d.len<h.len||d.len==h.len&&!e))){let g=d.len;for(_e(l,d.ins,-1);g;){let m=Math.min(h.len,g);h.ins>=0&&p<h.i&&h.len<=m&&(_e(l,0,h.ins),a&&Bt(a,l,h.text),p=h.i),h.forward(m),g-=m}d.next()}else if(h.ins>=0){let g=0,m=h.len;for(;m;)if(d.ins==-1){let y=Math.min(m,d.len);g+=y,m-=y,d.forward(y)}else if(d.ins==0&&d.len<m)m-=d.len,d.next();else break;_e(l,g,p<h.i?h.ins:0),a&&p<h.i&&Bt(a,l,h.text),p=h.i,h.forward(h.len-m)}else{if(h.done&&d.done)return a?$e.createSet(l,a):wt.create(l);throw new Error("Mismatched change set lengths")}}function Bg(r,t,e=!1){let n=[],l=e?[]:null,a=new lr(r),h=new lr(t);for(let d=!1;;){if(a.done&&h.done)return l?$e.createSet(n,l):wt.create(n);if(a.ins==0)_e(n,a.len,0,d),a.next();else if(h.len==0&&!h.done)_e(n,0,h.ins,d),l&&Bt(l,n,h.text),h.next();else{if(a.done||h.done)throw new Error("Mismatched change set lengths");{let p=Math.min(a.len2,h.len),g=n.length;if(a.ins==-1){let m=h.ins==-1?-1:h.off?0:h.ins;_e(n,p,m,d),l&&m&&Bt(l,n,h.text)}else h.ins==-1?(_e(n,a.off?0:a.len,p,d),l&&Bt(l,n,a.textBit(p))):(_e(n,a.off?0:a.len,h.off?0:h.ins,d),l&&!h.off&&Bt(l,n,h.text));d=(a.ins>p||h.ins>=0&&h.len>p)&&(d||n.length>g),a.forward2(p),h.forward(p)}}}}class lr{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?le.empty:t[e]}textBit(t){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length&&!t?le.empty:e[n].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Qt{constructor(t,e,n){this.from=t,this.to=e,this.flags=n}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let t=this.flags&3;return t==3?null:t}get goalColumn(){let t=this.flags>>5;return t==33554431?void 0:t}map(t,e=-1){let n,l;return this.empty?n=l=t.mapPos(this.from,e):(n=t.mapPos(this.from,1),l=t.mapPos(this.to,-1)),n==this.from&&l==this.to?this:new Qt(n,l,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return q.range(t,e);let n=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return q.range(this.anchor,n)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return q.range(t.anchor,t.head)}static create(t,e,n){return new Qt(t,e,n)}}class q{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:q.create(this.ranges.map(n=>n.map(t,e)),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new q([this.main],0)}addRange(t,e=!0){return q.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let n=this.ranges.slice();return n[e]=t,q.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new q(t.ranges.map(e=>Qt.fromJSON(e)),t.main)}static single(t,e=t){return new q([q.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,l=0;l<t.length;l++){let a=t[l];if(a.empty?a.from<=n:a.from<n)return q.normalized(t.slice(),e);n=a.to}return new q(t,e)}static cursor(t,e=0,n,l){return Qt.create(t,t,(e==0?0:e<0?4:8)|(n==null?3:Math.min(2,n))|(l??33554431)<<5)}static range(t,e,n,l){let a=(n??33554431)<<5|(l==null?3:Math.min(2,l));return e<t?Qt.create(e,t,24|a):Qt.create(t,e,(e>t?4:0)|a)}static normalized(t,e=0){let n=t[e];t.sort((l,a)=>l.from-a.from),e=t.indexOf(n);for(let l=1;l<t.length;l++){let a=t[l],h=t[l-1];if(a.empty?a.from<=h.to:a.from<h.to){let d=h.from,p=Math.max(a.to,h.to);l<=e&&e--,t.splice(--l,2,a.anchor>a.head?q.range(p,d):q.range(d,p))}}return new q(t,e)}}function Fg(r,t){for(let e of r.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let Fl=0;class K{constructor(t,e,n,l,a){this.combine=t,this.compareInput=e,this.compare=n,this.isStatic=l,this.id=Fl++,this.default=t([]),this.extensions=typeof a=="function"?a(this):a}static define(t={}){return new K(t.combine||(e=>e),t.compareInput||((e,n)=>e===n),t.compare||(t.combine?(e,n)=>e===n:Vl),!!t.static,t.enables)}of(t){return new Yr([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Yr(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Yr(t,this,2,e)}from(t,e){return e||(e=n=>n),this.compute([t],n=>e(n.field(t)))}}function Vl(r,t){return r==t||r.length==t.length&&r.every((e,n)=>e===t[n])}class Yr{constructor(t,e,n,l){this.dependencies=t,this.facet=e,this.type=n,this.value=l,this.id=Fl++}dynamicSlot(t){var e;let n=this.value,l=this.facet.compareInput,a=this.id,h=t[a]>>1,d=this.type==2,p=!1,g=!1,m=[];for(let y of this.dependencies)y=="doc"?p=!0:y=="selection"?g=!0:((e=t[y.id])!==null&&e!==void 0?e:1)&1||m.push(t[y.id]);return{create(y){return y.values[h]=n(y),1},update(y,b){if(p&&b.docChanged||g&&(b.docChanged||b.selection)||tl(y,m)){let k=n(y);if(d?!sp(k,y.values[h],l):!l(k,y.values[h]))return y.values[h]=k,1}return 0},reconfigure:(y,b)=>{let k,C=b.config.address[a];if(C!=null){let O=hs(b,C);if(this.dependencies.every(M=>M instanceof K?b.facet(M)===y.facet(M):M instanceof At?b.field(M,!1)==y.field(M,!1):!0)||(d?sp(k=n(y),O,l):l(k=n(y),O)))return y.values[h]=O,0}else k=n(y);return y.values[h]=k,1}}}}function sp(r,t,e){if(r.length!=t.length)return!1;for(let n=0;n<r.length;n++)if(!e(r[n],t[n]))return!1;return!0}function tl(r,t){let e=!1;for(let n of t)nr(r,n)&1&&(e=!0);return e}function FS(r,t,e){let n=e.map(p=>r[p.id]),l=e.map(p=>p.type),a=n.filter(p=>!(p&1)),h=r[t.id]>>1;function d(p){let g=[];for(let m=0;m<n.length;m++){let y=hs(p,n[m]);if(l[m]==2)for(let b of y)g.push(b);else g.push(y)}return t.combine(g)}return{create(p){for(let g of n)nr(p,g);return p.values[h]=d(p),1},update(p,g){if(!tl(p,a))return 0;let m=d(p);return t.compare(m,p.values[h])?0:(p.values[h]=m,1)},reconfigure(p,g){let m=tl(p,n),y=g.config.facets[t.id],b=g.facet(t);if(y&&!m&&Vl(e,y))return p.values[h]=b,0;let k=d(p);return t.compare(k,b)?(p.values[h]=b,0):(p.values[h]=k,1)}}}const np=K.define({static:!0});class At{constructor(t,e,n,l,a){this.id=t,this.createF=e,this.updateF=n,this.compareF=l,this.spec=a,this.provides=void 0}static define(t){let e=new At(Fl++,t.create,t.update,t.compare||((n,l)=>n===l),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(np).find(n=>n.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:n=>(n.values[e]=this.create(n),1),update:(n,l)=>{let a=n.values[e],h=this.updateF(a,l);return this.compareF(a,h)?0:(n.values[e]=h,1)},reconfigure:(n,l)=>l.config.address[this.id]!=null?(n.values[e]=l.field(this),0):(n.values[e]=this.create(n),1)}}init(t){return[this,np.of({field:this,create:t})]}get extension(){return this}}const Jt={lowest:4,low:3,default:2,high:1,highest:0};function Ki(r){return t=>new Vg(t,r)}const Hl={highest:Ki(Jt.highest),high:Ki(Jt.high),default:Ki(Jt.default),low:Ki(Jt.low),lowest:Ki(Jt.lowest)};class Vg{constructor(t,e){this.inner=t,this.prec=e}}class Ts{of(t){return new il(this,t)}reconfigure(t){return Ts.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class il{constructor(t,e){this.compartment=t,this.inner=e}}class us{constructor(t,e,n,l,a,h){for(this.base=t,this.compartments=e,this.dynamicSlots=n,this.address=l,this.staticValues=a,this.facets=h,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,n){let l=[],a=Object.create(null),h=new Map;for(let b of VS(t,e,h))b instanceof At?l.push(b):(a[b.facet.id]||(a[b.facet.id]=[])).push(b);let d=Object.create(null),p=[],g=[];for(let b of l)d[b.id]=g.length<<1,g.push(k=>b.slot(k));let m=n==null?void 0:n.config.facets;for(let b in a){let k=a[b],C=k[0].facet,O=m&&m[b]||[];if(k.every(M=>M.type==0))if(d[C.id]=p.length<<1|1,Vl(O,k))p.push(n.facet(C));else{let M=C.combine(k.map(I=>I.value));p.push(n&&C.compare(M,n.facet(C))?n.facet(C):M)}else{for(let M of k)M.type==0?(d[M.id]=p.length<<1|1,p.push(M.value)):(d[M.id]=g.length<<1,g.push(I=>M.dynamicSlot(I)));d[C.id]=g.length<<1,g.push(M=>FS(M,C,k))}}let y=g.map(b=>b(d));return new us(t,h,y,d,p,a)}}function VS(r,t,e){let n=[[],[],[],[],[]],l=new Map;function a(h,d){let p=l.get(h);if(p!=null){if(p<=d)return;let g=n[p].indexOf(h);g>-1&&n[p].splice(g,1),h instanceof il&&e.delete(h.compartment)}if(l.set(h,d),Array.isArray(h))for(let g of h)a(g,d);else if(h instanceof il){if(e.has(h.compartment))throw new RangeError("Duplicate use of compartment in extensions");let g=t.get(h.compartment)||h.inner;e.set(h.compartment,g),a(g,d)}else if(h instanceof Vg)a(h.inner,h.prec);else if(h instanceof At)n[d].push(h),h.provides&&a(h.provides,d);else if(h instanceof Yr)n[d].push(h),h.facet.extensions&&a(h.facet.extensions,Jt.default);else{let g=h.extension;if(!g)throw new Error(`Unrecognized extension value in extension set (${h}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(g,d)}}return a(r,Jt.default),n.reduce((h,d)=>h.concat(d))}function nr(r,t){if(t&1)return 2;let e=t>>1,n=r.status[e];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;r.status[e]=4;let l=r.computeSlot(r,r.config.dynamicSlots[e]);return r.status[e]=2|l}function hs(r,t){return t&1?r.config.staticValues[t>>1]:r.values[t>>1]}const Hg=K.define(),Wg=K.define({combine:r=>r.some(t=>t),static:!0}),zg=K.define({combine:r=>r.length?r[0]:void 0,static:!0}),Ug=K.define(),qg=K.define(),Gg=K.define(),jg=K.define({combine:r=>r.length?r[0]:!1});class jt{constructor(t,e){this.type=t,this.value=e}static define(){return new HS}}class HS{of(t){return new jt(this,t)}}class WS{constructor(t){this.map=t}of(t){return new de(this,t)}}class de{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new de(this.type,e)}is(t){return this.type==t}static define(t={}){return new WS(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let n=[];for(let l of t){let a=l.map(e);a&&n.push(a)}return n}}de.reconfigure=de.define();de.appendConfig=de.define();class Ce{constructor(t,e,n,l,a,h){this.startState=t,this.changes=e,this.selection=n,this.effects=l,this.annotations=a,this.scrollIntoView=h,this._doc=null,this._state=null,n&&Fg(n,e.newLength),a.some(d=>d.type==Ce.time)||(this.annotations=a.concat(Ce.time.of(Date.now())))}static create(t,e,n,l,a,h){return new Ce(t,e,n,l,a,h)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Ce.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Ce.time=jt.define();Ce.userEvent=jt.define();Ce.addToHistory=jt.define();Ce.remote=jt.define();function zS(r,t){let e=[];for(let n=0,l=0;;){let a,h;if(n<r.length&&(l==t.length||t[l]>=r[n]))a=r[n++],h=r[n++];else if(l<t.length)a=t[l++],h=t[l++];else return e;!e.length||e[e.length-1]<a?e.push(a,h):e[e.length-1]<h&&(e[e.length-1]=h)}}function Kg(r,t,e){var n;let l,a,h;return e?(l=t.changes,a=$e.empty(t.changes.length),h=r.changes.compose(t.changes)):(l=t.changes.map(r.changes),a=r.changes.mapDesc(t.changes,!0),h=r.changes.compose(l)),{changes:h,selection:t.selection?t.selection.map(a):(n=r.selection)===null||n===void 0?void 0:n.map(l),effects:de.mapEffects(r.effects,l).concat(de.mapEffects(t.effects,a)),annotations:r.annotations.length?r.annotations.concat(t.annotations):t.annotations,scrollIntoView:r.scrollIntoView||t.scrollIntoView}}function rl(r,t,e){let n=t.selection,l=Ai(t.annotations);return t.userEvent&&(l=l.concat(Ce.userEvent.of(t.userEvent))),{changes:t.changes instanceof $e?t.changes:$e.of(t.changes||[],e,r.facet(zg)),selection:n&&(n instanceof q?n:q.single(n.anchor,n.head)),effects:Ai(t.effects),annotations:l,scrollIntoView:!!t.scrollIntoView}}function Xg(r,t,e){let n=rl(r,t.length?t[0]:{},r.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let a=1;a<t.length;a++){t[a].filter===!1&&(e=!1);let h=!!t[a].sequential;n=Kg(n,rl(r,t[a],h?n.changes.newLength:r.doc.length),h)}let l=Ce.create(r,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return qS(e?US(l):l)}function US(r){let t=r.startState,e=!0;for(let l of t.facet(Ug)){let a=l(r);if(a===!1){e=!1;break}Array.isArray(a)&&(e=e===!0?a:zS(e,a))}if(e!==!0){let l,a;if(e===!1)a=r.changes.invertedDesc,l=$e.empty(t.doc.length);else{let h=r.changes.filter(e);l=h.changes,a=h.filtered.mapDesc(h.changes).invertedDesc}r=Ce.create(t,l,r.selection&&r.selection.map(a),de.mapEffects(r.effects,a),r.annotations,r.scrollIntoView)}let n=t.facet(qg);for(let l=n.length-1;l>=0;l--){let a=n[l](r);a instanceof Ce?r=a:Array.isArray(a)&&a.length==1&&a[0]instanceof Ce?r=a[0]:r=Xg(t,Ai(a),!1)}return r}function qS(r){let t=r.startState,e=t.facet(Gg),n=r;for(let l=e.length-1;l>=0;l--){let a=e[l](r);a&&Object.keys(a).length&&(n=Kg(n,rl(t,a,r.changes.newLength),!0))}return n==r?r:Ce.create(t,r.changes,r.selection,n.effects,n.annotations,n.scrollIntoView)}const GS=[];function Ai(r){return r==null?GS:Array.isArray(r)?r:[r]}var Tt=function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r}(Tt||(Tt={}));const jS=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let sl;try{sl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function KS(r){if(sl)return sl.test(r);for(let t=0;t<r.length;t++){let e=r[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||jS.test(e)))return!0}return!1}function XS(r){return t=>{if(!/\S/.test(t))return Tt.Space;if(KS(t))return Tt.Word;for(let e=0;e<r.length;e++)if(t.indexOf(r[e])>-1)return Tt.Word;return Tt.Other}}class se{constructor(t,e,n,l,a,h){this.config=t,this.doc=e,this.selection=n,this.values=l,this.status=t.statusTemplate.slice(),this.computeSlot=a,h&&(h._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)nr(this,d<<1);this.computeSlot=null}field(t,e=!0){let n=this.config.address[t.id];if(n==null){if(e)throw new RangeError("Field is not present in this state");return}return nr(this,n),hs(this,n)}update(...t){return Xg(this,t,!0)}applyTransaction(t){let e=this.config,{base:n,compartments:l}=e;for(let h of t.effects)h.is(Ts.reconfigure)?(e&&(l=new Map,e.compartments.forEach((d,p)=>l.set(p,d)),e=null),l.set(h.value.compartment,h.value.extension)):h.is(de.reconfigure)?(e=null,n=h.value):h.is(de.appendConfig)&&(e=null,n=Ai(n).concat(h.value));let a;e?a=t.startState.values.slice():(e=us.resolve(n,l,this),a=new se(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(d,p)=>p.reconfigure(d,this),null).values),new se(e,t.newDoc,t.newSelection,a,(h,d)=>d.update(h,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:q.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,n=t(e.ranges[0]),l=this.changes(n.changes),a=[n.range],h=Ai(n.effects);for(let d=1;d<e.ranges.length;d++){let p=t(e.ranges[d]),g=this.changes(p.changes),m=g.map(l);for(let b=0;b<d;b++)a[b]=a[b].map(m);let y=l.mapDesc(g,!0);a.push(p.range.map(y)),l=l.compose(m),h=de.mapEffects(h,m).concat(de.mapEffects(Ai(p.effects),y))}return{changes:l,selection:q.create(a,e.mainIndex),effects:h}}changes(t=[]){return t instanceof $e?t:$e.of(t,this.doc.length,this.facet(se.lineSeparator))}toText(t){return le.of(t.split(this.facet(se.lineSeparator)||Zn))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(nr(this,e),hs(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let n in t){let l=t[n];l instanceof At&&this.config.address[l.id]!=null&&(e[n]=l.spec.toJSON(this.field(t[n]),this))}return e}static fromJSON(t,e={},n){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let l=[];if(n){for(let a in n)if(Object.prototype.hasOwnProperty.call(t,a)){let h=n[a],d=t[a];l.push(h.init(p=>h.spec.fromJSON(d,p)))}}return se.create({doc:t.doc,selection:q.fromJSON(t.selection),extensions:e.extensions?l.concat([e.extensions]):l})}static create(t={}){let e=us.resolve(t.extensions||[],new Map),n=t.doc instanceof le?t.doc:le.of((t.doc||"").split(e.staticFacet(se.lineSeparator)||Zn)),l=t.selection?t.selection instanceof q?t.selection:q.single(t.selection.anchor,t.selection.head):q.single(0);return Fg(l,n.length),e.staticFacet(Wg)||(l=l.asSingle()),new se(e,n,l,e.dynamicSlots.map(()=>null),(a,h)=>h.create(a),null)}get tabSize(){return this.facet(se.tabSize)}get lineBreak(){return this.facet(se.lineSeparator)||`
`}get readOnly(){return this.facet(jg)}phrase(t,...e){for(let n of this.facet(se.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(n,l)=>{if(l=="$")return"$";let a=+(l||1);return!a||a>e.length?n:e[a-1]})),t}languageDataAt(t,e,n=-1){let l=[];for(let a of this.facet(Hg))for(let h of a(this,e,n))Object.prototype.hasOwnProperty.call(h,t)&&l.push(h[t]);return l}charCategorizer(t){return XS(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:n,length:l}=this.doc.lineAt(t),a=this.charCategorizer(t),h=t-n,d=t-n;for(;h>0;){let p=Mt(e,h,!1);if(a(e.slice(p,h))!=Tt.Word)break;h=p}for(;d<l;){let p=Mt(e,d);if(a(e.slice(d,p))!=Tt.Word)break;d=p}return h==d?null:q.range(h+n,d+n)}}se.allowMultipleSelections=Wg;se.tabSize=K.define({combine:r=>r.length?r[0]:4});se.lineSeparator=zg;se.readOnly=jg;se.phrases=K.define({compare(r,t){let e=Object.keys(r),n=Object.keys(t);return e.length==n.length&&e.every(l=>r[l]==t[l])}});se.languageData=Hg;se.changeFilter=Ug;se.transactionFilter=qg;se.transactionExtender=Gg;Ts.reconfigure=de.define();function Wl(r,t,e={}){let n={};for(let l of r)for(let a of Object.keys(l)){let h=l[a],d=n[a];if(d===void 0)n[a]=h;else if(!(d===h||h===void 0))if(Object.hasOwnProperty.call(e,a))n[a]=e[a](d,h);else throw new Error("Config merge conflict for field "+a)}for(let l in t)n[l]===void 0&&(n[l]=t[l]);return n}class Ci{eq(t){return this==t}range(t,e=t){return nl.create(t,e,this)}}Ci.prototype.startSide=Ci.prototype.endSide=0;Ci.prototype.point=!1;Ci.prototype.mapMode=Ke.TrackDel;let nl=class Yg{constructor(t,e,n){this.from=t,this.to=e,this.value=n}static create(t,e,n){return new Yg(t,e,n)}};function ll(r,t){return r.from-t.from||r.value.startSide-t.value.startSide}class zl{constructor(t,e,n,l){this.from=t,this.to=e,this.value=n,this.maxPoint=l}get length(){return this.to[this.to.length-1]}findIndex(t,e,n,l=0){let a=n?this.to:this.from;for(let h=l,d=a.length;;){if(h==d)return h;let p=h+d>>1,g=a[p]-t||(n?this.value[p].endSide:this.value[p].startSide)-e;if(p==h)return g>=0?h:d;g>=0?d=p:h=p+1}}between(t,e,n,l){for(let a=this.findIndex(e,-1e9,!0),h=this.findIndex(n,1e9,!1,a);a<h;a++)if(l(this.from[a]+t,this.to[a]+t,this.value[a])===!1)return!1}map(t,e){let n=[],l=[],a=[],h=-1,d=-1;for(let p=0;p<this.value.length;p++){let g=this.value[p],m=this.from[p]+t,y=this.to[p]+t,b,k;if(m==y){let C=e.mapPos(m,g.startSide,g.mapMode);if(C==null||(b=k=C,g.startSide!=g.endSide&&(k=e.mapPos(m,g.endSide),k<b)))continue}else if(b=e.mapPos(m,g.startSide),k=e.mapPos(y,g.endSide),b>k||b==k&&g.startSide>0&&g.endSide<=0)continue;(k-b||g.endSide-g.startSide)<0||(h<0&&(h=b),g.point&&(d=Math.max(d,k-b)),n.push(g),l.push(b-h),a.push(k-h))}return{mapped:n.length?new zl(l,a,n,d):null,pos:h}}}class ge{constructor(t,e,n,l){this.chunkPos=t,this.chunk=e,this.nextLayer=n,this.maxPoint=l}static create(t,e,n,l){return new ge(t,e,n,l)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:n=!1,filterFrom:l=0,filterTo:a=this.length}=t,h=t.filter;if(e.length==0&&!h)return this;if(n&&(e=e.slice().sort(ll)),this.isEmpty)return e.length?ge.of(e):this;let d=new Jg(this,null,-1).goto(0),p=0,g=[],m=new or;for(;d.value||p<e.length;)if(p<e.length&&(d.from-e[p].from||d.startSide-e[p].value.startSide)>=0){let y=e[p++];m.addInner(y.from,y.to,y.value)||g.push(y)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==e.length||this.chunkEnd(d.chunkIndex)<e[p].from)&&(!h||l>this.chunkEnd(d.chunkIndex)||a<this.chunkPos[d.chunkIndex])&&m.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!h||l>d.to||a<d.from||h(d.from,d.to,d.value))&&(m.addInner(d.from,d.to,d.value)||g.push(nl.create(d.from,d.to,d.value))),d.next());return m.finishInner(this.nextLayer.isEmpty&&!g.length?ge.empty:this.nextLayer.update({add:g,filter:h,filterFrom:l,filterTo:a}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],n=[],l=-1;for(let h=0;h<this.chunk.length;h++){let d=this.chunkPos[h],p=this.chunk[h],g=t.touchesRange(d,d+p.length);if(g===!1)l=Math.max(l,p.maxPoint),e.push(p),n.push(t.mapPos(d));else if(g===!0){let{mapped:m,pos:y}=p.map(d,t);m&&(l=Math.max(l,m.maxPoint),e.push(m),n.push(y))}}let a=this.nextLayer.map(t);return e.length==0?a:new ge(n,e,a||ge.empty,l)}between(t,e,n){if(!this.isEmpty){for(let l=0;l<this.chunk.length;l++){let a=this.chunkPos[l],h=this.chunk[l];if(e>=a&&t<=a+h.length&&h.between(a,t-a,e-a,n)===!1)return}this.nextLayer.between(t,e,n)}}iter(t=0){return ar.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return ar.from(t).goto(e)}static compare(t,e,n,l,a=-1){let h=t.filter(y=>y.maxPoint>0||!y.isEmpty&&y.maxPoint>=a),d=e.filter(y=>y.maxPoint>0||!y.isEmpty&&y.maxPoint>=a),p=lp(h,d,n),g=new Xi(h,p,a),m=new Xi(d,p,a);n.iterGaps((y,b,k)=>op(g,y,m,b,k,l)),n.empty&&n.length==0&&op(g,0,m,0,0,l)}static eq(t,e,n=0,l){l==null&&(l=1e9-1);let a=t.filter(m=>!m.isEmpty&&e.indexOf(m)<0),h=e.filter(m=>!m.isEmpty&&t.indexOf(m)<0);if(a.length!=h.length)return!1;if(!a.length)return!0;let d=lp(a,h),p=new Xi(a,d,0).goto(n),g=new Xi(h,d,0).goto(n);for(;;){if(p.to!=g.to||!ol(p.active,g.active)||p.point&&(!g.point||!p.point.eq(g.point)))return!1;if(p.to>l)return!0;p.next(),g.next()}}static spans(t,e,n,l,a=-1){let h=new Xi(t,null,a).goto(e),d=e,p=h.openStart;for(;;){let g=Math.min(h.to,n);if(h.point){let m=h.activeForPoint(h.to),y=h.pointFrom<e?m.length+1:Math.min(m.length,p);l.point(d,g,h.point,m,y,h.pointRank),p=Math.min(h.openEnd(g),m.length)}else g>d&&(l.span(d,g,h.active,p),p=h.openEnd(g));if(h.to>n)return p+(h.point&&h.to>n?1:0);d=h.to,h.next()}}static of(t,e=!1){let n=new or;for(let l of t instanceof nl?[t]:e?YS(t):t)n.add(l.from,l.to,l.value);return n.finish()}}ge.empty=new ge([],[],null,-1);function YS(r){if(r.length>1)for(let t=r[0],e=1;e<r.length;e++){let n=r[e];if(ll(t,n)>0)return r.slice().sort(ll);t=n}return r}ge.empty.nextLayer=ge.empty;class or{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new zl(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,n){this.addInner(t,e,n)||(this.nextLayer||(this.nextLayer=new or)).add(t,e,n)}addInner(t,e,n){let l=t-this.lastTo||n.startSide-this.last.endSide;if(l<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return l<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=e,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let n=e.value.length-1;return this.last=e.value[n],this.lastFrom=e.from[n]+t,this.lastTo=e.to[n]+t,!0}finish(){return this.finishInner(ge.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=ge.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function lp(r,t,e){let n=new Map;for(let a of r)for(let h=0;h<a.chunk.length;h++)a.chunk[h].maxPoint<=0&&n.set(a.chunk[h],a.chunkPos[h]);let l=new Set;for(let a of t)for(let h=0;h<a.chunk.length;h++){let d=n.get(a.chunk[h]);d!=null&&(e?e.mapPos(d):d)==a.chunkPos[h]&&!(e!=null&&e.touchesRange(d,d+a.chunk[h].length))&&l.add(a.chunk[h])}return l}class Jg{constructor(t,e,n,l=0){this.layer=t,this.skip=e,this.minPoint=n,this.rank=l}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,n){for(;this.chunkIndex<this.layer.chunk.length;){let l=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(l)||this.layer.chunkEnd(this.chunkIndex)<t||l.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let l=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!n||this.rangeIndex<l)&&this.setRangeIndex(l)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],n=t+e.from[this.rangeIndex];if(this.from=n,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class ar{constructor(t){this.heap=t}static from(t,e=null,n=-1){let l=[];for(let a=0;a<t.length;a++)for(let h=t[a];!h.isEmpty;h=h.nextLayer)h.maxPoint>=n&&l.push(new Jg(h,e,n,a));return l.length==1?l[0]:new ar(l)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let n of this.heap)n.goto(t,e);for(let n=this.heap.length>>1;n>=0;n--)Tn(this.heap,n);return this.next(),this}forward(t,e){for(let n of this.heap)n.forward(t,e);for(let n=this.heap.length>>1;n>=0;n--)Tn(this.heap,n);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Tn(this.heap,0)}}}function Tn(r,t){for(let e=r[t];;){let n=(t<<1)+1;if(n>=r.length)break;let l=r[n];if(n+1<r.length&&l.compare(r[n+1])>=0&&(l=r[n+1],n++),e.compare(l)<0)break;r[n]=e,r[t]=l,t=n}}class Xi{constructor(t,e,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=ar.from(t,e,n)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Er(this.active,t),Er(this.activeTo,t),Er(this.activeRank,t),this.minActive=ap(this.active,this.activeTo)}addActive(t){let e=0,{value:n,to:l,rank:a}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=a;)e++;Rr(this.active,e,n),Rr(this.activeTo,e,l),Rr(this.activeRank,e,a),t&&Rr(t,e,this.cursor.from),this.minActive=ap(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let l=this.minActive;if(l>-1&&(this.activeTo[l]-this.cursor.from||this.active[l].endSide-this.cursor.startSide)<0){if(this.activeTo[l]>t){this.to=this.activeTo[l],this.endSide=this.active[l].endSide;break}this.removeActive(l),n&&Er(n,l)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(n),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let l=n.length-1;l>=0&&n[l]<t;l--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&e.push(this.active[n]);return e.reverse()}openEnd(t){let e=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)e++;return e}}function op(r,t,e,n,l,a){r.goto(t),e.goto(n);let h=n+l,d=n,p=n-t;for(;;){let g=r.to+p-e.to||r.endSide-e.endSide,m=g<0?r.to+p:e.to,y=Math.min(m,h);if(r.point||e.point?r.point&&e.point&&(r.point==e.point||r.point.eq(e.point))&&ol(r.activeForPoint(r.to+p),e.activeForPoint(e.to))||a.comparePoint(d,y,r.point,e.point):y>d&&!ol(r.active,e.active)&&a.compareRange(d,y,r.active,e.active),m>h)break;d=m,g<=0&&r.next(),g>=0&&e.next()}}function ol(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!=t[e]&&!r[e].eq(t[e]))return!1;return!0}function Er(r,t){for(let e=t,n=r.length-1;e<n;e++)r[e]=r[e+1];r.pop()}function Rr(r,t,e){for(let n=r.length-1;n>=t;n--)r[n+1]=r[n];r[t]=e}function ap(r,t){let e=-1,n=1e9;for(let l=0;l<t.length;l++)(t[l]-n||r[l].endSide-r[e].endSide)<0&&(e=l,n=t[l]);return e}function JS(r,t,e=r.length){let n=0;for(let l=0;l<e;)r.charCodeAt(l)==9?(n+=t-n%t,l++):(n++,l=Mt(r,l));return n}function ZS(r,t,e,n){for(let l=0,a=0;;){if(a>=t)return l;if(l==r.length)break;a+=r.charCodeAt(l)==9?e-a%e:1,l=Mt(r,l)}return n===!0?-1:r.length}const al="",fp=typeof Symbol>"u"?"__"+al:Symbol.for(al),fl=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),up=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Wt{constructor(t,e){this.rules=[];let{finish:n}=e||{};function l(h){return/^@/.test(h)?[h]:h.split(/,\s*/)}function a(h,d,p,g){let m=[],y=/^@(\w+)\b/.exec(h[0]),b=y&&y[1]=="keyframes";if(y&&d==null)return p.push(h[0]+";");for(let k in d){let C=d[k];if(/&/.test(k))a(k.split(/,\s*/).map(O=>h.map(M=>O.replace(/&/,M))).reduce((O,M)=>O.concat(M)),C,p);else if(C&&typeof C=="object"){if(!y)throw new RangeError("The value of a property ("+k+") should be a primitive value.");a(l(k),C,m,b)}else C!=null&&m.push(k.replace(/_.*/,"").replace(/[A-Z]/g,O=>"-"+O.toLowerCase())+": "+C+";")}(m.length||b)&&p.push((n&&!y&&!g?h.map(n):h).join(", ")+" {"+m.join(" ")+"}")}for(let h in t)a(l(h),t[h],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=up[fp]||1;return up[fp]=t+1,al+t.toString(36)}static mount(t,e){(t[fl]||new QS(t)).mount(Array.isArray(e)?e:[e])}}let hp=new Map;class QS{constructor(t){let e=t.ownerDocument||t,n=e.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let l=hp.get(e);if(l)return t.adoptedStyleSheets=[l.sheet,...t.adoptedStyleSheets],t[fl]=l;this.sheet=new n.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets],hp.set(e,this)}else{this.styleTag=e.createElement("style");let l=t.head||t;l.insertBefore(this.styleTag,l.firstChild)}this.modules=[],t[fl]=this}mount(t){let e=this.sheet,n=0,l=0;for(let a=0;a<t.length;a++){let h=t[a],d=this.modules.indexOf(h);if(d<l&&d>-1&&(this.modules.splice(d,1),l--,d=-1),d==-1){if(this.modules.splice(l++,0,h),e)for(let p=0;p<h.rules.length;p++)e.insertRule(h.rules[p],n++)}else{for(;l<d;)n+=this.modules[l++].rules.length;n+=h.rules.length,l++}}if(!e){let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a}}}var zt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},fr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},cp=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),eA=typeof navigator<"u"&&/Mac/.test(navigator.platform),tA=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),iA=eA||cp&&+cp[1]<57;for(var Oe=0;Oe<10;Oe++)zt[48+Oe]=zt[96+Oe]=String(Oe);for(var Oe=1;Oe<=24;Oe++)zt[Oe+111]="F"+Oe;for(var Oe=65;Oe<=90;Oe++)zt[Oe]=String.fromCharCode(Oe+32),fr[Oe]=String.fromCharCode(Oe);for(var Dn in zt)fr.hasOwnProperty(Dn)||(fr[Dn]=zt[Dn]);function rA(r){var t=iA&&(r.ctrlKey||r.altKey||r.metaKey)||tA&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",e=!t&&r.key||(r.shiftKey?fr:zt)[r.keyCode]||r.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function cs(r){let t;return r.nodeType==11?t=r.getSelection?r:r.ownerDocument:t=r,t.getSelection()}function Mi(r,t){return t?r==t||r.contains(t.nodeType!=1?t.parentNode:t):!1}function sA(r){let t=r.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Jr(r,t){if(!t.anchorNode)return!1;try{return Mi(r,t.anchorNode)}catch{return!1}}function ur(r){return r.nodeType==3?Ti(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function ds(r,t,e,n){return e?dp(r,t,e,n,-1)||dp(r,t,e,n,1):!1}function ps(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t}function dp(r,t,e,n,l){for(;;){if(r==e&&t==n)return!0;if(t==(l<0?0:Ut(r))){if(r.nodeName=="DIV")return!1;let a=r.parentNode;if(!a||a.nodeType!=1)return!1;t=ps(r)+(l<0?0:1),r=a}else if(r.nodeType==1){if(r=r.childNodes[t+(l<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;t=l<0?Ut(r):0}else return!1}}function Ut(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function Ul(r,t){let e=t?r.left:r.right;return{left:e,right:e,top:r.top,bottom:r.bottom}}function nA(r){return{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function lA(r,t,e,n,l,a,h,d){let p=r.ownerDocument,g=p.defaultView||window;for(let m=r;m;)if(m.nodeType==1){let y,b=m==p.body;if(b)y=nA(g);else{if(m.scrollHeight<=m.clientHeight&&m.scrollWidth<=m.clientWidth){m=m.assignedSlot||m.parentNode;continue}let O=m.getBoundingClientRect();y={left:O.left,right:O.left+m.clientWidth,top:O.top,bottom:O.top+m.clientHeight}}let k=0,C=0;if(l=="nearest")t.top<y.top?(C=-(y.top-t.top+h),e>0&&t.bottom>y.bottom+C&&(C=t.bottom-y.bottom+C+h)):t.bottom>y.bottom&&(C=t.bottom-y.bottom+h,e<0&&t.top-C<y.top&&(C=-(y.top+C-t.top+h)));else{let O=t.bottom-t.top,M=y.bottom-y.top;C=(l=="center"&&O<=M?t.top+O/2-M/2:l=="start"||l=="center"&&e<0?t.top-h:t.bottom-M+h)-y.top}if(n=="nearest"?t.left<y.left?(k=-(y.left-t.left+a),e>0&&t.right>y.right+k&&(k=t.right-y.right+k+a)):t.right>y.right&&(k=t.right-y.right+a,e<0&&t.left<y.left+k&&(k=-(y.left+k-t.left+a))):k=(n=="center"?t.left+(t.right-t.left)/2-(y.right-y.left)/2:n=="start"==d?t.left-a:t.right-(y.right-y.left)+a)-y.left,k||C)if(b)g.scrollBy(k,C);else{let O=0,M=0;if(C){let I=m.scrollTop;m.scrollTop+=C,M=m.scrollTop-I}if(k){let I=m.scrollLeft;m.scrollLeft+=k,O=m.scrollLeft-I}t={left:t.left-O,top:t.top-M,right:t.right-O,bottom:t.bottom-M},O&&Math.abs(O-k)<1&&(n="nearest"),M&&Math.abs(M-C)<1&&(l="nearest")}if(b)break;m=m.assignedSlot||m.parentNode}else if(m.nodeType==11)m=m.host;else break}function oA(r){let t=r.ownerDocument;for(let e=r.parentNode;e&&e!=t.body;)if(e.nodeType==1){if(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)return e;e=e.assignedSlot||e.parentNode}else if(e.nodeType==11)e=e.host;else break;return null}class aA{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:n}=t;this.set(e,Math.min(t.anchorOffset,e?Ut(e):0),n,Math.min(t.focusOffset,n?Ut(n):0))}set(t,e,n,l){this.anchorNode=t,this.anchorOffset=e,this.focusNode=n,this.focusOffset=l}}let mi=null;function Zg(r){if(r.setActive)return r.setActive();if(mi)return r.focus(mi);let t=[];for(let e=r;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(r.focus(mi==null?{get preventScroll(){return mi={preventScroll:!0},!0}}:void 0),!mi){mi=!1;for(let e=0;e<t.length;){let n=t[e++],l=t[e++],a=t[e++];n.scrollTop!=l&&(n.scrollTop=l),n.scrollLeft!=a&&(n.scrollLeft=a)}}}let pp;function Ti(r,t,e=t){let n=pp||(pp=document.createRange());return n.setEnd(r,e),n.setStart(r,t),n}function Pi(r,t,e){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0},l=new KeyboardEvent("keydown",n);l.synthetic=!0,r.dispatchEvent(l);let a=new KeyboardEvent("keyup",n);return a.synthetic=!0,r.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function fA(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function Qg(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function uA(r,t){let e=t.focusNode,n=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=n)return!1;for(n=Math.min(n,Ut(e));;)if(n){if(e.nodeType!=1)return!1;let l=e.childNodes[n-1];l.contentEditable=="false"?n--:(e=l,n=Ut(e))}else{if(e==r)return!0;n=ps(e),e=e.parentNode}}class Ie{constructor(t,e,n=!0){this.node=t,this.offset=e,this.precise=n}static before(t,e){return new Ie(t.parentNode,ps(t),e)}static after(t,e){return new Ie(t.parentNode,ps(t)+1,e)}}const ql=[];class he{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let n of this.children){if(n==t)return e;e+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.dirty&2){let n=this.dom,l=null,a;for(let h of this.children){if(h.dirty){if(!h.dom&&(a=l?l.nextSibling:n.firstChild)){let d=he.get(a);(!d||!d.parent&&d.canReuseDOM(h))&&h.reuseDOM(a)}h.sync(t,e),h.dirty=0}if(a=l?l.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&a!=h.dom&&(e.written=!0),h.dom.parentNode==n)for(;a&&a!=h.dom;)a=gp(a);else n.insertBefore(h.dom,a);l=h.dom}for(a=l?l.nextSibling:n.firstChild,a&&e&&e.node==n&&(e.written=!0);a;)a=gp(a)}else if(this.dirty&1)for(let n of this.children)n.dirty&&(n.sync(t,e),n.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let n;if(t==this.dom)n=this.dom.childNodes[e];else{let l=Ut(t)==0?0:e==0?-1:1;for(;;){let a=t.parentNode;if(a==this.dom)break;l==0&&a.firstChild!=a.lastChild&&(t==a.firstChild?l=-1:l=1),t=a}l<0?n=t:n=t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!he.get(n);)n=n.nextSibling;if(!n)return this.length;for(let l=0,a=0;;l++){let h=this.children[l];if(h.dom==n)return a;a+=h.length+h.breakAfter}}domBoundsAround(t,e,n=0){let l=-1,a=-1,h=-1,d=-1;for(let p=0,g=n,m=n;p<this.children.length;p++){let y=this.children[p],b=g+y.length;if(g<t&&b>e)return y.domBoundsAround(t,e,g);if(b>=t&&l==-1&&(l=p,a=g),g>e&&y.dom.parentNode==this.dom){h=p,d=m;break}m=b,g=b+y.breakAfter}return{from:a,to:d<0?n+this.length:d,startDOM:(l?this.children[l-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:h<this.children.length&&h>=0?this.children[h].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),e.dirty&1)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,n=ql){this.markDirty();for(let l=t;l<e;l++){let a=this.children[l];a.parent==this&&a.destroy()}this.children.splice(t,e-t,...n);for(let l=0;l<n.length;l++)n[l].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new em(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,n,l,a,h){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}he.prototype.breakAfter=0;function gp(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}class em{constructor(t,e,n){this.children=t,this.pos=e,this.i=n,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function tm(r,t,e,n,l,a,h,d,p){let{children:g}=r,m=g.length?g[t]:null,y=a.length?a[a.length-1]:null,b=y?y.breakAfter:h;if(!(t==n&&m&&!h&&!b&&a.length<2&&m.merge(e,l,a.length?y:null,e==0,d,p))){if(n<g.length){let k=g[n];k&&l<k.length?(t==n&&(k=k.split(l),l=0),!b&&y&&k.merge(0,l,y,!0,0,p)?a[a.length-1]=k:(l&&k.merge(0,l,null,!1,0,p),a.push(k))):k!=null&&k.breakAfter&&(y?y.breakAfter=1:h=1),n++}for(m&&(m.breakAfter=h,e>0&&(!h&&a.length&&m.merge(e,m.length,a[0],!1,d,0)?m.breakAfter=a.shift().breakAfter:(e<m.length||m.children.length&&m.children[m.children.length-1].length==0)&&m.merge(e,m.length,null,!1,d,0),t++));t<n&&a.length;)if(g[n-1].become(a[a.length-1]))n--,a.pop(),p=a.length?0:d;else if(g[t].become(a[0]))t++,a.shift(),d=a.length?0:p;else break;!a.length&&t&&n<g.length&&!g[t-1].breakAfter&&g[n].merge(0,0,g[t-1],!1,d,p)&&t--,(t<n||a.length)&&r.replaceChildren(t,n,a)}}function im(r,t,e,n,l,a){let h=r.childCursor(),{i:d,off:p}=h.findPos(e,1),{i:g,off:m}=h.findPos(t,-1),y=t-e;for(let b of n)y+=b.length;r.length+=y,tm(r,g,m,d,p,n,0,l,a)}let tt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},ul=typeof document<"u"?document:{documentElement:{style:{}}};const hl=/Edge\/(\d+)/.exec(tt.userAgent),rm=/MSIE \d/.test(tt.userAgent),cl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(tt.userAgent),Ds=!!(rm||cl||hl),mp=!Ds&&/gecko\/(\d+)/i.test(tt.userAgent),En=!Ds&&/Chrome\/(\d+)/.exec(tt.userAgent),vp="webkitFontSmoothing"in ul.documentElement.style,sm=!Ds&&/Apple Computer/.test(tt.vendor),yp=sm&&(/Mobile\/\w+/.test(tt.userAgent)||tt.maxTouchPoints>2);var U={mac:yp||/Mac/.test(tt.platform),windows:/Win/.test(tt.platform),linux:/Linux|X11/.test(tt.platform),ie:Ds,ie_version:rm?ul.documentMode||6:cl?+cl[1]:hl?+hl[1]:0,gecko:mp,gecko_version:mp?+(/Firefox\/(\d+)/.exec(tt.userAgent)||[0,0])[1]:0,chrome:!!En,chrome_version:En?+En[1]:0,ios:yp,android:/Android\b/.test(tt.userAgent),webkit:vp,safari:sm,webkit_version:vp?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:ul.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const hA=256;class si extends he{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,n){return n&&(!(n instanceof si)||this.length-(e-t)+n.length>hA)?!1:(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new si(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Ie(this.dom,t)}domBoundsAround(t,e,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return dl(this.dom,t,e)}}class Ot extends he{constructor(t,e=[],n=0){super(),this.mark=t,this.children=e,this.length=n;for(let l of e)l.setParent(this)}setAttrs(t){if(Qg(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t,e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,n,l,a,h){return n&&(!(n instanceof Ot&&n.mark.eq(this.mark))||t&&a<=0||e<this.length&&h<=0)?!1:(im(this,t,e,n?n.children:[],a-1,h-1),this.markDirty(),!0)}split(t){let e=[],n=0,l=-1,a=0;for(let d of this.children){let p=n+d.length;p>t&&e.push(n<t?d.split(t-n):d),l<0&&n>=t&&(l=a),n=p,a++}let h=this.length-t;return this.length=t,l>-1&&(this.children.length=l,this.markDirty()),new Ot(this.mark,e,h)}domAtPos(t){return fm(this,t)}coordsAt(t,e){return hm(this,t,e)}}function dl(r,t,e){let n=r.nodeValue.length;t>n&&(t=n);let l=t,a=t,h=0;t==0&&e<0||t==n&&e>=0?U.chrome||U.gecko||(t?(l--,h=1):a<n&&(a++,h=-1)):e<0?l--:a<n&&a++;let d=Ti(r,l,a).getClientRects();if(!d.length)return null;let p=d[(h?h<0:e>=0)?0:d.length-1];return U.safari&&!h&&p.width==0&&(p=Array.prototype.find.call(d,g=>g.width)||p),h?Ul(p,h<0):p||null}class Ft extends he{static create(t,e,n){return new(t.customView||Ft)(t,e,n)}constructor(t,e,n){super(),this.widget=t,this.length=e,this.side=n,this.prevWidget=null}split(t){let e=Ft.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,n,l,a,h){return n&&(!(n instanceof Ft)||!this.widget.compare(n.widget)||t>0&&a<=0||e<this.length&&h<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-e),!0)}become(t){return t instanceof Ft&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return le.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,n=e&&e.state.doc,l=this.posAtStart;return n?n.slice(l,l+this.length):le.empty}domAtPos(t){return(this.length?t==0:this.side>0)?Ie.before(this.dom):Ie.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let n=this.widget.coordsAt(this.dom,t,e);if(n)return n;let l=this.dom.getClientRects(),a=null;if(!l.length)return null;for(let h=t>0?l.length-1:0;a=l[h],!(t>0?h==0:h==l.length-1||a.top<a.bottom);h+=t>0?-1:1);return this.length?a:Ul(a,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class nm extends Ft{domAtPos(t){let{topView:e,text:n}=this.widget;return e?pl(t,0,e,n,this.length-e.length,(l,a)=>l.domAtPos(a),(l,a)=>new Ie(l,Math.min(a,l.nodeValue.length))):new Ie(n,Math.min(t,n.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:n,text:l}=this.widget;return n?om(t,e,n,l,this.length-n.length):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:n,text:l}=this.widget;return n?pl(t,e,n,l,this.length-n.length,(a,h,d)=>a.coordsAt(h,d),(a,h,d)=>dl(a,h,d)):dl(l,t,e)}destroy(){var t;super.destroy(),(t=this.widget.topView)===null||t===void 0||t.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function pl(r,t,e,n,l,a,h){if(e instanceof Ot){for(let d=e.dom.firstChild;d;d=d.nextSibling){let p=he.get(d);if(p){let g=Mi(d,n),m=p.length+(g?l:0);if(r<m||r==m&&p.getSide()<=0)return g?pl(r,t,p,n,l,a,h):a(p,r,t);r-=m}else{let g=lm(r,t,d,h);if(typeof g!="number")return g;r=g}}return a(e,e.length,-1)}else return e.dom==n?h(n,r,t):a(e,r,t)}function lm(r,t,e,n){if(e.nodeType==3){let l=e.nodeValue.length;if(r<=l)return n(e,r,t);r-=l}else if(e.nodeType==1&&e.contentEditable!="false")for(let l=e.firstChild;l;l=l.nextSibling){let a=lm(r,t,l,n);if(typeof a!="number")return a;r=a}return r}function om(r,t,e,n,l){if(e instanceof Ot){let a=0;for(let h=e.dom.firstChild;h;h=h.nextSibling){let d=he.get(h);if(d){let p=Mi(h,n);if(Mi(h,r))return a+(p?om(r,t,d,n,l):d.localPosFromDOM(r,t));a+=d.length+(p?l:0)}else{let p=am(r,t,h);if(p.result!=null)return a+p.result;a+=p.size}}}else if(e.dom==n)return Math.min(t,n.nodeValue.length);return e.localPosFromDOM(r,t)}function am(r,t,e){if(e.nodeType==3)return r==e?{result:t}:{size:e.nodeValue.length};if(e.nodeType==1&&e.contentEditable!="false"){let n=0;for(let l=e.firstChild,a=0;;l=l.nextSibling,a++){if(r==e&&a==t)return{result:n};if(!l)return{size:n};let h=am(r,t,l);if(h.result!=null)return{result:t+h.result};n+=h.size}}else return e.contains(r)?{result:0}:{size:0}}class Di extends he{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Di&&t.side==this.side}split(){return new Di(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Ie.before(this.dom):Ie.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return le.empty}get isHidden(){return!0}}si.prototype.children=Ft.prototype.children=Di.prototype.children=ql;function fm(r,t){let e=r.dom,{children:n}=r,l=0;for(let a=0;l<n.length;l++){let h=n[l],d=a+h.length;if(!(d==a&&h.getSide()<=0)){if(t>a&&t<d&&h.dom.parentNode==e)return h.domAtPos(t-a);if(t<=a)break;a=d}}for(let a=l;a>0;a--){let h=n[a-1];if(h.dom.parentNode==e)return h.domAtPos(h.length)}for(let a=l;a<n.length;a++){let h=n[a];if(h.dom.parentNode==e)return h.domAtPos(0)}return new Ie(e,0)}function um(r,t,e){let n,{children:l}=r;e>0&&t instanceof Ot&&l.length&&(n=l[l.length-1])instanceof Ot&&n.mark.eq(t.mark)?um(n,t.children[0],e-1):(l.push(t),t.setParent(r)),r.length+=t.length}function hm(r,t,e){let n=null,l=-1,a=null,h=-1;function d(g,m){for(let y=0,b=0;y<g.children.length&&b<=m;y++){let k=g.children[y],C=b+k.length;C>=m&&(k.children.length?d(k,m-b):(!a||a.isHidden&&e>0)&&(C>m||b==C&&k.getSide()>0)?(a=k,h=m-b):(b<m||b==C&&k.getSide()<0&&!k.isHidden)&&(n=k,l=m-b)),b=C}}d(r,t);let p=(e<0?n:a)||n||a;return p?p.coordsAt(Math.max(0,p==n?l:h),e):cA(r)}function cA(r){let t=r.dom.lastChild;if(!t)return r.dom.getBoundingClientRect();let e=ur(t);return e[e.length-1]||null}function gl(r,t){for(let e in r)e=="class"&&t.class?t.class+=" "+r.class:e=="style"&&t.style?t.style+=";"+r.style:t[e]=r[e];return t}function Gl(r,t){if(r==t)return!0;if(!r||!t)return!1;let e=Object.keys(r),n=Object.keys(t);if(e.length!=n.length)return!1;for(let l of e)if(n.indexOf(l)==-1||r[l]!==t[l])return!1;return!0}function ml(r,t,e){let n=null;if(t)for(let l in t)e&&l in e||r.removeAttribute(n=l);if(e)for(let l in e)t&&t[l]==e[l]||r.setAttribute(n=l,e[l]);return!!n}class pr{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}coordsAt(t,e,n){return null}get customView(){return null}get isHidden(){return!1}destroy(t){}}var Ne=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(Ne||(Ne={}));class fe extends Ci{constructor(t,e,n,l){super(),this.startSide=t,this.endSide=e,this.widget=n,this.spec=l}get heightRelevant(){return!1}static mark(t){return new Es(t)}static widget(t){let e=t.side||0,n=!!t.block;return e+=n?e>0?3e8:-4e8:e>0?1e8:-1e8,new ni(t,e,e,n,t.widget||null,!1)}static replace(t){let e=!!t.block,n,l;if(t.isBlockGap)n=-5e8,l=4e8;else{let{start:a,end:h}=cm(t,e);n=(a?e?-3e8:-1:5e8)-1,l=(h?e?2e8:1:-6e8)+1}return new ni(t,n,l,e,t.widget||null,!0)}static line(t){return new gr(t)}static set(t,e=!1){return ge.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}fe.none=ge.empty;class Es extends fe{constructor(t){let{start:e,end:n}=cm(t);super(e?-1:5e8,n?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof Es&&this.tagName==t.tagName&&this.class==t.class&&Gl(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}Es.prototype.point=!1;class gr extends fe{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof gr&&this.spec.class==t.spec.class&&Gl(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}gr.prototype.mapMode=Ke.TrackBefore;gr.prototype.point=!0;class ni extends fe{constructor(t,e,n,l,a,h){super(e,n,a,t),this.block=l,this.isReplace=h,this.mapMode=l?e<=0?Ke.TrackBefore:Ke.TrackAfter:Ke.TrackDel}get type(){return this.startSide<this.endSide?Ne.WidgetRange:this.startSide<=0?Ne.WidgetBefore:Ne.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof ni&&dA(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}ni.prototype.point=!0;function cm(r,t=!1){let{inclusiveStart:e,inclusiveEnd:n}=r;return e==null&&(e=r.inclusive),n==null&&(n=r.inclusive),{start:e??t,end:n??t}}function dA(r,t){return r==t||!!(r&&t&&r.compare(t))}function vl(r,t,e,n=0){let l=e.length-1;l>=0&&e[l]+n>=r?e[l]=Math.max(e[l],t):e.push(r,t)}class Ue extends he{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,n,l,a,h){if(n){if(!(n instanceof Ue))return!1;this.dom||n.transferDOM(this)}return l&&this.setDeco(n?n.attrs:null),im(this,t,e,n?n.children:[],a,h),!0}split(t){let e=new Ue;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i:n,off:l}=this.childPos(t);l&&(e.append(this.children[n].split(l),0),this.children[n].merge(l,this.children[n].length,null,!1,0,0),n++);for(let a=n;a<this.children.length;a++)e.append(this.children[a],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Gl(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){um(this,t,e)}addLineDeco(t){let e=t.spec.attributes,n=t.spec.class;e&&(this.attrs=gl(e,this.attrs||{})),n&&(this.attrs=gl({class:n},this.attrs||{}))}domAtPos(t){return fm(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.dirty|=6)}sync(t,e){var n;this.dom?this.dirty&4&&(Qg(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ml(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let l=this.dom.lastChild;for(;l&&he.get(l)instanceof Ot;)l=l.lastChild;if(!l||!this.length||l.nodeName!="BR"&&((n=he.get(l))===null||n===void 0?void 0:n.isEditable)==!1&&(!U.ios||!this.children.some(a=>a instanceof si))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let n of this.children){if(!(n instanceof si)||/[^ -~]/.test(n.text))return null;let l=ur(n.dom);if(l.length!=1)return null;t+=l[0].width,e=l[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let n=hm(this,t,e);if(!this.children.length&&n&&this.parent){let{heightOracle:l}=this.parent.view.viewState,a=n.bottom-n.top;if(Math.abs(a-l.lineHeight)<2&&l.textHeight<a){let h=(a-l.textHeight)/2;return{top:n.top+h,bottom:n.bottom-h,left:n.left,right:n.left}}}return n}become(t){return!1}get type(){return Ne.Text}static find(t,e){for(let n=0,l=0;n<t.children.length;n++){let a=t.children[n],h=l+a.length;if(h>=e){if(a instanceof Ue)return a;if(h>e)break}l=h+a.breakAfter}return null}}class ei extends he{constructor(t,e,n){super(),this.widget=t,this.length=e,this.type=n,this.breakAfter=0,this.prevWidget=null}merge(t,e,n,l,a,h){return n&&(!(n instanceof ei)||!this.widget.compare(n.widget)||t>0&&a<=0||e<this.length&&h<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?Ie.before(this.dom):Ie.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let n=new ei(this.widget,e,this.type);return n.breakAfter=this.breakAfter,n}get children(){return ql}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):le.empty}domBoundsAround(){return null}become(t){return t instanceof ei&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.type=t.type,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class jl{constructor(t,e,n,l){this.doc=t,this.pos=e,this.end=n,this.disallowBlockEffectsFor=l,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!t.breakAfter&&!(t instanceof ei&&t.type==Ne.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ue),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Or(new Di(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(t,e,n){for(;t>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:h,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(h){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=a,this.textOff=0}let l=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-n)),this.getLine().append(Or(new si(this.text.slice(this.textOff,this.textOff+l)),e),n),this.atCursorPos=!0,this.textOff+=l,t-=l,n=0}}span(t,e,n,l){this.buildText(e-t,n,l),this.pos=e,this.openStart<0&&(this.openStart=l)}point(t,e,n,l,a,h){if(this.disallowBlockEffectsFor[h]&&n instanceof ni){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=e-t;if(n instanceof ni)if(n.block){let{type:p}=n;p==Ne.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ei(n.widget||new xp("div"),d,p))}else{let p=Ft.create(n.widget||new xp("span"),d,d?0:n.startSide),g=this.atCursorPos&&!p.isEditable&&a<=l.length&&(t<e||n.startSide>0),m=!p.isEditable&&(t<e||a>l.length||n.startSide<=0),y=this.getLine();this.pendingBuffer==2&&!g&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(l),g&&(y.append(Or(new Di(1),l),a),a=l.length+Math.max(0,a-l.length)),y.append(Or(p,l),a),this.atCursorPos=m,this.pendingBuffer=m?t<e||a>l.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=l.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=a)}static build(t,e,n,l,a){let h=new jl(t,e,n,a);return h.openEnd=ge.spans(l,e,n,h),h.openStart<0&&(h.openStart=h.openEnd),h.finish(h.openEnd),h}}function Or(r,t){for(let e of t)r=new Ot(e,[r],r.length);return r}class xp extends pr{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const dm=K.define(),pm=K.define(),gm=K.define(),mm=K.define(),yl=K.define(),vm=K.define(),ym=K.define(),xm=K.define({combine:r=>r.some(t=>t)}),pA=K.define({combine:r=>r.some(t=>t)});class gs{constructor(t,e="nearest",n="nearest",l=5,a=5){this.range=t,this.y=e,this.x=n,this.yMargin=l,this.xMargin=a}map(t){return t.empty?this:new gs(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const bp=de.define({map:(r,t)=>r.map(t)});function Et(r,t,e){let n=r.facet(mm);n.length?n[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const Rs=K.define({combine:r=>r.length?r[0]:!0});let gA=0;const er=K.define();class St{constructor(t,e,n,l){this.id=t,this.create=e,this.domEventHandlers=n,this.extension=l(this)}static define(t,e){const{eventHandlers:n,provide:l,decorations:a}=e||{};return new St(gA++,t,n,h=>{let d=[er.of(h)];return a&&d.push(hr.of(p=>{let g=p.plugin(h);return g?a(g):fe.none})),l&&d.push(l(h)),d})}static fromClass(t,e){return St.define(n=>new t(n),e)}}class Rn{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(n){if(Et(e.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Et(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(n){Et(t.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const bm=K.define(),Kl=K.define(),hr=K.define(),Xl=K.define(),wm=K.define();function km(r){let t=0,e=0,n=0,l=0;for(let a of r.state.facet(wm)){let h=a(r);h&&(h.left!=null&&(t=Math.max(t,h.left)),h.right!=null&&(e=Math.max(e,h.right)),h.top!=null&&(n=Math.max(n,h.top)),h.bottom!=null&&(l=Math.max(l,h.bottom)))}return{left:t,right:e,top:n,bottom:l}}const tr=K.define();class kt{constructor(t,e,n,l){this.fromA=t,this.toA=e,this.fromB=n,this.toB=l}join(t){return new kt(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,n=this;for(;e>0;e--){let l=t[e-1];if(!(l.fromA>n.toA)){if(l.toA<n.fromA)break;n=n.join(l),t.splice(e-1,1)}}return t.splice(e,0,n),t}static extendWithRanges(t,e){if(e.length==0)return t;let n=[];for(let l=0,a=0,h=0,d=0;;l++){let p=l==t.length?null:t[l],g=h-d,m=p?p.fromB:1e9;for(;a<e.length&&e[a]<m;){let y=e[a],b=e[a+1],k=Math.max(d,y),C=Math.min(m,b);if(k<=C&&new kt(k+g,C+g,k,C).addToSet(n),b>m)break;a+=2}if(!p)return n;new kt(p.fromA,p.toA,p.fromB,p.toB).addToSet(n),h=p.toA,d=p.toB}}}class ms{constructor(t,e,n){this.view=t,this.state=e,this.transactions=n,this.flags=0,this.startState=t.state,this.changes=$e.empty(this.startState.doc.length);for(let a of n)this.changes=this.changes.compose(a.changes);let l=[];this.changes.iterChangedRanges((a,h,d,p)=>l.push(new kt(a,h,d,p))),this.changedRanges=l}static create(t,e,n){return new ms(t,e,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Te=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(Te||(Te={}));const xl=Te.LTR,mA=Te.RTL;function Sm(r){let t=[];for(let e=0;e<r.length;e++)t.push(1<<+r[e]);return t}const vA=Sm("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),yA=Sm("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),bl=Object.create(null),pt=[];for(let r of["()","[]","{}"]){let t=r.charCodeAt(0),e=r.charCodeAt(1);bl[t]=e,bl[e]=-t}function xA(r){return r<=247?vA[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?yA[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8203?256:64336<=r&&r<=65023?4:r==8204?256:1}const bA=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class $i{get dir(){return this.level%2?mA:xl}constructor(t,e,n){this.from=t,this.to=e,this.level=n}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,n,l){let a=-1;for(let h=0;h<t.length;h++){let d=t[h];if(d.from<=e&&d.to>=e){if(d.level==n)return h;(a<0||(l!=0?l<0?d.from<e:d.to>e:t[a].level>d.level))&&(a=h)}}if(a<0)throw new RangeError("Index out of range");return a}}const ye=[];function wA(r,t){let e=r.length,n=t==xl?1:2,l=t==xl?2:1;if(!r||n==1&&!bA.test(r))return Am(e);for(let h=0,d=n,p=n;h<e;h++){let g=xA(r.charCodeAt(h));g==512?g=d:g==8&&p==4&&(g=16),ye[h]=g==4?2:g,g&7&&(p=g),d=g}for(let h=0,d=n,p=n;h<e;h++){let g=ye[h];if(g==128)h<e-1&&d==ye[h+1]&&d&24?g=ye[h]=d:ye[h]=256;else if(g==64){let m=h+1;for(;m<e&&ye[m]==64;)m++;let y=h&&d==8||m<e&&ye[m]==8?p==1?1:8:256;for(let b=h;b<m;b++)ye[b]=y;h=m-1}else g==8&&p==1&&(ye[h]=1);d=g,g&7&&(p=g)}for(let h=0,d=0,p=0,g,m,y;h<e;h++)if(m=bl[g=r.charCodeAt(h)])if(m<0){for(let b=d-3;b>=0;b-=3)if(pt[b+1]==-m){let k=pt[b+2],C=k&2?n:k&4?k&1?l:n:0;C&&(ye[h]=ye[pt[b]]=C),d=b;break}}else{if(pt.length==189)break;pt[d++]=h,pt[d++]=g,pt[d++]=p}else if((y=ye[h])==2||y==1){let b=y==n;p=b?0:1;for(let k=d-3;k>=0;k-=3){let C=pt[k+2];if(C&2)break;if(b)pt[k+2]|=2;else{if(C&4)break;pt[k+2]|=4}}}for(let h=0;h<e;h++)if(ye[h]==256){let d=h+1;for(;d<e&&ye[d]==256;)d++;let p=(h?ye[h-1]:n)==1,g=(d<e?ye[d]:n)==1,m=p==g?p?1:2:n;for(let y=h;y<d;y++)ye[y]=m;h=d-1}let a=[];if(n==1)for(let h=0;h<e;){let d=h,p=ye[h++]!=1;for(;h<e&&p==(ye[h]!=1);)h++;if(p)for(let g=h;g>d;){let m=g,y=ye[--g]!=2;for(;g>d&&y==(ye[g-1]!=2);)g--;a.push(new $i(g,m,y?2:1))}else a.push(new $i(d,h,0))}else for(let h=0;h<e;){let d=h,p=ye[h++]==2;for(;h<e&&p==(ye[h]==2);)h++;a.push(new $i(d,h,p?1:2))}return a}function Am(r){return[new $i(0,r,0)]}let Pm="";function kA(r,t,e,n,l){var a;let h=n.head-r.from,d=-1;if(h==0){if(!l||!r.length)return null;t[0].level!=e&&(h=t[0].side(!1,e),d=0)}else if(h==r.length){if(l)return null;let b=t[t.length-1];b.level!=e&&(h=b.side(!0,e),d=t.length-1)}d<0&&(d=$i.find(t,h,(a=n.bidiLevel)!==null&&a!==void 0?a:-1,n.assoc));let p=t[d];h==p.side(l,e)&&(p=t[d+=l?1:-1],h=p.side(!l,e));let g=l==(p.dir==e),m=Mt(r.text,h,g);if(Pm=r.text.slice(Math.min(h,m),Math.max(h,m)),m!=p.side(l,e))return q.cursor(m+r.from,g?-1:1,p.level);let y=d==(l?t.length-1:0)?null:t[d+(l?1:-1)];return!y&&p.level!=e?q.cursor(l?r.to:r.from,l?-1:1,e):y&&y.level<p.level?q.cursor(y.side(!l,e)+r.from,l?1:-1,y.level):q.cursor(m+r.from,l?-1:1,p.level)}const yi="";class $m{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(se.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=yi}readRange(t,e){if(!t)return this;let n=t.parentNode;for(let l=t;;){this.findPointBefore(n,l);let a=this.text.length;this.readNode(l);let h=l.nextSibling;if(h==e)break;let d=he.get(l),p=he.get(h);(d&&p?d.breakAfter:(d?d.breakAfter:wp(l))||wp(h)&&(l.nodeName!="BR"||l.cmIgnore)&&this.text.length>a)&&this.lineBreak(),l=h}return this.findPointBefore(n,e),this}readTextNode(t){let e=t.nodeValue;for(let n of this.points)n.node==t&&(n.pos=this.text.length+Math.min(n.offset,e.length));for(let n=0,l=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,h=1,d;if(this.lineSeparator?(a=e.indexOf(this.lineSeparator,n),h=this.lineSeparator.length):(d=l.exec(e))&&(a=d.index,h=d[0].length),this.append(e.slice(n,a<0?e.length:a)),a<0)break;if(this.lineBreak(),h>1)for(let p of this.points)p.node==t&&p.pos>this.text.length&&(p.pos-=h-1);n=a+h}}readNode(t){if(t.cmIgnore)return;let e=he.get(t),n=e&&e.overrideDOMText;if(n!=null){this.findPointInside(t,n.length);for(let l=n.iter();!l.next().done;)l.lineBreak?this.lineBreak():this.append(l.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let n of this.points)n.node==t&&t.childNodes[n.offset]==e&&(n.pos=this.text.length)}findPointInside(t,e){for(let n of this.points)(t.nodeType==3?n.node==t:t.contains(n.node))&&(n.pos=this.text.length+Math.min(e,n.offset))}}function wp(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}class kp{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Sp extends he{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.compositionDeco=fe.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Ue],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new kt(0,0,0,t.state.doc.length)],0)}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every(({fromA:h,toA:d})=>d<this.minWidthFrom||h>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=fe.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=AA(this.view,t.changes)),(U.ie||U.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let n=this.decorations,l=this.updateDeco(),a=MA(n,l,t.changes);return e=kt.extendWithRanges(e,a),this.dirty==0&&e.length==0?!1:(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=U.chrome||U.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.dirty=0,a&&(a.written||n.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""});let l=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof ei&&a.widget instanceof Ap&&l.push(a.dom);n.updateGaps(l)}updateChildren(t,e){let n=this.childCursor(e);for(let l=t.length-1;;l--){let a=l>=0?t[l]:null;if(!a)break;let{fromA:h,toA:d,fromB:p,toB:g}=a,{content:m,breakAtStart:y,openStart:b,openEnd:k}=jl.build(this.view.state.doc,p,g,this.decorations,this.dynamicDecorationMap),{i:C,off:O}=n.findPos(d,1),{i:M,off:I}=n.findPos(h,-1);tm(this,M,I,C,O,m,y,b,k)}}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,l=n==this.dom,a=!l&&Jr(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(l||e||a))return;let h=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.domAtPos(d.anchor),g=d.empty?p:this.domAtPos(d.head);if(U.gecko&&d.empty&&!this.compositionDeco.size&&SA(p)){let y=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(y,p.node.childNodes[p.offset]||null)),p=g=new Ie(y,0),h=!0}let m=this.view.observer.selectionRange;(h||!m.focusNode||!ds(p.node,p.offset,m.anchorNode,m.anchorOffset)||!ds(g.node,g.offset,m.focusNode,m.focusOffset))&&(this.view.observer.ignore(()=>{U.android&&U.chrome&&this.dom.contains(m.focusNode)&&TA(m.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let y=cs(this.view.root);if(y)if(d.empty){if(U.gecko){let b=$A(p.node,p.offset);if(b&&b!=3){let k=Mm(p.node,p.offset,b==1?1:-1);k&&(p=new Ie(k,b==1?0:k.nodeValue.length))}}y.collapse(p.node,p.offset),d.bidiLevel!=null&&m.cursorBidiLevel!=null&&(m.cursorBidiLevel=d.bidiLevel)}else if(y.extend){y.collapse(p.node,p.offset);try{y.extend(g.node,g.offset)}catch{}}else{let b=document.createRange();d.anchor>d.head&&([p,g]=[g,p]),b.setEnd(g.node,g.offset),b.setStart(p.node,p.offset),y.removeAllRanges(),y.addRange(b)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(p,g)),this.impreciseAnchor=p.precise?null:new Ie(m.anchorNode,m.anchorOffset),this.impreciseHead=g.precise?null:new Ie(m.focusNode,m.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:t}=this,e=t.state.selection.main,n=cs(t.root),{anchorNode:l,anchorOffset:a}=t.observer.selectionRange;if(!n||!e.empty||!e.assoc||!n.modify)return;let h=Ue.find(this,e.head);if(!h)return;let d=h.posAtStart;if(e.head==d||e.head==d+h.length)return;let p=this.coordsAt(e.head,-1),g=this.coordsAt(e.head,1);if(!p||!g||p.bottom>g.top)return;let m=this.domAtPos(e.head+e.assoc);n.collapse(m.node,m.offset),n.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let y=t.observer.selectionRange;t.docView.posFromDOM(y.anchorNode,y.anchorOffset)!=e.from&&n.collapse(l,a)}nearest(t){for(let e=t;e;){let n=he.get(e);if(n&&n.rootView==this)return n;e=e.parentNode}return null}posFromDOM(t,e){let n=this.nearest(t);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(t,e)+n.posAtStart}domAtPos(t){let{i:e,off:n}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let l=this.children[e];if(n<l.length||l instanceof Ue)break;e++,n=0}return this.children[e].domAtPos(n)}coordsAt(t,e){for(let n=this.length,l=this.children.length-1;;l--){let a=this.children[l],h=n-a.breakAfter-a.length;if(t>h||t==h&&a.type!=Ne.WidgetBefore&&a.type!=Ne.WidgetAfter&&(!l||e==2||this.children[l-1].breakAfter||this.children[l-1].type==Ne.WidgetBefore&&e>-2))return a.coordsAt(t-h,e);n=h}}measureVisibleLineHeights(t){let e=[],{from:n,to:l}=t,a=this.view.contentDOM.clientWidth,h=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==Te.LTR;for(let g=0,m=0;m<this.children.length;m++){let y=this.children[m],b=g+y.length;if(b>l)break;if(g>=n){let k=y.dom.getBoundingClientRect();if(e.push(k.height),h){let C=y.dom.lastChild,O=C?ur(C):[];if(O.length){let M=O[O.length-1],I=p?M.right-k.left:k.right-M.left;I>d&&(d=I,this.minWidth=a,this.minWidthFrom=g,this.minWidthTo=b)}}}g=b+y.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?Te.RTL:Te.LTR}measureTextSize(){for(let a of this.children)if(a instanceof Ue){let h=a.measureTextSize();if(h)return h}let t=document.createElement("div"),e,n,l;return t.className="cm-line",t.style.width="99999px",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let a=ur(t.firstChild)[0];e=t.getBoundingClientRect().height,n=a?a.width/27:7,l=a?a.height:e,t.remove()}),{lineHeight:e,charWidth:n,textHeight:l}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new em(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let n=0,l=0;;l++){let a=l==e.viewports.length?null:e.viewports[l],h=a?a.from-1:this.length;if(h>n){let d=e.lineBlockAt(h).bottom-e.lineBlockAt(n).top;t.push(fe.replace({widget:new Ap(d),block:!0,inclusive:!0,isBlockGap:!0}).range(n,h))}if(!a)break;n=a.to+1}return fe.set(t)}updateDeco(){let t=this.view.state.facet(hr).map((e,n)=>(this.dynamicDecorationMap[n]=typeof e=="function")?e(this.view):e);for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let{range:e}=t,n=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),l;if(!n)return;!e.empty&&(l=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(n={left:Math.min(n.left,l.left),top:Math.min(n.top,l.top),right:Math.max(n.right,l.right),bottom:Math.max(n.bottom,l.bottom)});let a=km(this.view),h={left:n.left-a.left,top:n.top-a.top,right:n.right+a.right,bottom:n.bottom+a.bottom};lA(this.view.scrollDOM,h,e.head<e.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==Te.LTR)}}function SA(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}class Ap extends pr{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function Cm(r){let t=r.observer.selectionRange,e=t.focusNode&&Mm(t.focusNode,t.focusOffset,0);if(!e)return null;let n=r.docView.nearest(e);if(!n)return null;if(n instanceof Ue){let l=e;for(;l.parentNode!=n.dom;)l=l.parentNode;let a=l.previousSibling;for(;a&&!he.get(a);)a=a.previousSibling;let h=a?he.get(a).posAtEnd:n.posAtStart;return{from:h,to:h,node:l,text:e}}else{for(;;){let{parent:a}=n;if(!a)return null;if(a instanceof Ue)break;n=a}let l=n.posAtStart;return{from:l,to:l+n.length,node:n.dom,text:e}}}function AA(r,t){let e=Cm(r);if(!e)return fe.none;let{from:n,to:l,node:a,text:h}=e,d=t.mapPos(n,1),p=Math.max(d,t.mapPos(l,-1)),{state:g}=r,m=a.nodeType==3?a.nodeValue:new $m([],g).readRange(a.firstChild,null).text;if(m.indexOf(yi)>-1)return fe.none;if(p-d<m.length)if(g.doc.sliceString(d,Math.min(g.doc.length,d+m.length))==m)p=d+m.length;else if(g.doc.sliceString(Math.max(0,p-m.length),p)==m)d=p-m.length;else return fe.none;else if(g.doc.sliceString(d,p)!=m)return fe.none;let y=he.get(a);return y instanceof nm?y=y.widget.topView:y&&(y.parent=null),fe.set(fe.replace({widget:new PA(a,h,y),inclusive:!0}).range(d,p))}class PA extends pr{constructor(t,e,n){super(),this.top=t,this.text=e,this.topView=n}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return nm}}function Mm(r,t,e){if(e<=0)for(let n=r,l=t;;){if(n.nodeType==3)return n;if(n.nodeType==1&&l>0)n=n.childNodes[l-1],l=Ut(n);else break}if(e>=0)for(let n=r,l=t;;){if(n.nodeType==3)return n;if(n.nodeType==1&&l<n.childNodes.length&&e>=0)n=n.childNodes[l],l=0;else break}return null}function $A(r,t){return r.nodeType!=1?0:(t&&r.childNodes[t-1].contentEditable=="false"?1:0)|(t<r.childNodes.length&&r.childNodes[t].contentEditable=="false"?2:0)}class CA{constructor(){this.changes=[]}compareRange(t,e){vl(t,e,this.changes)}comparePoint(t,e){vl(t,e,this.changes)}}function MA(r,t,e){let n=new CA;return ge.compare(r,t,e,n),n.changes}function TA(r,t){for(let e=r;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function DA(r,t,e=1){let n=r.charCategorizer(t),l=r.doc.lineAt(t),a=t-l.from;if(l.length==0)return q.cursor(t);a==0?e=1:a==l.length&&(e=-1);let h=a,d=a;e<0?h=Mt(l.text,a,!1):d=Mt(l.text,a);let p=n(l.text.slice(h,d));for(;h>0;){let g=Mt(l.text,h,!1);if(n(l.text.slice(g,h))!=p)break;h=g}for(;d<l.length;){let g=Mt(l.text,d);if(n(l.text.slice(d,g))!=p)break;d=g}return q.range(h+l.from,d+l.from)}function EA(r,t){return t.left>r?t.left-r:Math.max(0,r-t.right)}function RA(r,t){return t.top>r?t.top-r:Math.max(0,r-t.bottom)}function On(r,t){return r.top<t.bottom-1&&r.bottom>t.top+1}function Pp(r,t){return t<r.top?{top:t,left:r.left,right:r.right,bottom:r.bottom}:r}function $p(r,t){return t>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:t}:r}function wl(r,t,e){let n,l,a,h,d=!1,p,g,m,y;for(let C=r.firstChild;C;C=C.nextSibling){let O=ur(C);for(let M=0;M<O.length;M++){let I=O[M];l&&On(l,I)&&(I=Pp($p(I,l.bottom),l.top));let L=EA(t,I),F=RA(e,I);if(L==0&&F==0)return C.nodeType==3?Cp(C,t,e):wl(C,t,e);if(!n||h>F||h==F&&a>L){n=C,l=I,a=L,h=F;let N=F?e<I.top?-1:1:L?t<I.left?-1:1:0;d=!N||(N>0?M<O.length-1:M>0)}L==0?e>I.bottom&&(!m||m.bottom<I.bottom)?(p=C,m=I):e<I.top&&(!y||y.top>I.top)&&(g=C,y=I):m&&On(m,I)?m=$p(m,I.bottom):y&&On(y,I)&&(y=Pp(y,I.top))}}if(m&&m.bottom>=e?(n=p,l=m):y&&y.top<=e&&(n=g,l=y),!n)return{node:r,offset:0};let b=Math.max(l.left,Math.min(l.right,t));if(n.nodeType==3)return Cp(n,b,e);if(d&&n.contentEditable!="false")return wl(n,b,e);let k=Array.prototype.indexOf.call(r.childNodes,n)+(t>=(l.left+l.right)/2?1:0);return{node:r,offset:k}}function Cp(r,t,e){let n=r.nodeValue.length,l=-1,a=1e9,h=0;for(let d=0;d<n;d++){let p=Ti(r,d,d+1).getClientRects();for(let g=0;g<p.length;g++){let m=p[g];if(m.top==m.bottom)continue;h||(h=t-m.left);let y=(m.top>e?m.top-e:e-m.bottom)-1;if(m.left-1<=t&&m.right+1>=t&&y<a){let b=t>=(m.left+m.right)/2,k=b;if((U.chrome||U.gecko)&&Ti(r,d).getBoundingClientRect().left==m.right&&(k=!b),y<=0)return{node:r,offset:d+(k?1:0)};l=d+(k?1:0),a=y}}}return{node:r,offset:l>-1?l:h>0?r.nodeValue.length:0}}function Tm(r,t,e,n=-1){var l,a;let h=r.contentDOM.getBoundingClientRect(),d=h.top+r.viewState.paddingTop,p,{docHeight:g}=r.viewState,{x:m,y}=t,b=y-d;if(b<0)return 0;if(b>g)return r.state.doc.length;for(let N=r.defaultLineHeight/2,H=!1;p=r.elementAtHeight(b),p.type!=Ne.Text;)for(;b=n>0?p.bottom+N:p.top-N,!(b>=0&&b<=g);){if(H)return e?null:0;H=!0,n=-n}y=d+b;let k=p.from;if(k<r.viewport.from)return r.viewport.from==0?0:e?null:Mp(r,h,p,m,y);if(k>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:e?null:Mp(r,h,p,m,y);let C=r.dom.ownerDocument,O=r.root.elementFromPoint?r.root:C,M=O.elementFromPoint(m,y);M&&!r.contentDOM.contains(M)&&(M=null),M||(m=Math.max(h.left+1,Math.min(h.right-1,m)),M=O.elementFromPoint(m,y),M&&!r.contentDOM.contains(M)&&(M=null));let I,L=-1;if(M&&((l=r.docView.nearest(M))===null||l===void 0?void 0:l.isEditable)!=!1){if(C.caretPositionFromPoint){let N=C.caretPositionFromPoint(m,y);N&&({offsetNode:I,offset:L}=N)}else if(C.caretRangeFromPoint){let N=C.caretRangeFromPoint(m,y);N&&({startContainer:I,startOffset:L}=N,(!r.contentDOM.contains(I)||U.safari&&OA(I,L,m)||U.chrome&&IA(I,L,m))&&(I=void 0))}}if(!I||!r.docView.dom.contains(I)){let N=Ue.find(r.docView,k);if(!N)return b>p.top+p.height/2?p.to:p.from;({node:I,offset:L}=wl(N.dom,m,y))}let F=r.docView.nearest(I);if(!F)return null;if(F.isWidget&&((a=F.dom)===null||a===void 0?void 0:a.nodeType)==1){let N=F.dom.getBoundingClientRect();return t.y<N.top||t.y<=N.bottom&&t.x<=(N.left+N.right)/2?F.posAtStart:F.posAtEnd}else return F.localPosFromDOM(I,L)+F.posAtStart}function Mp(r,t,e,n,l){let a=Math.round((n-t.left)*r.defaultCharacterWidth);if(r.lineWrapping&&e.height>r.defaultLineHeight*1.5){let d=Math.floor((l-e.top)/r.defaultLineHeight);a+=d*r.viewState.heightOracle.lineLength}let h=r.state.sliceDoc(e.from,e.to);return e.from+ZS(h,a,r.state.tabSize)}function OA(r,t,e){let n;if(r.nodeType!=3||t!=(n=r.nodeValue.length))return!1;for(let l=r.nextSibling;l;l=l.nextSibling)if(l.nodeType!=1||l.nodeName!="BR")return!1;return Ti(r,n-1,n).getBoundingClientRect().left>e}function IA(r,t,e){if(t!=0)return!1;for(let l=r;;){let a=l.parentNode;if(!a||a.nodeType!=1||a.firstChild!=l)return!1;if(a.classList.contains("cm-line"))break;l=a}let n=r.nodeType==1?r.getBoundingClientRect():Ti(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return e-n.left>5}function NA(r,t,e,n){let l=r.state.doc.lineAt(t.head),a=!n||!r.lineWrapping?null:r.coordsAtPos(t.assoc<0&&t.head>l.from?t.head-1:t.head);if(a){let p=r.dom.getBoundingClientRect(),g=r.textDirectionAt(l.from),m=r.posAtCoords({x:e==(g==Te.LTR)?p.right-1:p.left+1,y:(a.top+a.bottom)/2});if(m!=null)return q.cursor(m,e?-1:1)}let h=Ue.find(r.docView,t.head),d=h?e?h.posAtEnd:h.posAtStart:e?l.to:l.from;return q.cursor(d,e?-1:1)}function Tp(r,t,e,n){let l=r.state.doc.lineAt(t.head),a=r.bidiSpans(l),h=r.textDirectionAt(l.from);for(let d=t,p=null;;){let g=kA(l,a,h,d,e),m=Pm;if(!g){if(l.number==(e?r.state.doc.lines:1))return d;m=`
`,l=r.state.doc.line(l.number+(e?1:-1)),a=r.bidiSpans(l),g=q.cursor(e?l.from:l.to)}if(p){if(!p(m))return d}else{if(!n)return g;p=n(m)}d=g}}function LA(r,t,e){let n=r.state.charCategorizer(t),l=n(e);return a=>{let h=n(a);return l==Tt.Space&&(l=h),l==h}}function _A(r,t,e,n){let l=t.head,a=e?1:-1;if(l==(e?r.state.doc.length:0))return q.cursor(l,t.assoc);let h=t.goalColumn,d,p=r.contentDOM.getBoundingClientRect(),g=r.coordsAtPos(l),m=r.documentTop;if(g)h==null&&(h=g.left-p.left),d=a<0?g.top:g.bottom;else{let k=r.viewState.lineBlockAt(l);h==null&&(h=Math.min(p.right-p.left,r.defaultCharacterWidth*(l-k.from))),d=(a<0?k.top:k.bottom)+m}let y=p.left+h,b=n??r.defaultLineHeight>>1;for(let k=0;;k+=10){let C=d+(b+k)*a,O=Tm(r,{x:y,y:C},!1,a);if(C<p.top||C>p.bottom||(a<0?O<l:O>l))return q.cursor(O,t.assoc,void 0,h)}}function Zr(r,t,e){for(;;){let n=0;for(let l of r)l.between(t-1,t+1,(a,h,d)=>{if(t>a&&t<h){let p=n||e||(t-a<h-t?-1:1);t=p<0?a:h,n=p}});if(!n)return t}}function In(r,t,e){let n=Zr(r.state.facet(Xl).map(l=>l(r)),e.from,t.head>e.from?-1:1);return n==e.from?e:q.cursor(n,n<e.from?1:-1)}class BA{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let e=(n,l)=>{this.ignoreDuringComposition(l)||l.type=="keydown"&&this.keydown(t,l)||(this.mustFlushObserver(l)&&t.observer.forceFlush(),this.runCustomHandlers(l.type,t,l)?l.preventDefault():n(t,l))};for(let n in Ae){let l=Ae[n];t.contentDOM.addEventListener(n,a=>{Dp(t,a)&&e(l,a)},kl[n]),this.registeredEvents.push(n)}t.scrollDOM.addEventListener("mousedown",n=>{if(n.target==t.scrollDOM&&n.clientY>t.contentDOM.getBoundingClientRect().bottom&&(e(Ae.mousedown,n),!n.defaultPrevented&&n.button==2)){let l=t.contentDOM.style.minHeight;t.contentDOM.style.minHeight="100%",setTimeout(()=>t.contentDOM.style.minHeight=l,200)}}),t.scrollDOM.addEventListener("drop",n=>{n.target==t.scrollDOM&&n.clientY>t.contentDOM.getBoundingClientRect().bottom&&e(Ae.drop,n)}),U.chrome&&U.chrome_version==102&&t.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=t.hasFocus,U.safari&&t.contentDOM.addEventListener("input",()=>null)}ensureHandlers(t,e){var n;let l;this.customHandlers=[];for(let a of e)if(l=(n=a.update(t).spec)===null||n===void 0?void 0:n.domEventHandlers){this.customHandlers.push({plugin:a.value,handlers:l});for(let h in l)this.registeredEvents.indexOf(h)<0&&h!="scroll"&&(this.registeredEvents.push(h),t.contentDOM.addEventListener(h,d=>{Dp(t,d)&&this.runCustomHandlers(h,t,d)&&d.preventDefault()}))}}runCustomHandlers(t,e,n){for(let l of this.customHandlers){let a=l.handlers[t];if(a)try{if(a.call(l.plugin,n,e)||n.defaultPrevented)return!0}catch(h){Et(e.state,h)}}return!1}runScrollHandlers(t,e){this.lastScrollTop=t.scrollDOM.scrollTop,this.lastScrollLeft=t.scrollDOM.scrollLeft;for(let n of this.customHandlers){let l=n.handlers.scroll;if(l)try{l.call(n.plugin,e,t)}catch(a){Et(t.state,a)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&Em.indexOf(e.keyCode)<0&&(t.inputState.lastEscPress=0),U.android&&U.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return U.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=Dm.find(l=>l.keyCode==e.keyCode))&&!e.ctrlKey||FA.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(t),250),!0):!1}flushIOSKey(t){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,Pi(t.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:U.safari&&!U.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(t){return t.type=="keydown"&&t.keyCode!=229}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Dm=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],FA="dthko",Em=[16,17,18,20,91,92,224,225],Ir=6;function Nr(r){return Math.max(0,r)*.7+8}class VA{constructor(t,e,n,l){this.view=t,this.style=n,this.mustSelect=l,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParent=oA(t.contentDOM),this.atoms=t.state.facet(Xl).map(h=>h(t));let a=t.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(se.allowMultipleSelections)&&HA(t,e),this.dragMove=WA(t,e),this.dragging=zA(t,e)&&Nm(e)==1?null:!1}start(t){this.dragging===!1&&(t.preventDefault(),this.select(t))}move(t){var e;if(t.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=t);let n=0,l=0,a=((e=this.scrollParent)===null||e===void 0?void 0:e.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},h=km(this.view);t.clientX-h.left<=a.left+Ir?n=-Nr(a.left-t.clientX):t.clientX+h.right>=a.right-Ir&&(n=Nr(t.clientX-a.right)),t.clientY-h.top<=a.top+Ir?l=-Nr(a.top-t.clientY):t.clientY+h.bottom>=a.bottom-Ir&&(l=Nr(t.clientY-a.bottom)),this.setScrollSpeed(n,l)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let n=0;n<t.ranges.length;n++){let l=t.ranges[n],a=null;if(l.empty){let h=Zr(this.atoms,l.from,0);h!=l.from&&(a=q.cursor(h,-1))}else{let h=Zr(this.atoms,l.from,-1),d=Zr(this.atoms,l.to,1);(h!=l.from||d!=l.to)&&(a=q.range(l.from==l.anchor?h:d,l.from==l.head?h:d))}a&&(e||(e=t.ranges.slice()),e[n]=a)}return e?q.create(e,t.mainIndex):t}select(t){let{view:e}=this,n=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!n.eq(e.state.selection)||n.main.assoc!=e.state.selection.main.assoc)&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function HA(r,t){let e=r.state.facet(dm);return e.length?e[0](t):U.mac?t.metaKey:t.ctrlKey}function WA(r,t){let e=r.state.facet(pm);return e.length?e[0](t):U.mac?!t.altKey:!t.ctrlKey}function zA(r,t){let{main:e}=r.state.selection;if(e.empty)return!1;let n=cs(r.root);if(!n||n.rangeCount==0)return!0;let l=n.getRangeAt(0).getClientRects();for(let a=0;a<l.length;a++){let h=l[a];if(h.left<=t.clientX&&h.right>=t.clientX&&h.top<=t.clientY&&h.bottom>=t.clientY)return!0}return!1}function Dp(r,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,n;e!=r.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(n=he.get(e))&&n.ignoreEvent(t))return!1;return!0}const Ae=Object.create(null),kl=Object.create(null),Rm=U.ie&&U.ie_version<15||U.ios&&U.webkit_version<604;function UA(r){let t=r.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{r.focus(),e.remove(),Om(r,e.value)},50)}function Om(r,t){let{state:e}=r,n,l=1,a=e.toText(t),h=a.lines==e.selection.ranges.length;if(Sl!=null&&e.selection.ranges.every(p=>p.empty)&&Sl==a.toString()){let p=-1;n=e.changeByRange(g=>{let m=e.doc.lineAt(g.from);if(m.from==p)return{range:g};p=m.from;let y=e.toText((h?a.line(l++).text:t)+e.lineBreak);return{changes:{from:m.from,insert:y},range:q.cursor(g.from+y.length)}})}else h?n=e.changeByRange(p=>{let g=a.line(l++);return{changes:{from:p.from,to:p.to,insert:g.text},range:q.cursor(p.from+g.length)}}):n=e.replaceSelection(a);r.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Ae.keydown=(r,t)=>{r.inputState.setSelectionOrigin("select"),t.keyCode==27&&(r.inputState.lastEscPress=Date.now())};Ae.touchstart=(r,t)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};Ae.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};kl.touchstart=kl.touchmove={passive:!0};Ae.mousedown=(r,t)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return;let e=null;for(let n of r.state.facet(gm))if(e=n(r,t),e)break;if(!e&&t.button==0&&(e=jA(r,t)),e){let n=r.root.activeElement!=r.contentDOM;r.inputState.startMouseSelection(new VA(r,t,e,n)),n&&r.observer.ignore(()=>Zg(r.contentDOM)),r.inputState.mouseSelection&&r.inputState.mouseSelection.start(t)}};function Ep(r,t,e,n){if(n==1)return q.cursor(t,e);if(n==2)return DA(r.state,t,e);{let l=Ue.find(r.docView,t),a=r.state.doc.lineAt(l?l.posAtEnd:t),h=l?l.posAtStart:a.from,d=l?l.posAtEnd:a.to;return d<r.state.doc.length&&d==a.to&&d++,q.range(h,d)}}let Im=(r,t)=>r>=t.top&&r<=t.bottom,Rp=(r,t,e)=>Im(t,e)&&r>=e.left&&r<=e.right;function qA(r,t,e,n){let l=Ue.find(r.docView,t);if(!l)return 1;let a=t-l.posAtStart;if(a==0)return 1;if(a==l.length)return-1;let h=l.coordsAt(a,-1);if(h&&Rp(e,n,h))return-1;let d=l.coordsAt(a,1);return d&&Rp(e,n,d)?1:h&&Im(n,h)?-1:1}function Op(r,t){let e=r.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:qA(r,e,t.clientX,t.clientY)}}const GA=U.ie&&U.ie_version<=11;let Ip=null,Np=0,Lp=0;function Nm(r){if(!GA)return r.detail;let t=Ip,e=Lp;return Ip=r,Lp=Date.now(),Np=!t||e>Date.now()-400&&Math.abs(t.clientX-r.clientX)<2&&Math.abs(t.clientY-r.clientY)<2?(Np+1)%3:1}function jA(r,t){let e=Op(r,t),n=Nm(t),l=r.state.selection;return{update(a){a.docChanged&&(e.pos=a.changes.mapPos(e.pos),l=l.map(a.changes))},get(a,h,d){let p=Op(r,a),g,m=Ep(r,p.pos,p.bias,n);if(e.pos!=p.pos&&!h){let y=Ep(r,e.pos,e.bias,n),b=Math.min(y.from,m.from),k=Math.max(y.to,m.to);m=b<m.from?q.range(b,k):q.range(k,b)}return h?l.replaceRange(l.main.extend(m.from,m.to)):d&&n==1&&l.ranges.length>1&&(g=KA(l,p.pos))?g:d?l.addRange(m):q.create([m])}}}function KA(r,t){for(let e=0;e<r.ranges.length;e++){let{from:n,to:l}=r.ranges[e];if(n<=t&&l>=t)return q.create(r.ranges.slice(0,e).concat(r.ranges.slice(e+1)),r.mainIndex==e?0:r.mainIndex-(r.mainIndex>e?1:0))}return null}Ae.dragstart=(r,t)=>{let{selection:{main:e}}=r.state,{mouseSelection:n}=r.inputState;n&&(n.dragging=e),t.dataTransfer&&(t.dataTransfer.setData("Text",r.state.sliceDoc(e.from,e.to)),t.dataTransfer.effectAllowed="copyMove")};function _p(r,t,e,n){if(!e)return;let l=r.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();let{mouseSelection:a}=r.inputState,h=n&&a&&a.dragging&&a.dragMove?{from:a.dragging.from,to:a.dragging.to}:null,d={from:l,insert:e},p=r.state.changes(h?[h,d]:d);r.focus(),r.dispatch({changes:p,selection:{anchor:p.mapPos(l,-1),head:p.mapPos(l,1)},userEvent:h?"move.drop":"input.drop"})}Ae.drop=(r,t)=>{if(!t.dataTransfer)return;if(r.state.readOnly)return t.preventDefault();let e=t.dataTransfer.files;if(e&&e.length){t.preventDefault();let n=Array(e.length),l=0,a=()=>{++l==e.length&&_p(r,t,n.filter(h=>h!=null).join(r.state.lineBreak),!1)};for(let h=0;h<e.length;h++){let d=new FileReader;d.onerror=a,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(n[h]=d.result),a()},d.readAsText(e[h])}}else _p(r,t,t.dataTransfer.getData("Text"),!0)};Ae.paste=(r,t)=>{if(r.state.readOnly)return t.preventDefault();r.observer.flush();let e=Rm?null:t.clipboardData;e?(Om(r,e.getData("text/plain")||e.getData("text/uri-text")),t.preventDefault()):UA(r)};function XA(r,t){let e=r.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),r.focus()},50)}function YA(r){let t=[],e=[],n=!1;for(let l of r.selection.ranges)l.empty||(t.push(r.sliceDoc(l.from,l.to)),e.push(l));if(!t.length){let l=-1;for(let{from:a}of r.selection.ranges){let h=r.doc.lineAt(a);h.number>l&&(t.push(h.text),e.push({from:h.from,to:Math.min(r.doc.length,h.to+1)})),l=h.number}n=!0}return{text:t.join(r.lineBreak),ranges:e,linewise:n}}let Sl=null;Ae.copy=Ae.cut=(r,t)=>{let{text:e,ranges:n,linewise:l}=YA(r.state);if(!e&&!l)return;Sl=l?e:null;let a=Rm?null:t.clipboardData;a?(t.preventDefault(),a.clearData(),a.setData("text/plain",e)):XA(r,e),t.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"})};const Lm=jt.define();function _m(r,t){let e=[];for(let n of r.facet(ym)){let l=n(r,t);l&&e.push(l)}return e?r.update({effects:e,annotations:Lm.of(!0)}):null}function Bm(r){setTimeout(()=>{let t=r.hasFocus;if(t!=r.inputState.notifiedFocused){let e=_m(r.state,t);e?r.dispatch(e):r.update([])}},10)}Ae.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),Bm(r)};Ae.blur=r=>{r.observer.clearSelectionRange(),Bm(r)};Ae.compositionstart=Ae.compositionupdate=r=>{r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0)};Ae.compositionend=r=>{r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,U.chrome&&U.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.compositionDeco.size&&r.update([])},50)};Ae.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};Ae.beforeinput=(r,t)=>{var e;let n;if(U.chrome&&U.android&&(n=Dm.find(l=>l.inputType==t.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let l=((e=window.visualViewport)===null||e===void 0?void 0:e.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}};const Bp=["pre-wrap","normal","pre-line","break-spaces"];class JA{constructor(t){this.lineWrapping=t,this.doc=le.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let n=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((e-t-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Bp.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let n=0;n<t.length;n++){let l=t[n];l<0?n++:this.heightSamples[Math.floor(l*10)]||(e=!0,this.heightSamples[Math.floor(l*10)]=!0)}return e}refresh(t,e,n,l,a,h){let d=Bp.indexOf(t)>-1,p=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=e,this.charWidth=n,this.textHeight=l,this.lineLength=a,p){this.heightSamples={};for(let g=0;g<h.length;g++){let m=h[g];m<0?g++:this.heightSamples[Math.floor(m*10)]=!0}}return p}}class ZA{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Ct{constructor(t,e,n,l,a,h){this.from=t,this.length=e,this.top=n,this.height=l,this.children=a,this.deco=h}get type(){var t,e,n;return(n=(t=this.children)!==null&&t!==void 0?t:(e=this.deco)===null||e===void 0?void 0:e.type)!==null&&n!==void 0?n:Ne.Text}get widget(){return this.deco&&this.deco.widget}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(this.children||[this]).concat(t.children||[t]);return new Ct(this.from,this.length+t.length,this.top,this.height+t.height,e,null)}}var ce=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(ce||(ce={}));const Qr=.001;class qe{constructor(t,e,n=2){this.length=t,this.height=e,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>Qr&&(t.heightChanged=!0),this.height=e)}replace(t,e,n){return qe.of(n)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,n,l){let a=this,h=n.doc;for(let d=l.length-1;d>=0;d--){let{fromA:p,toA:g,fromB:m,toB:y}=l[d],b=a.lineAt(p,ce.ByPosNoHeight,n.setDoc(e),0,0),k=b.to>=g?b:a.lineAt(g,ce.ByPosNoHeight,n,0,0);for(y+=k.to-g,g=k.to;d>0&&b.from<=l[d-1].toA;)p=l[d-1].fromA,m=l[d-1].fromB,d--,p<b.from&&(b=a.lineAt(p,ce.ByPosNoHeight,n,0,0));m+=b.from-p,p=b.from;let C=Yl.build(n.setDoc(h),t,m,y);a=a.replace(p,g,C)}return a.updateHeight(n,0)}static empty(){return new Qe(0,0)}static of(t){if(t.length==1)return t[0];let e=0,n=t.length,l=0,a=0;for(;;)if(e==n)if(l>a*2){let d=t[e-1];d.break?t.splice(--e,1,d.left,null,d.right):t.splice(--e,1,d.left,d.right),n+=1+d.break,l-=d.size}else if(a>l*2){let d=t[n];d.break?t.splice(n,1,d.left,null,d.right):t.splice(n,1,d.left,d.right),n+=2+d.break,a-=d.size}else break;else if(l<a){let d=t[e++];d&&(l+=d.size)}else{let d=t[--n];d&&(a+=d.size)}let h=0;return t[e-1]==null?(h=1,e--):t[e]==null&&(h=1,n++),new QA(qe.of(t.slice(0,e)),h,qe.of(t.slice(n)))}}qe.prototype.size=1;class Fm extends qe{constructor(t,e,n){super(t,e),this.deco=n}blockAt(t,e,n,l){return new Ct(l,this.length,n,this.height,null,this.deco)}lineAt(t,e,n,l,a){return this.blockAt(0,n,l,a)}forEachLine(t,e,n,l,a,h){t<=a+this.length&&e>=a&&h(this.blockAt(0,n,l,a))}updateHeight(t,e=0,n=!1,l){return l&&l.from<=e&&l.more&&this.setHeight(t,l.heights[l.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Qe extends Fm{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0}replace(t,e,n){let l=n[0];return n.length==1&&(l instanceof Qe||l instanceof Re&&l.flags&4)&&Math.abs(this.length-l.length)<10?(l instanceof Re?l=new Qe(l.length,this.height):l.height=this.height,this.outdated||(l.outdated=!1),l):qe.of(n)}updateHeight(t,e=0,n=!1,l){return l&&l.from<=e&&l.more?this.setHeight(t,l.heights[l.index++]):(n||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Re extends qe{constructor(t){super(t,0)}heightMetrics(t,e){let n=t.doc.lineAt(e).number,l=t.doc.lineAt(e+this.length).number,a=l-n+1,h,d=0;if(t.lineWrapping){let p=Math.min(this.height,t.lineHeight*a);h=p/a,this.length>a+1&&(d=(this.height-p)/(this.length-a-1))}else h=this.height/a;return{firstLine:n,lastLine:l,perLine:h,perChar:d}}blockAt(t,e,n,l){let{firstLine:a,lastLine:h,perLine:d,perChar:p}=this.heightMetrics(e,l);if(e.lineWrapping){let g=l+Math.round(Math.max(0,Math.min(1,(t-n)/this.height))*this.length),m=e.doc.lineAt(g),y=d+m.length*p,b=Math.max(n,t-y/2);return new Ct(m.from,m.length,b,y,null,null)}else{let g=Math.max(0,Math.min(h-a,Math.floor((t-n)/d))),{from:m,length:y}=e.doc.line(a+g);return new Ct(m,y,n+d*g,d,null,null)}}lineAt(t,e,n,l,a){if(e==ce.ByHeight)return this.blockAt(t,n,l,a);if(e==ce.ByPosNoHeight){let{from:k,to:C}=n.doc.lineAt(t);return new Ct(k,C-k,0,0,null,null)}let{firstLine:h,perLine:d,perChar:p}=this.heightMetrics(n,a),g=n.doc.lineAt(t),m=d+g.length*p,y=g.number-h,b=l+d*y+p*(g.from-a-y);return new Ct(g.from,g.length,Math.max(l,Math.min(b,l+this.height-m)),m,null,null)}forEachLine(t,e,n,l,a,h){t=Math.max(t,a),e=Math.min(e,a+this.length);let{firstLine:d,perLine:p,perChar:g}=this.heightMetrics(n,a);for(let m=t,y=l;m<=e;){let b=n.doc.lineAt(m);if(m==t){let C=b.number-d;y+=p*C+g*(t-a-C)}let k=p+g*b.length;h(new Ct(b.from,b.length,y,k,null,null)),y+=k,m=b.to+1}}replace(t,e,n){let l=this.length-e;if(l>0){let a=n[n.length-1];a instanceof Re?n[n.length-1]=new Re(a.length+l):n.push(null,new Re(l-1))}if(t>0){let a=n[0];a instanceof Re?n[0]=new Re(t+a.length):n.unshift(new Re(t-1),null)}return qe.of(n)}decomposeLeft(t,e){e.push(new Re(t-1),null)}decomposeRight(t,e){e.push(null,new Re(this.length-t-1))}updateHeight(t,e=0,n=!1,l){let a=e+this.length;if(l&&l.from<=e+this.length&&l.more){let h=[],d=Math.max(e,l.from),p=-1;for(l.from>e&&h.push(new Re(l.from-e-1).updateHeight(t,e));d<=a&&l.more;){let m=t.doc.lineAt(d).length;h.length&&h.push(null);let y=l.heights[l.index++];p==-1?p=y:Math.abs(y-p)>=Qr&&(p=-2);let b=new Qe(m,y);b.outdated=!1,h.push(b),d+=m+1}d<=a&&h.push(null,new Re(a-d).updateHeight(t,d));let g=qe.of(h);return(p<0||Math.abs(g.height-this.height)>=Qr||Math.abs(p-this.heightMetrics(t,e).perLine)>=Qr)&&(t.heightChanged=!0),g}else(n||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class QA extends qe{constructor(t,e,n){super(t.length+e+n.length,t.height+n.height,e|(t.outdated||n.outdated?2:0)),this.left=t,this.right=n,this.size=t.size+n.size}get break(){return this.flags&1}blockAt(t,e,n,l){let a=n+this.left.height;return t<a?this.left.blockAt(t,e,n,l):this.right.blockAt(t,e,a,l+this.left.length+this.break)}lineAt(t,e,n,l,a){let h=l+this.left.height,d=a+this.left.length+this.break,p=e==ce.ByHeight?t<h:t<d,g=p?this.left.lineAt(t,e,n,l,a):this.right.lineAt(t,e,n,h,d);if(this.break||(p?g.to<d:g.from>d))return g;let m=e==ce.ByPosNoHeight?ce.ByPosNoHeight:ce.ByPos;return p?g.join(this.right.lineAt(d,m,n,h,d)):this.left.lineAt(d,m,n,l,a).join(g)}forEachLine(t,e,n,l,a,h){let d=l+this.left.height,p=a+this.left.length+this.break;if(this.break)t<p&&this.left.forEachLine(t,e,n,l,a,h),e>=p&&this.right.forEachLine(t,e,n,d,p,h);else{let g=this.lineAt(p,ce.ByPos,n,l,a);t<g.from&&this.left.forEachLine(t,g.from-1,n,l,a,h),g.to>=t&&g.from<=e&&h(g),e>g.to&&this.right.forEachLine(g.to+1,e,n,d,p,h)}}replace(t,e,n){let l=this.left.length+this.break;if(e<l)return this.balanced(this.left.replace(t,e,n),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-l,e-l,n));let a=[];t>0&&this.decomposeLeft(t,a);let h=a.length;for(let d of n)a.push(d);if(t>0&&Fp(a,h-1),e<this.length){let d=a.length;this.decomposeRight(e,a),Fp(a,d)}return qe.of(a)}decomposeLeft(t,e){let n=this.left.length;if(t<=n)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(n++,t>=n&&e.push(null)),t>n&&this.right.decomposeLeft(t-n,e)}decomposeRight(t,e){let n=this.left.length,l=n+this.break;if(t>=l)return this.right.decomposeRight(t-l,e);t<n&&this.left.decomposeRight(t,e),this.break&&t<l&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?qe.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,n=!1,l){let{left:a,right:h}=this,d=e+a.length+this.break,p=null;return l&&l.from<=e+a.length&&l.more?p=a=a.updateHeight(t,e,n,l):a.updateHeight(t,e,n),l&&l.from<=d+h.length&&l.more?p=h=h.updateHeight(t,d,n,l):h.updateHeight(t,d,n),p?this.balanced(a,h):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Fp(r,t){let e,n;r[t]==null&&(e=r[t-1])instanceof Re&&(n=r[t+1])instanceof Re&&r.splice(t-1,3,new Re(e.length+1+n.length))}const eP=5;class Yl{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let n=Math.min(e,this.lineEnd),l=this.nodes[this.nodes.length-1];l instanceof Qe?l.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new Qe(n-this.pos,-1)),this.writtenTo=n,e>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,n){if(t<e||n.heightRelevant){let l=n.widget?n.widget.estimatedHeight:0;l<0&&(l=this.oracle.lineHeight);let a=e-t;n.block?this.addBlock(new Fm(a,l,n)):(a||l>=eP)&&this.addLineDeco(l,a)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Qe(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let n=new Re(e-t);return this.oracle.doc.lineAt(t).to==e&&(n.flags|=4),n}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Qe)return t;let e=new Qe(0,-1);return this.nodes.push(e),e}addBlock(t){var e;this.enterLine();let n=(e=t.deco)===null||e===void 0?void 0:e.type;n==Ne.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,n!=Ne.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let n=this.ensureLine();n.length+=e,n.collapsed+=e,n.widgetHeight=Math.max(n.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Qe)&&!this.isCovered?this.nodes.push(new Qe(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=t;for(let l of this.nodes)l instanceof Qe&&l.updateHeight(this.oracle,n),n+=l?l.length:1;return this.nodes}static build(t,e,n,l){let a=new Yl(n,t);return ge.spans(e,n,l,a,0),a.finish(n)}}function tP(r,t,e){let n=new iP;return ge.compare(r,t,e,n,0),n.changes}class iP{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,n,l){(t<e||n&&n.heightRelevant||l&&l.heightRelevant)&&vl(t,e,this.changes,5)}}function rP(r,t){let e=r.getBoundingClientRect(),n=r.ownerDocument,l=n.defaultView||window,a=Math.max(0,e.left),h=Math.min(l.innerWidth,e.right),d=Math.max(0,e.top),p=Math.min(l.innerHeight,e.bottom);for(let g=r.parentNode;g&&g!=n.body;)if(g.nodeType==1){let m=g,y=window.getComputedStyle(m);if((m.scrollHeight>m.clientHeight||m.scrollWidth>m.clientWidth)&&y.overflow!="visible"){let b=m.getBoundingClientRect();a=Math.max(a,b.left),h=Math.min(h,b.right),d=Math.max(d,b.top),p=g==r.parentNode?b.bottom:Math.min(p,b.bottom)}g=y.position=="absolute"||y.position=="fixed"?m.offsetParent:m.parentNode}else if(g.nodeType==11)g=g.host;else break;return{left:a-e.left,right:Math.max(a,h)-e.left,top:d-(e.top+t),bottom:Math.max(d,p)-(e.top+t)}}function sP(r,t){let e=r.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class Nn{constructor(t,e,n){this.from=t,this.to=e,this.size=n}static same(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let l=t[n],a=e[n];if(l.from!=a.from||l.to!=a.to||l.size!=a.size)return!1}return!0}draw(t){return fe.replace({widget:new nP(this.size,t)}).range(this.from,this.to)}}class nP extends pr{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Vp{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=Hp,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Te.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Kl).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new JA(e),this.stateDeco=t.facet(hr).filter(n=>typeof n!="function"),this.heightMap=qe.empty().applyChanges(this.stateDeco,le.empty,this.heightOracle.setDoc(t.doc),[new kt(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=fe.set(this.lineGaps.map(n=>n.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let n=0;n<=1;n++){let l=n?e.head:e.anchor;if(!t.some(({from:a,to:h})=>l>=a&&l<=h)){let{from:a,to:h}=this.lineBlockAt(l);t.push(new Lr(a,h))}}this.viewports=t.sort((n,l)=>n.from-l.from),this.scaler=this.heightMap.height<=7e6?Hp:new aP(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(this.scaler.scale==1?t:ir(t,this.scaler))})}update(t,e=null){this.state=t.state;let n=this.stateDeco;this.stateDeco=this.state.facet(hr).filter(g=>typeof g!="function");let l=t.changedRanges,a=kt.extendWithRanges(l,tP(n,this.stateDeco,t?t.changes:$e.empty(this.state.doc.length))),h=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),a),this.heightMap.height!=h&&(t.flags|=2);let d=a.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<d.from||e.range.head>d.to)||!this.viewportIsAppropriate(d))&&(d=this.getViewport(0,e));let p=!t.changes.empty||t.flags&2||d.from!=this.viewport.from||d.to!=this.viewport.to;this.viewport=d,this.updateForViewport(),p&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(pA)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,n=window.getComputedStyle(e),l=this.heightOracle,a=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Te.RTL:Te.LTR;let h=this.heightOracle.mustRefreshForWrapping(a),d=e.getBoundingClientRect(),p=h||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let g=0,m=0,y=parseInt(n.paddingTop)||0,b=parseInt(n.paddingBottom)||0;(this.paddingTop!=y||this.paddingBottom!=b)&&(this.paddingTop=y,this.paddingBottom=b,g|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(l.lineWrapping&&(p=!0),this.editorWidth=t.scrollDOM.clientWidth,g|=8);let k=(this.printing?sP:rP)(e,this.paddingTop),C=k.top-this.pixelViewport.top,O=k.bottom-this.pixelViewport.bottom;this.pixelViewport=k;let M=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(M!=this.inView&&(this.inView=M,M&&(p=!0)),!this.inView&&!this.scrollTarget)return 0;let I=d.width;if((this.contentDOMWidth!=I||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=t.scrollDOM.clientHeight,g|=8),p){let F=t.docView.measureVisibleLineHeights(this.viewport);if(l.mustRefreshForHeights(F)&&(h=!0),h||l.lineWrapping&&Math.abs(I-this.contentDOMWidth)>l.charWidth){let{lineHeight:N,charWidth:H,textHeight:W}=t.docView.measureTextSize();h=N>0&&l.refresh(a,N,H,W,I/H,F),h&&(t.docView.minWidth=0,g|=8)}C>0&&O>0?m=Math.max(C,O):C<0&&O<0&&(m=Math.min(C,O)),l.heightChanged=!1;for(let N of this.viewports){let H=N.from==this.viewport.from?F:t.docView.measureVisibleLineHeights(N);this.heightMap=(h?qe.empty().applyChanges(this.stateDeco,le.empty,this.heightOracle,[new kt(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(l,0,h,new ZA(N.from,H))}l.heightChanged&&(g|=2)}let L=!this.viewportIsAppropriate(this.viewport,m)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return L&&(this.viewport=this.getViewport(m,this.scrollTarget)),this.updateForViewport(),(g&2||L)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(h?[]:this.lineGaps,t)),g|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),g}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let n=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),l=this.heightMap,a=this.heightOracle,{visibleTop:h,visibleBottom:d}=this,p=new Lr(l.lineAt(h-n*1e3,ce.ByHeight,a,0,0).from,l.lineAt(d+(1-n)*1e3,ce.ByHeight,a,0,0).to);if(e){let{head:g}=e.range;if(g<p.from||g>p.to){let m=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),y=l.lineAt(g,ce.ByPos,a,0,0),b;e.y=="center"?b=(y.top+y.bottom)/2-m/2:e.y=="start"||e.y=="nearest"&&g<p.from?b=y.top:b=y.bottom-m,p=new Lr(l.lineAt(b-1e3/2,ce.ByHeight,a,0,0).from,l.lineAt(b+m+1e3/2,ce.ByHeight,a,0,0).to)}}return p}mapViewport(t,e){let n=e.mapPos(t.from,-1),l=e.mapPos(t.to,1);return new Lr(this.heightMap.lineAt(n,ce.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(l,ce.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},n=0){if(!this.inView)return!0;let{top:l}=this.heightMap.lineAt(t,ce.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(e,ce.ByPos,this.heightOracle,0,0),{visibleTop:h,visibleBottom:d}=this;return(t==0||l<=h-Math.max(10,Math.min(-n,250)))&&(e==this.state.doc.length||a>=d+Math.max(10,Math.min(n,250)))&&l>h-2*1e3&&a<d+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let n=[];for(let l of t)e.touchesRange(l.from,l.to)||n.push(new Nn(e.mapPos(l.from),e.mapPos(l.to),l.size));return n}ensureLineGaps(t,e){let n=this.heightOracle.lineWrapping,l=n?1e4:2e3,a=l>>1,h=l<<1;if(this.defaultTextDirection!=Te.LTR&&!n)return[];let d=[],p=(g,m,y,b)=>{if(m-g<a)return;let k=this.state.selection.main,C=[k.from];k.empty||C.push(k.to);for(let M of C)if(M>g&&M<m){p(g,M-10,y,b),p(M+10,m,y,b);return}let O=oP(t,M=>M.from>=y.from&&M.to<=y.to&&Math.abs(M.from-g)<a&&Math.abs(M.to-m)<a&&!C.some(I=>M.from<I&&M.to>I));if(!O){if(m<y.to&&e&&n&&e.visibleRanges.some(M=>M.from<=m&&M.to>=m)){let M=e.moveToLineBoundary(q.cursor(m),!1,!0).head;M>g&&(m=M)}O=new Nn(g,m,this.gapSize(y,g,m,b))}d.push(O)};for(let g of this.viewportLines){if(g.length<h)continue;let m=lP(g.from,g.to,this.stateDeco);if(m.total<h)continue;let y=this.scrollTarget?this.scrollTarget.range.head:null,b,k;if(n){let C=l/this.heightOracle.lineLength*this.heightOracle.lineHeight,O,M;if(y!=null){let I=Br(m,y),L=((this.visibleBottom-this.visibleTop)/2+C)/g.height;O=I-L,M=I+L}else O=(this.visibleTop-g.top-C)/g.height,M=(this.visibleBottom-g.top+C)/g.height;b=_r(m,O),k=_r(m,M)}else{let C=m.total*this.heightOracle.charWidth,O=l*this.heightOracle.charWidth,M,I;if(y!=null){let L=Br(m,y),F=((this.pixelViewport.right-this.pixelViewport.left)/2+O)/C;M=L-F,I=L+F}else M=(this.pixelViewport.left-O)/C,I=(this.pixelViewport.right+O)/C;b=_r(m,M),k=_r(m,I)}b>g.from&&p(g.from,b,g,m),k<g.to&&p(k,g.to,g,m)}return d}gapSize(t,e,n,l){let a=Br(l,n)-Br(l,e);return this.heightOracle.lineWrapping?t.height*a:l.total*this.heightOracle.charWidth*a}updateLineGaps(t){Nn.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=fe.set(t.map(e=>e.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];ge.spans(t,this.viewport.from,this.viewport.to,{span(l,a){e.push({from:l,to:a})},point(){}},20);let n=e.length!=this.visibleRanges.length||this.visibleRanges.some((l,a)=>l.from!=e[a].from||l.to!=e[a].to);return this.visibleRanges=e,n?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||ir(this.heightMap.lineAt(t,ce.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return ir(this.heightMap.lineAt(this.scaler.fromDOM(t),ce.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(t){return ir(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Lr{constructor(t,e){this.from=t,this.to=e}}function lP(r,t,e){let n=[],l=r,a=0;return ge.spans(e,r,t,{span(){},point(h,d){h>l&&(n.push({from:l,to:h}),a+=h-l),l=d}},20),l<t&&(n.push({from:l,to:t}),a+=t-l),{total:a,ranges:n}}function _r({total:r,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let n=Math.floor(r*e);for(let l=0;;l++){let{from:a,to:h}=t[l],d=h-a;if(n<=d)return a+n;n-=d}}function Br(r,t){let e=0;for(let{from:n,to:l}of r.ranges){if(t<=l){e+=t-n;break}e+=l-n}return e/r.total}function oP(r,t){for(let e of r)if(t(e))return e}const Hp={toDOM(r){return r},fromDOM(r){return r},scale:1};class aP{constructor(t,e,n){let l=0,a=0,h=0;this.viewports=n.map(({from:d,to:p})=>{let g=e.lineAt(d,ce.ByPos,t,0,0).top,m=e.lineAt(p,ce.ByPos,t,0,0).bottom;return l+=m-g,{from:d,to:p,top:g,bottom:m,domTop:0,domBottom:0}}),this.scale=(7e6-l)/(e.height-l);for(let d of this.viewports)d.domTop=h+(d.top-a)*this.scale,h=d.domBottom=d.domTop+(d.bottom-d.top),a=d.bottom}toDOM(t){for(let e=0,n=0,l=0;;e++){let a=e<this.viewports.length?this.viewports[e]:null;if(!a||t<a.top)return l+(t-n)*this.scale;if(t<=a.bottom)return a.domTop+(t-a.top);n=a.bottom,l=a.domBottom}}fromDOM(t){for(let e=0,n=0,l=0;;e++){let a=e<this.viewports.length?this.viewports[e]:null;if(!a||t<a.domTop)return n+(t-l)/this.scale;if(t<=a.domBottom)return a.top+(t-a.domTop);n=a.bottom,l=a.domBottom}}}function ir(r,t){if(t.scale==1)return r;let e=t.toDOM(r.top),n=t.toDOM(r.bottom);return new Ct(r.from,r.length,e,n-e,r.children&&r.children.map(l=>ir(l,t)),r.deco)}const Fr=K.define({combine:r=>r.join(" ")}),Al=K.define({combine:r=>r.indexOf(!0)>-1}),Pl=Wt.newName(),Vm=Wt.newName(),Hm=Wt.newName(),Wm={"&light":"."+Vm,"&dark":"."+Hm};function $l(r,t,e){return new Wt(t,{finish(n){return/&/.test(n)?n.replace(/&\w*/,l=>{if(l=="&")return r;if(!e||!e[l])throw new RangeError(`Unsupported selector: ${l}`);return e[l]}):r+" "+n}})}const fP=$l("."+Pl,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Wm);class uP{constructor(t,e,n,l){this.typeOver=l,this.bounds=null,this.text="";let{impreciseHead:a,impreciseAnchor:h}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,n,0))){let d=a||h?[]:cP(t),p=new $m(d,t.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=dP(d,this.bounds.from)}else{let d=t.observer.selectionRange,p=a&&a.node==d.focusNode&&a.offset==d.focusOffset||!Mi(t.contentDOM,d.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(d.focusNode,d.focusOffset),g=h&&h.node==d.anchorNode&&h.offset==d.anchorOffset||!Mi(t.contentDOM,d.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(d.anchorNode,d.anchorOffset);this.newSel=q.single(g,p)}}}function zm(r,t){let e,{newSel:n}=t,l=r.state.selection.main,a=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(t.bounds){let{from:h,to:d}=t.bounds,p=l.from,g=null;(a===8||U.android&&t.text.length<d-h)&&(p=l.to,g="end");let m=hP(r.state.doc.sliceString(h,d,yi),t.text,p-h,g);m&&(U.chrome&&a==13&&m.toB==m.from+2&&t.text.slice(m.from,m.toB)==yi+yi&&m.toB--,e={from:h+m.from,to:h+m.toA,insert:le.of(t.text.slice(m.from,m.toB).split(yi))})}else n&&(!r.hasFocus&&r.state.facet(Rs)||n.main.eq(l))&&(n=null);if(!e&&!n)return!1;if(!e&&t.typeOver&&!l.empty&&n&&n.main.empty?e={from:l.from,to:l.to,insert:r.state.doc.slice(l.from,l.to)}:e&&e.from>=l.from&&e.to<=l.to&&(e.from!=l.from||e.to!=l.to)&&l.to-l.from-(e.to-e.from)<=4?e={from:l.from,to:l.to,insert:r.state.doc.slice(l.from,e.from).append(e.insert).append(r.state.doc.slice(e.to,l.to))}:(U.mac||U.android)&&e&&e.from==e.to&&e.from==l.head-1&&/^\. ?$/.test(e.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(n&&e.insert.length==2&&(n=q.single(n.main.anchor-1,n.main.head-1)),e={from:l.from,to:l.to,insert:le.of([" "])}):U.chrome&&e&&e.from==e.to&&e.from==l.head&&e.insert.toString()==`
 `&&r.lineWrapping&&(n&&(n=q.single(n.main.anchor-1,n.main.head-1)),e={from:l.from,to:l.to,insert:le.of([" "])}),e){let h=r.state;if(U.ios&&r.inputState.flushIOSKey(r)||U.android&&(e.from==l.from&&e.to==l.to&&e.insert.length==1&&e.insert.lines==2&&Pi(r.contentDOM,"Enter",13)||(e.from==l.from-1&&e.to==l.to&&e.insert.length==0||a==8&&e.insert.length<e.to-e.from)&&Pi(r.contentDOM,"Backspace",8)||e.from==l.from&&e.to==l.to+1&&e.insert.length==0&&Pi(r.contentDOM,"Delete",46)))return!0;let d=e.insert.toString();if(r.state.facet(vm).some(m=>m(r,e.from,e.to,d)))return!0;r.inputState.composing>=0&&r.inputState.composing++;let p;if(e.from>=l.from&&e.to<=l.to&&e.to-e.from>=(l.to-l.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let m=l.from<e.from?h.sliceDoc(l.from,e.from):"",y=l.to>e.to?h.sliceDoc(e.to,l.to):"";p=h.replaceSelection(r.state.toText(m+e.insert.sliceString(0,void 0,r.state.lineBreak)+y))}else{let m=h.changes(e),y=n&&n.main.to<=m.newLength?n.main:void 0;if(h.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=l.to&&e.to>=l.to-10){let b=r.state.sliceDoc(e.from,e.to),k=Cm(r)||r.state.doc.lineAt(l.head),C=l.to-e.to,O=l.to-l.from;p=h.changeByRange(M=>{if(M.from==l.from&&M.to==l.to)return{changes:m,range:y||M.map(m)};let I=M.to-C,L=I-b.length;if(M.to-M.from!=O||r.state.sliceDoc(L,I)!=b||k&&M.to>=k.from&&M.from<=k.to)return{range:M};let F=h.changes({from:L,to:I,insert:e.insert}),N=M.to-l.to;return{changes:F,range:y?q.range(Math.max(0,y.anchor+N),Math.max(0,y.head+N)):M.map(F)}})}else p={changes:m,selection:y&&h.selection.replaceRange(y)}}let g="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,g+=".compose",r.inputState.compositionFirstChange&&(g+=".start",r.inputState.compositionFirstChange=!1)),r.dispatch(p,{scrollIntoView:!0,userEvent:g}),!0}else if(n&&!n.main.eq(l)){let h=!1,d="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(h=!0),d=r.inputState.lastSelectionOrigin),r.dispatch({selection:n,scrollIntoView:h,userEvent:d}),!0}else return!1}function hP(r,t,e,n){let l=Math.min(r.length,t.length),a=0;for(;a<l&&r.charCodeAt(a)==t.charCodeAt(a);)a++;if(a==l&&r.length==t.length)return null;let h=r.length,d=t.length;for(;h>0&&d>0&&r.charCodeAt(h-1)==t.charCodeAt(d-1);)h--,d--;if(n=="end"){let p=Math.max(0,a-Math.min(h,d));e-=h+p-a}if(h<a&&r.length<t.length){let p=e<=a&&e>=h?a-e:0;a-=p,d=a+(d-h),h=a}else if(d<a){let p=e<=a&&e>=d?a-e:0;a-=p,h=a+(h-d),d=a}return{from:a,toA:h,toB:d}}function cP(r){let t=[];if(r.root.activeElement!=r.contentDOM)return t;let{anchorNode:e,anchorOffset:n,focusNode:l,focusOffset:a}=r.observer.selectionRange;return e&&(t.push(new kp(e,n)),(l!=e||a!=n)&&t.push(new kp(l,a))),t}function dP(r,t){if(r.length==0)return null;let e=r[0].pos,n=r.length==2?r[1].pos:e;return e>-1&&n>-1?q.single(e+t,n+t):null}const pP={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ln=U.ie&&U.ie_version<=11;class gP{constructor(t){this.view=t,this.active=!1,this.selectionRange=new aA,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let n of e)this.queue.push(n);(U.ie&&U.ie_version<=11||U.ios&&t.composing)&&e.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),Ln&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(t.contentDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runScrollHandlers(this.view,t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,n)=>e!=t[n]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,l=this.selectionRange;if(n.state.facet(Rs)?n.root.activeElement!=this.dom:!Jr(n.dom,l))return;let a=l.anchorNode&&n.docView.nearest(l.anchorNode);if(a&&a.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(U.ie&&U.ie_version<=11||U.android&&U.chrome)&&!n.state.selection.main.empty&&l.focusNode&&ds(l.focusNode,l.focusOffset,l.anchorNode,l.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=U.safari&&t.root.nodeType==11&&sA(this.dom.ownerDocument)==this.dom&&mP(this.view)||cs(t.root);if(!e||this.selectionRange.eq(e))return!1;let n=Jr(this.dom,e);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&uA(this.dom,e)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(e),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let n=this.dom;n;)if(n.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==n?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=e)n.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,pP),Ln&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ln&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var n;if(!this.delayedAndroidKey){let l=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&Pi(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(l)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,n=-1,l=!1;for(let a of t){let h=this.readMutation(a);h&&(h.typeOver&&(l=!0),e==-1?{from:e,to:n}=h:(e=Math.min(h.from,e),n=Math.max(h.to,n)))}return{from:e,to:n,typeOver:l}}readChange(){let{from:t,to:e,typeOver:n}=this.processRecords(),l=this.selectionChanged&&Jr(this.dom,this.selectionRange);return t<0&&!l?null:(t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new uP(this.view,t,e,n))}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return!1;let n=this.view.state,l=zm(this.view,e);return this.view.state==n&&this.view.update([]),l}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.dirty|=4),t.type=="childList"){let n=Wp(e,t.previousSibling||t.target.previousSibling,-1),l=Wp(e,t.nextSibling||t.target.nextSibling,1);return{from:n?e.posAfter(n):e.posAtStart,to:l?e.posBefore(l):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,e,n,l;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect(),(l=this.resizeContent)===null||l===void 0||l.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Wp(r,t,e){for(;t;){let n=he.get(t);if(n&&n.parent==r)return n;let l=t.parentNode;t=l!=r.dom?l:e>0?t.nextSibling:t.previousSibling}return null}function mP(r){let t=null;function e(p){p.preventDefault(),p.stopImmediatePropagation(),t=p.getTargetRanges()[0]}if(r.contentDOM.addEventListener("beforeinput",e,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",e,!0),!t)return null;let n=t.startContainer,l=t.startOffset,a=t.endContainer,h=t.endOffset,d=r.docView.domAtPos(r.state.selection.main.anchor);return ds(d.node,d.offset,a,h)&&([n,l,a,h]=[a,h,n,l]),{anchorNode:n,anchorOffset:l,focusNode:a,focusOffset:h}}class Q{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(e=>this.update([e])),this.dispatch=this.dispatch.bind(this),this._root=t.root||fA(t.parent)||document,this.viewState=new Vp(t.state||se.create(t)),this.plugins=this.state.facet(er).map(e=>new Rn(e));for(let e of this.plugins)e.update(this);this.observer=new gP(this),this.inputState=new BA(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Sp(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}dispatch(...t){let e=t.length==1&&t[0]instanceof Ce?t[0]:this.state.update(...t);this._dispatch(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,n=!1,l,a=this.state;for(let b of t){if(b.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=b.state}if(this.destroyed){this.viewState.state=a;return}let h=this.hasFocus,d=0,p=null;t.some(b=>b.annotation(Lm))?(this.inputState.notifiedFocused=h,d=1):h!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=h,p=_m(a,h),p||(d=1));let g=this.observer.delayedAndroidKey,m=null;if(g?(this.observer.clearDelayedAndroidKey(),m=this.observer.readChange(),(m&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(m=null)):this.observer.clear(),a.facet(se.phrases)!=this.state.facet(se.phrases))return this.setState(a);l=ms.create(this,a,t),l.flags|=d;let y=this.viewState.scrollTarget;try{this.updateState=2;for(let b of t){if(y&&(y=y.map(b.changes)),b.scrollIntoView){let{main:k}=b.state.selection;y=new gs(k.empty?k:q.cursor(k.head,k.head>k.anchor?-1:1))}for(let k of b.effects)k.is(bp)&&(y=k.value)}this.viewState.update(l,y),this.bidiCache=vs.update(this.bidiCache,l.changes),l.empty||(this.updatePlugins(l),this.inputState.update(l)),e=this.docView.update(l),this.state.facet(tr)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(l.startState.facet(Fr)!=l.state.facet(Fr)&&(this.viewState.mustMeasureContent=!0),(e||n||y||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!l.empty)for(let b of this.state.facet(yl))b(l);(p||m)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),m&&!zm(this,m)&&g.force&&Pi(this.contentDOM,g.key,g.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Vp(t),this.plugins=t.facet(er).map(n=>new Rn(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView=new Sp(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(er),n=t.state.facet(er);if(e!=n){let l=[];for(let a of n){let h=e.indexOf(a);if(h<0)l.push(new Rn(a));else{let d=this.plugins[h];d.mustUpdate=t,l.push(d)}}for(let a of this.plugins)a.mustUpdate!=t&&a.destroy(this);this.plugins=l,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let l of this.plugins)l.mustUpdate=t;for(let l=0;l<this.plugins.length;l++)this.plugins[l].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,{scrollHeight:n,scrollTop:l,clientHeight:a}=this.scrollDOM,h=l>n-a-4?n:l;try{for(let d=0;;d++){this.updateState=1;let p=this.viewport,g=this.viewState.lineBlockAtHeight(h),m=this.viewState.measure(this);if(!m&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let y=[];m&4||([this.measureRequests,y]=[y,this.measureRequests]);let b=y.map(M=>{try{return M.read(this)}catch(I){return Et(this.state,I),zp}}),k=ms.create(this,this.state,[]),C=!1,O=!1;k.flags|=m,e?e.flags|=m:e=k,this.updateState=2,k.empty||(this.updatePlugins(k),this.inputState.update(k),this.updateAttrs(),C=this.docView.update(k));for(let M=0;M<y.length;M++)if(b[M]!=zp)try{let I=y[M];I.write&&I.write(b[M],this)}catch(I){Et(this.state,I)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,O=!0;else{let M=this.viewState.lineBlockAt(g.from).top-g.top;(M>1||M<-1)&&(this.scrollDOM.scrollTop+=M,O=!0)}if(C&&this.docView.updateSelection(!0),this.viewport.from==p.from&&this.viewport.to==p.to&&!O&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let d of this.state.facet(yl))d(e)}get themeClasses(){return Pl+" "+(this.state.facet(Al)?Hm:Vm)+" "+this.state.facet(Fr)}updateAttrs(){let t=Up(this,bm,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Rs)?"true":"false",class:"cm-content",style:`${U.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Up(this,Kl,e);let n=this.observer.ignore(()=>{let l=ml(this.contentDOM,this.contentAttrs,e),a=ml(this.dom,this.editorAttrs,t);return l||a});return this.editorAttrs=t,this.contentAttrs=e,n}showAnnouncements(t){let e=!0;for(let n of t)for(let l of n.effects)if(l.is(Q.announce)){e&&(this.announceDOM.textContent=""),e=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=l.value}}mountStyles(){this.styleModules=this.state.facet(tr),Wt.mount(this.root,this.styleModules.concat(fP).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(n=>n.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,n){return In(this,t,Tp(this,t,e,n))}moveByGroup(t,e){return In(this,t,Tp(this,t,e,n=>LA(this,t.head,n)))}moveToLineBoundary(t,e,n=!0){return NA(this,t,e,n)}moveVertically(t,e,n){return In(this,t,_A(this,t,e,n))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Tm(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let n=this.docView.coordsAt(t,e);if(!n||n.left==n.right)return n;let l=this.state.doc.lineAt(t),a=this.bidiSpans(l),h=a[$i.find(a,t-l.from,-1,e)];return Ul(n,h.dir==Te.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(xm)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>vP)return Am(t.length);let e=this.textDirectionAt(t.from);for(let l of this.bidiCache)if(l.from==t.from&&l.dir==e)return l.order;let n=wA(t.text,e);return this.bidiCache.push(new vs(t.from,t.to,e,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||U.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Zg(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return bp.of(new gs(typeof t=="number"?q.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return St.define(()=>({}),{eventHandlers:t})}static theme(t,e){let n=Wt.newName(),l=[Fr.of(n),tr.of($l(`.${n}`,t))];return e&&e.dark&&l.push(Al.of(!0)),l}static baseTheme(t){return Hl.lowest(tr.of($l("."+Pl,t,Wm)))}static findFromDOM(t){var e;let n=t.querySelector(".cm-content"),l=n&&he.get(n)||he.get(t);return((e=l==null?void 0:l.rootView)===null||e===void 0?void 0:e.view)||null}}Q.styleModule=tr;Q.inputHandler=vm;Q.focusChangeEffect=ym;Q.perLineTextDirection=xm;Q.exceptionSink=mm;Q.updateListener=yl;Q.editable=Rs;Q.mouseSelectionStyle=gm;Q.dragMovesSelection=pm;Q.clickAddsSelectionRange=dm;Q.decorations=hr;Q.atomicRanges=Xl;Q.scrollMargins=wm;Q.darkTheme=Al;Q.contentAttributes=Kl;Q.editorAttributes=bm;Q.lineWrapping=Q.contentAttributes.of({class:"cm-lineWrapping"});Q.announce=de.define();const vP=4096,zp={};class vs{constructor(t,e,n,l){this.from=t,this.to=e,this.dir=n,this.order=l}static update(t,e){if(e.empty)return t;let n=[],l=t.length?t[t.length-1].dir:Te.LTR;for(let a=Math.max(0,t.length-10);a<t.length;a++){let h=t[a];h.dir==l&&!e.touchesRange(h.from,h.to)&&n.push(new vs(e.mapPos(h.from,1),e.mapPos(h.to,-1),h.dir,h.order))}return n}}function Up(r,t,e){for(let n=r.state.facet(t),l=n.length-1;l>=0;l--){let a=n[l],h=typeof a=="function"?a(r):a;h&&gl(h,e)}return e}const yP=U.mac?"mac":U.windows?"win":U.linux?"linux":"key";function xP(r,t){const e=r.split(/-(?!$)/);let n=e[e.length-1];n=="Space"&&(n=" ");let l,a,h,d;for(let p=0;p<e.length-1;++p){const g=e[p];if(/^(cmd|meta|m)$/i.test(g))d=!0;else if(/^a(lt)?$/i.test(g))l=!0;else if(/^(c|ctrl|control)$/i.test(g))a=!0;else if(/^s(hift)?$/i.test(g))h=!0;else if(/^mod$/i.test(g))t=="mac"?d=!0:a=!0;else throw new Error("Unrecognized modifier name: "+g)}return l&&(n="Alt-"+n),a&&(n="Ctrl-"+n),d&&(n="Meta-"+n),h&&(n="Shift-"+n),n}function Vr(r,t,e){return t.altKey&&(r="Alt-"+r),t.ctrlKey&&(r="Ctrl-"+r),t.metaKey&&(r="Meta-"+r),e!==!1&&t.shiftKey&&(r="Shift-"+r),r}const bP=Hl.default(Q.domEventHandlers({keydown(r,t){return AP(wP(t.state),r,t,"editor")}})),Um=K.define({enables:bP}),qp=new WeakMap;function wP(r){let t=r.facet(Um),e=qp.get(t);return e||qp.set(t,e=SP(t.reduce((n,l)=>n.concat(l),[]))),e}let _t=null;const kP=4e3;function SP(r,t=yP){let e=Object.create(null),n=Object.create(null),l=(h,d)=>{let p=n[h];if(p==null)n[h]=d;else if(p!=d)throw new Error("Key binding "+h+" is used both as a regular binding and as a multi-stroke prefix")},a=(h,d,p,g)=>{var m,y;let b=e[h]||(e[h]=Object.create(null)),k=d.split(/ (?!$)/).map(M=>xP(M,t));for(let M=1;M<k.length;M++){let I=k.slice(0,M).join(" ");l(I,!0),b[I]||(b[I]={preventDefault:!0,run:[L=>{let F=_t={view:L,prefix:I,scope:h};return setTimeout(()=>{_t==F&&(_t=null)},kP),!0}]})}let C=k.join(" ");l(C,!1);let O=b[C]||(b[C]={preventDefault:!1,run:((y=(m=b._any)===null||m===void 0?void 0:m.run)===null||y===void 0?void 0:y.slice())||[]});p&&O.run.push(p),g&&(O.preventDefault=!0)};for(let h of r){let d=h.scope?h.scope.split(" "):["editor"];if(h.any)for(let g of d){let m=e[g]||(e[g]=Object.create(null));m._any||(m._any={preventDefault:!1,run:[]});for(let y in m)m[y].run.push(h.any)}let p=h[t]||h.key;if(p)for(let g of d)a(g,p,h.run,h.preventDefault),h.shift&&a(g,"Shift-"+p,h.shift,h.preventDefault)}return e}function AP(r,t,e,n){let l=rA(t),a=Xr(l,0),h=Jn(a)==l.length&&l!=" ",d="",p=!1;_t&&_t.view==e&&_t.scope==n&&(d=_t.prefix+" ",(p=Em.indexOf(t.keyCode)<0)&&(_t=null));let g=new Set,m=C=>{if(C){for(let O of C.run)if(!g.has(O)&&(g.add(O),O(e,t)))return!0;C.preventDefault&&(p=!0)}return!1},y=r[n],b,k;if(y){if(m(y[d+Vr(l,t,!h)]))return!0;if(h&&(t.altKey||t.metaKey||t.ctrlKey)&&!(U.windows&&t.ctrlKey&&t.altKey)&&(b=zt[t.keyCode])&&b!=l){if(m(y[d+Vr(b,t,!0)]))return!0;if(t.shiftKey&&(k=fr[t.keyCode])!=l&&k!=b&&m(y[d+Vr(k,t,!1)]))return!0}else if(h&&t.shiftKey&&m(y[d+Vr(l,t,!0)]))return!0;if(m(y._any))return!0}return p}const PP=!U.ios,$P={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};PP&&($P[".cm-line"].caretColor="transparent !important");const Hr="-10000px";class qm{constructor(t,e,n){this.facet=e,this.createTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(l=>l),this.tooltipViews=this.tooltips.map(n)}update(t){var e;let n=t.state.facet(this.facet),l=n.filter(h=>h);if(n===this.input){for(let h of this.tooltipViews)h.update&&h.update(t);return!1}let a=[];for(let h=0;h<l.length;h++){let d=l[h],p=-1;if(d){for(let g=0;g<this.tooltips.length;g++){let m=this.tooltips[g];m&&m.create==d.create&&(p=g)}if(p<0)a[h]=this.createTooltipView(d);else{let g=a[h]=this.tooltipViews[p];g.update&&g.update(t)}}}for(let h of this.tooltipViews)a.indexOf(h)<0&&(h.dom.remove(),(e=h.destroy)===null||e===void 0||e.call(h));return this.input=n,this.tooltips=l,this.tooltipViews=a,!0}}function CP(r){let{win:t}=r;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const _n=K.define({combine:r=>{var t,e,n;return{position:U.ios?"absolute":((t=r.find(l=>l.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=r.find(l=>l.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((n=r.find(l=>l.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||CP}}}),Gp=new WeakMap,MP=St.fromClass(class{constructor(r){this.view=r,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=r.state.facet(_n);this.position=t.position,this.parent=t.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new qm(r,Gm,e=>this.createTooltip(e)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(r);t&&this.observeIntersection();let e=t||r.geometryChanged,n=r.state.facet(_n);if(n.position!=this.position){this.position=n.position;for(let l of this.manager.tooltipViews)l.dom.style.position=this.position;e=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let l of this.manager.tooltipViews)this.container.appendChild(l.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(r){let t=r.create(this.view);if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",t.dom.appendChild(e)}return t.dom.style.position=this.position,t.dom.style.top=Hr,this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}destroy(){var r,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),(r=e.destroy)===null||r===void 0||r.call(e);(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=this.view.dom.getBoundingClientRect();return{editor:r,parent:this.parent?this.container.getBoundingClientRect():r,pos:this.manager.tooltips.map((t,e)=>{let n=this.manager.tooltipViews[e];return n.getCoords?n.getCoords(t.pos):this.view.coordsAtPos(t.pos)}),size:this.manager.tooltipViews.map(({dom:t})=>t.getBoundingClientRect()),space:this.view.state.facet(_n).tooltipSpace(this.view)}}writeMeasure(r){var t;let{editor:e,space:n}=r,l=[];for(let a=0;a<this.manager.tooltips.length;a++){let h=this.manager.tooltips[a],d=this.manager.tooltipViews[a],{dom:p}=d,g=r.pos[a],m=r.size[a];if(!g||g.bottom<=Math.max(e.top,n.top)||g.top>=Math.min(e.bottom,n.bottom)||g.right<Math.max(e.left,n.left)-.1||g.left>Math.min(e.right,n.right)+.1){p.style.top=Hr;continue}let y=h.arrow?d.dom.querySelector(".cm-tooltip-arrow"):null,b=y?7:0,k=m.right-m.left,C=(t=Gp.get(d))!==null&&t!==void 0?t:m.bottom-m.top,O=d.offset||DP,M=this.view.textDirection==Te.LTR,I=m.width>n.right-n.left?M?n.left:n.right-m.width:M?Math.min(g.left-(y?14:0)+O.x,n.right-k):Math.max(n.left,g.left-k+(y?14:0)-O.x),L=!!h.above;!h.strictSide&&(L?g.top-(m.bottom-m.top)-O.y<n.top:g.bottom+(m.bottom-m.top)+O.y>n.bottom)&&L==n.bottom-g.bottom>g.top-n.top&&(L=!L);let F=(L?g.top-n.top:n.bottom-g.bottom)-b;if(F<C&&d.resize!==!1){if(F<this.view.defaultLineHeight){p.style.top=Hr;continue}Gp.set(d,C),p.style.height=(C=F)+"px"}else p.style.height&&(p.style.height="");let N=L?g.top-C-b-O.y:g.bottom+b+O.y,H=I+k;if(d.overlap!==!0)for(let W of l)W.left<H&&W.right>I&&W.top<N+C&&W.bottom>N&&(N=L?W.top-C-2-b:W.bottom+b+2);this.position=="absolute"?(p.style.top=N-r.parent.top+"px",p.style.left=I-r.parent.left+"px"):(p.style.top=N+"px",p.style.left=I+"px"),y&&(y.style.left=`${g.left+(M?O.x:-O.x)-(I+14-7)}px`),d.overlap!==!0&&l.push({left:I,top:N,right:H,bottom:N+C}),p.classList.toggle("cm-tooltip-above",L),p.classList.toggle("cm-tooltip-below",!L),d.positioned&&d.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Hr}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),TP=Q.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),DP={x:0,y:0},Gm=K.define({enables:[MP,TP]}),ys=K.define();class Jl{static create(t){return new Jl(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new qm(t,ys,e=>this.createHostedView(e))}createHostedView(t){let e=t.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(e.dom),this.mounted&&e.mount&&e.mount(this.view),e}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}}const EP=Gm.compute([ys],r=>{let t=r.facet(ys).filter(e=>e);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.filter(e=>e.end!=null).map(e=>e.end)),create:Jl.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class RP{constructor(t,e,n,l,a){this.view=t,this.source=e,this.field=n,this.setHover=l,this.hoverTime=a,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:t}=this,e=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(e==null)return;let n=this.view.coordsAtPos(e);if(n==null||t.y<n.top||t.y>n.bottom||t.x<n.left-this.view.defaultCharacterWidth||t.x>n.right+this.view.defaultCharacterWidth)return;let l=this.view.bidiSpans(this.view.state.doc.lineAt(e)).find(d=>d.from<=e&&d.to>=e),a=l&&l.dir==Te.RTL?-1:1,h=this.source(this.view,e,t.x<n.left?-a:a);if(h!=null&&h.then){let d=this.pending={pos:e};h.then(p=>{this.pending==d&&(this.pending=null,p&&this.view.dispatch({effects:this.setHover.of(p)}))},p=>Et(this.view.state,p,"hover tooltip"))}else h&&this.view.dispatch({effects:this.setHover.of(h)})}mousemove(t){var e;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let n=this.active;if(n&&!jp(this.lastMove.target)||this.pending){let{pos:l}=n||this.pending,a=(e=n==null?void 0:n.end)!==null&&e!==void 0?e:l;(l==a?this.view.posAtCoords(this.lastMove)!=l:!OP(this.view,l,a,t.clientX,t.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!jp(t.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function jp(r){for(let t=r;t;t=t.parentNode)if(t.nodeType==1&&t.classList.contains("cm-tooltip"))return!0;return!1}function OP(r,t,e,n,l,a){let h=document.createRange(),d=r.domAtPos(t),p=r.domAtPos(e);h.setEnd(p.node,p.offset),h.setStart(d.node,d.offset);let g=h.getClientRects();h.detach();for(let m=0;m<g.length;m++){let y=g[m];if(Math.max(y.top-l,l-y.bottom,y.left-n,n-y.right)<=a)return!0}return!1}function IP(r,t={}){let e=de.define(),n=At.define({create(){return null},update(l,a){if(l&&(t.hideOnChange&&(a.docChanged||a.selection)||t.hideOn&&t.hideOn(a,l)))return null;if(l&&a.docChanged){let h=a.changes.mapPos(l.pos,-1,Ke.TrackDel);if(h==null)return null;let d=Object.assign(Object.create(null),l);d.pos=h,l.end!=null&&(d.end=a.changes.mapPos(l.end)),l=d}for(let h of a.effects)h.is(e)&&(l=h.value),h.is(NP)&&(l=null);return l},provide:l=>ys.from(l)});return[n,St.define(l=>new RP(l,r,n,e,t.hoverTime||300)),EP]}const NP=de.define(),Kp=K.define({combine(r){let t,e;for(let n of r)t=t||n.topContainer,e=e||n.bottomContainer;return{topContainer:t,bottomContainer:e}}}),LP=St.fromClass(class{constructor(r){this.input=r.state.facet(Cl),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(r));let t=r.state.facet(Kp);this.top=new Wr(r,!0,t.topContainer),this.bottom=new Wr(r,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(r){let t=r.state.facet(Kp);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Wr(r.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Wr(r.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=r.state.facet(Cl);if(e!=this.input){let n=e.filter(p=>p),l=[],a=[],h=[],d=[];for(let p of n){let g=this.specs.indexOf(p),m;g<0?(m=p(r.view),d.push(m)):(m=this.panels[g],m.update&&m.update(r)),l.push(m),(m.top?a:h).push(m)}this.specs=n,this.panels=l,this.top.sync(a),this.bottom.sync(h);for(let p of d)p.dom.classList.add("cm-panel"),p.mount&&p.mount()}else for(let n of this.panels)n.update&&n.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Q.scrollMargins.of(t=>{let e=t.plugin(r);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class Wr{constructor(t,e,n){this.view=t,this.top=e,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Xp(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Xp(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Xp(r){let t=r.nextSibling;return r.remove(),t}const Cl=K.define({enables:LP});class li extends Ci{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}li.prototype.elementClass="";li.prototype.toDOM=void 0;li.prototype.mapMode=Ke.TrackBefore;li.prototype.startSide=li.prototype.endSide=-1;li.prototype.point=!0;const Bn=K.define(),es=K.define(),Ml=K.define({combine:r=>r.some(t=>t)});function _P(r){let t=[BP];return r&&r.fixed===!1&&t.push(Ml.of(!0)),t}const BP=St.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=r.state.facet(es).map(t=>new Jp(r,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!r.state.facet(Ml),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let t=this.prevViewport,e=r.view.viewport,n=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(n<(e.to-e.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Ml)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let t=this.dom.nextSibling;r&&this.dom.remove();let e=ge.iter(this.view.state.facet(Bn),this.view.viewport.from),n=[],l=this.gutters.map(a=>new FP(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(a.type)){let h=!0;for(let d of a.type)if(d.type==Ne.Text&&h){Tl(e,n,d.from);for(let p of l)p.line(this.view,d,n);h=!1}else if(d.widget)for(let p of l)p.widget(this.view,d)}else if(a.type==Ne.Text){Tl(e,n,a.from);for(let h of l)h.line(this.view,a,n)}for(let a of l)a.finish();r&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(r){let t=r.startState.facet(es),e=r.state.facet(es),n=r.docChanged||r.heightChanged||r.viewportChanged||!ge.eq(r.startState.facet(Bn),r.state.facet(Bn),r.view.viewport.from,r.view.viewport.to);if(t==e)for(let l of this.gutters)l.update(r)&&(n=!0);else{n=!0;let l=[];for(let a of e){let h=t.indexOf(a);h<0?l.push(new Jp(this.view,a)):(this.gutters[h].update(r),l.push(this.gutters[h]))}for(let a of this.gutters)a.dom.remove(),l.indexOf(a)<0&&a.destroy();for(let a of l)this.dom.appendChild(a.dom);this.gutters=l}return n}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>Q.scrollMargins.of(t=>{let e=t.plugin(r);return!e||e.gutters.length==0||!e.fixed?null:t.textDirection==Te.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}})});function Yp(r){return Array.isArray(r)?r:[r]}function Tl(r,t,e){for(;r.value&&r.from<=e;)r.from==e&&t.push(r.value),r.next()}class FP{constructor(t,e,n){this.gutter=t,this.height=n,this.i=0,this.cursor=ge.iter(t.markers,e.from)}addElement(t,e,n){let{gutter:l}=this,a=e.top-this.height;if(this.i==l.elements.length){let h=new jm(t,e.height,a,n);l.elements.push(h),l.dom.appendChild(h.dom)}else l.elements[this.i].update(t,e.height,a,n);this.height=e.bottom,this.i++}line(t,e,n){let l=[];Tl(this.cursor,l,e.from),n.length&&(l=l.concat(n));let a=this.gutter.config.lineMarker(t,e,l);a&&l.unshift(a);let h=this.gutter;l.length==0&&!h.config.renderEmptyElements||this.addElement(t,e,l)}widget(t,e){let n=this.gutter.config.widgetMarker(t,e.widget,e);n&&this.addElement(t,e,[n])}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class Jp{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in e.domEventHandlers)this.dom.addEventListener(n,l=>{let a=l.target,h;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let p=a.getBoundingClientRect();h=(p.top+p.bottom)/2}else h=l.clientY;let d=t.lineBlockAtHeight(h-t.documentTop);e.domEventHandlers[n](t,d,l)&&l.preventDefault()});this.markers=Yp(e.markers(t)),e.initialSpacer&&(this.spacer=new jm(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=Yp(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let l=this.config.updateSpacer(this.spacer.markers[0],t);l!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[l])}let n=t.view.viewport;return!ge.eq(this.markers,e,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class jm{constructor(t,e,n,l){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,n,l)}update(t,e,n,l){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),VP(this.markers,l)||this.setMarkers(t,l)}setMarkers(t,e){let n="cm-gutterElement",l=this.dom.firstChild;for(let a=0,h=0;;){let d=h,p=a<e.length?e[a++]:null,g=!1;if(p){let m=p.elementClass;m&&(n+=" "+m);for(let y=h;y<this.markers.length;y++)if(this.markers[y].compare(p)){d=y,g=!0;break}}else d=this.markers.length;for(;h<d;){let m=this.markers[h++];if(m.toDOM){m.destroy(l);let y=l.nextSibling;l.remove(),l=y}}if(!p)break;p.toDOM&&(g?l=l.nextSibling:this.dom.insertBefore(p.toDOM(t),l)),g&&h++}this.dom.className=n,this.markers=e}destroy(){this.setMarkers(null,[])}}function VP(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(!r[e].compare(t[e]))return!1;return!0}const HP=K.define(),xi=K.define({combine(r){return Wl(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let n=Object.assign({},t);for(let l in e){let a=n[l],h=e[l];n[l]=a?(d,p,g)=>a(d,p,g)||h(d,p,g):h}return n}})}});class Fn extends li{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Vn(r,t){return r.state.facet(xi).formatNumber(t,r.state)}const WP=es.compute([xi],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(HP)},lineMarker(t,e,n){return n.some(l=>l.toDOM)?null:new Fn(Vn(t,t.state.doc.lineAt(e.from).number))},widgetMarker:()=>null,lineMarkerChange:t=>t.startState.facet(xi)!=t.state.facet(xi),initialSpacer(t){return new Fn(Vn(t,Zp(t.state.doc.lines)))},updateSpacer(t,e){let n=Vn(e.view,Zp(e.view.state.doc.lines));return n==t.number?t:new Fn(n)},domEventHandlers:r.facet(xi).domEventHandlers}));function zP(r={}){return[xi.of(r),_P(),WP]}function Zp(r){let t=9;for(;t<r;)t=t*10+9;return t}const UP=1024;let qP=0;class Hn{constructor(t,e){this.from=t,this.to=e}}class ue{constructor(t={}){this.id=qP++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Ye.match(t)),e=>{let n=t(e);return n===void 0?null:[this,n]}}}ue.closedBy=new ue({deserialize:r=>r.split(" ")});ue.openedBy=new ue({deserialize:r=>r.split(" ")});ue.group=new ue({deserialize:r=>r.split(" ")});ue.contextHash=new ue({perNode:!0});ue.lookAhead=new ue({perNode:!0});ue.mounted=new ue({perNode:!0});const GP=Object.create(null);class Ye{constructor(t,e,n,l=0){this.name=t,this.props=e,this.id=n,this.flags=l}static define(t){let e=t.props&&t.props.length?Object.create(null):GP,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),l=new Ye(t.name||"",e,t.id,n);if(t.props){for(let a of t.props)if(Array.isArray(a)||(a=a(l)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[a[0].id]=a[1]}}return l}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(ue.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let n in t)for(let l of n.split(" "))e[l]=t[n];return n=>{for(let l=n.prop(ue.group),a=-1;a<(l?l.length:0);a++){let h=e[a<0?n.name:l[a]];if(h)return h}}}}Ye.none=new Ye("",Object.create(null),0,8);class Zl{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let n of this.types){let l=null;for(let a of t){let h=a(n);h&&(l||(l=Object.assign({},n.props)),l[h[0].id]=h[1])}e.push(l?new Ye(n.name,l,n.id,n.flags):n)}return new Zl(e)}}const zr=new WeakMap,Qp=new WeakMap;var Be;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(Be||(Be={}));class xe{constructor(t,e,n,l,a){if(this.type=t,this.children=e,this.positions=n,this.length=l,this.props=null,a&&a.length){this.props=Object.create(null);for(let[h,d]of a)this.props[typeof h=="number"?h:h.id]=d}}toString(){let t=this.prop(ue.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let n of this.children){let l=n.toString();l&&(e&&(e+=","),e+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new ws(this.topNode,t)}cursorAt(t,e=0,n=0){let l=zr.get(this)||this.topNode,a=new ws(l);return a.moveTo(t,e),zr.set(this,a._tree),a}get topNode(){return new Rt(this,0,0,null)}resolve(t,e=0){let n=Ei(zr.get(this)||this.topNode,t,e,!1);return zr.set(this,n),n}resolveInner(t,e=0){let n=Ei(Qp.get(this)||this.topNode,t,e,!0);return Qp.set(this,n),n}iterate(t){let{enter:e,leave:n,from:l=0,to:a=this.length}=t;for(let h=this.cursor((t.mode||0)|Be.IncludeAnonymous);;){let d=!1;if(h.from<=a&&h.to>=l&&(h.type.isAnonymous||e(h)!==!1)){if(h.firstChild())continue;d=!0}for(;d&&n&&!h.type.isAnonymous&&n(h),!h.nextSibling();){if(!h.parent())return;d=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:to(Ye.none,this.children,this.positions,0,this.children.length,0,this.length,(e,n,l)=>new xe(this.type,e,n,l,this.propValues),t.makeTree||((e,n,l)=>new xe(Ye.none,e,n,l)))}static build(t){return KP(t)}}xe.empty=new xe(Ye.none,[],[],0);class Ql{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ql(this.buffer,this.index)}}class oi{constructor(t,e,n){this.buffer=t,this.length=e,this.set=n}get type(){return Ye.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],n=this.buffer[t+3],l=this.set.types[e],a=l.name;if(/\W/.test(a)&&!l.isError&&(a=JSON.stringify(a)),t+=4,n==t)return a;let h=[];for(;t<n;)h.push(this.childString(t)),t=this.buffer[t+3];return a+"("+h.join(",")+")"}findChild(t,e,n,l,a){let{buffer:h}=this,d=-1;for(let p=t;p!=e&&!(Km(a,l,h[p+1],h[p+2])&&(d=p,n>0));p=h[p+3]);return d}slice(t,e,n){let l=this.buffer,a=new Uint16Array(e-t),h=0;for(let d=t,p=0;d<e;){a[p++]=l[d++],a[p++]=l[d++]-n;let g=a[p++]=l[d++]-n;a[p++]=l[d++]-t,h=Math.max(h,g)}return new oi(a,h,this.set)}}function Km(r,t,e,n){switch(r){case-2:return e<t;case-1:return n>=t&&e<t;case 0:return e<t&&n>t;case 1:return e<=t&&n>t;case 2:return n>t;case 4:return!0}}function Xm(r,t){let e=r.childBefore(t);for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(r=e,e=n.prevSibling):e=n}return r}function Ei(r,t,e,n){for(var l;r.from==r.to||(e<1?r.from>=t:r.from>t)||(e>-1?r.to<=t:r.to<t);){let h=!n&&r instanceof Rt&&r.index<0?null:r.parent;if(!h)return r;r=h}let a=n?0:Be.IgnoreOverlays;if(n)for(let h=r,d=h.parent;d;h=d,d=h.parent)h instanceof Rt&&h.index<0&&((l=d.enter(t,e,a))===null||l===void 0?void 0:l.from)!=h.from&&(r=d);for(;;){let h=r.enter(t,e,a);if(!h)return r;r=h}}class Rt{constructor(t,e,n,l){this._tree=t,this.from=e,this.index=n,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,n,l,a=0){for(let h=this;;){for(let{children:d,positions:p}=h._tree,g=e>0?d.length:-1;t!=g;t+=e){let m=d[t],y=p[t]+h.from;if(Km(l,n,y,y+m.length)){if(m instanceof oi){if(a&Be.ExcludeBuffers)continue;let b=m.findChild(0,m.buffer.length,e,n-y,l);if(b>-1)return new Vt(new jP(h,m,t,y),null,b)}else if(a&Be.IncludeAnonymous||!m.type.isAnonymous||eo(m)){let b;if(!(a&Be.IgnoreMounts)&&m.props&&(b=m.prop(ue.mounted))&&!b.overlay)return new Rt(b.tree,y,t,h);let k=new Rt(m,y,t,h);return a&Be.IncludeAnonymous||!k.type.isAnonymous?k:k.nextChild(e<0?m.children.length-1:0,e,n,l)}}}if(a&Be.IncludeAnonymous||!h.type.isAnonymous||(h.index>=0?t=h.index+e:t=e<0?-1:h._parent._tree.children.length,h=h._parent,!h))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,n=0){let l;if(!(n&Be.IgnoreOverlays)&&(l=this._tree.prop(ue.mounted))&&l.overlay){let a=t-this.from;for(let{from:h,to:d}of l.overlay)if((e>0?h<=a:h<a)&&(e<0?d>=a:d>a))return new Rt(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new ws(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return Ei(this,t,e,!1)}resolveInner(t,e=0){return Ei(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Xm(this,t)}getChild(t,e=null,n=null){let l=xs(this,t,e,n);return l.length?l[0]:null}getChildren(t,e=null,n=null){return xs(this,t,e,n)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return bs(this,t)}}function xs(r,t,e,n){let l=r.cursor(),a=[];if(!l.firstChild())return a;if(e!=null){for(;!l.type.is(e);)if(!l.nextSibling())return a}for(;;){if(n!=null&&l.type.is(n))return a;if(l.type.is(t)&&a.push(l.node),!l.nextSibling())return n==null?a:[]}}function bs(r,t,e=t.length-1){for(let n=r.parent;e>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[e]&&t[e]!=n.name)return!1;e--}}return!0}class jP{constructor(t,e,n,l){this.parent=t,this.buffer=e,this.index=n,this.start=l}}class Vt{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,n){this.context=t,this._parent=e,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,e,n){let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],t,e-this.context.start,n);return a<0?null:new Vt(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,n=0){if(n&Be.ExcludeBuffers)return null;let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return a<0?null:new Vt(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Vt(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new Vt(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new ws(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:n}=this.context,l=this.index+4,a=n.buffer[this.index+3];if(a>l){let h=n.buffer[this.index+1];t.push(n.slice(l,a,h)),e.push(0)}return new xe(this.type,t,e,this.to-this.from)}resolve(t,e=0){return Ei(this,t,e,!1)}resolveInner(t,e=0){return Ei(this,t,e,!0)}enterUnfinishedNodesBefore(t){return Xm(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,n=null){let l=xs(this,t,e,n);return l.length?l[0]:null}getChildren(t,e=null,n=null){return xs(this,t,e,n)}get node(){return this}matchContext(t){return bs(this,t)}}class ws{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Rt)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let n=t._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:n,buffer:l}=this.buffer;return this.type=e||l.set.types[l.buffer[t]],this.from=n+l.buffer[t+1],this.to=n+l.buffer[t+2],!0}yield(t){return t?t instanceof Rt?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,n,this.mode));let{buffer:l}=this.buffer,a=l.findChild(this.index+4,l.buffer[this.index+3],t,e-this.buffer.start,n);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,n=this.mode){return this.buffer?n&Be.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Be.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Be.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,n=this.stack.length-1;if(t<0){let l=n<0?0:this.stack[n]+4;if(this.index!=l)return this.yieldBuf(e.findChild(l,this.index,-1,0,4))}else{let l=e.buffer[this.index+3];if(l<(n<0?e.buffer.length:e.buffer[this.stack[n]+3]))return this.yieldBuf(l)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,n,{buffer:l}=this;if(l){if(t>0){if(this.index<l.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(l.buffer.buffer[a+3]<this.index)return!1;({index:e,parent:n}=l)}else({index:e,_parent:n}=this._tree);for(;n;{index:e,_parent:n}=n)if(e>-1)for(let a=e+t,h=t<0?-1:n._tree.children.length;a!=h;a+=t){let d=n._tree.children[a];if(this.mode&Be.IncludeAnonymous||d instanceof oi||!d.type.isAnonymous||eo(d))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,n=0;if(t&&t.context==this.buffer){e:for(let l=this.index,a=this.stack.length;a>=0;){for(let h=t;h;h=h._parent)if(h.index==l){if(l==this.index)return h;e=h,n=a+1;break e}l=this.stack[--a]}}for(let l=n;l<this.stack.length;l++)e=new Vt(this.buffer,e,this.stack[l]);return this.bufferNode=new Vt(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let n=0;;){let l=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(l=!0)}for(;l&&e&&e(this),l=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,l=!0}}}matchContext(t){if(!this.buffer)return bs(this.node,t);let{buffer:e}=this.buffer,{types:n}=e.set;for(let l=t.length-1,a=this.stack.length-1;l>=0;a--){if(a<0)return bs(this.node,t,l);let h=n[e.buffer[this.stack[a]]];if(!h.isAnonymous){if(t[l]&&t[l]!=h.name)return!1;l--}}return!0}}function eo(r){return r.children.some(t=>t instanceof oi||!t.type.isAnonymous||eo(t))}function KP(r){var t;let{buffer:e,nodeSet:n,maxBufferLength:l=UP,reused:a=[],minRepeatType:h=n.types.length}=r,d=Array.isArray(e)?new Ql(e,e.length):e,p=n.types,g=0,m=0;function y(N,H,W,Z,re){let{id:X,start:J,end:ie,size:me}=d,ke=m;for(;me<0;)if(d.next(),me==-1){let ot=a[X];W.push(ot),Z.push(J-N);return}else if(me==-3){g=X;return}else if(me==-4){m=X;return}else throw new RangeError(`Unrecognized record size: ${me}`);let We=p[X],De,it,Bi=J-N;if(ie-J<=l&&(it=O(d.pos-H,re))){let ot=new Uint16Array(it.size-it.skip),Ge=d.pos-it.size,rt=ot.length;for(;d.pos>Ge;)rt=M(it.start,ot,rt);De=new oi(ot,ie-it.start,n),Bi=it.start-N}else{let ot=d.pos-me;d.next();let Ge=[],rt=[],ct=X>=h?X:-1,Pt=0,Xt=ie;for(;d.pos>ot;)ct>=0&&d.id==ct&&d.size>=0?(d.end<=Xt-l&&(k(Ge,rt,J,Pt,d.end,Xt,ct,ke),Pt=Ge.length,Xt=d.end),d.next()):y(J,ot,Ge,rt,ct);if(ct>=0&&Pt>0&&Pt<Ge.length&&k(Ge,rt,J,Pt,J,Xt,ct,ke),Ge.reverse(),rt.reverse(),ct>-1&&Pt>0){let Fi=b(We);De=to(We,Ge,rt,0,Ge.length,0,ie-J,Fi,Fi)}else De=C(We,Ge,rt,ie-J,ke-ie)}W.push(De),Z.push(Bi)}function b(N){return(H,W,Z)=>{let re=0,X=H.length-1,J,ie;if(X>=0&&(J=H[X])instanceof xe){if(!X&&J.type==N&&J.length==Z)return J;(ie=J.prop(ue.lookAhead))&&(re=W[X]+J.length+ie)}return C(N,H,W,Z,re)}}function k(N,H,W,Z,re,X,J,ie){let me=[],ke=[];for(;N.length>Z;)me.push(N.pop()),ke.push(H.pop()+W-re);N.push(C(n.types[J],me,ke,X-re,ie-X)),H.push(re-W)}function C(N,H,W,Z,re=0,X){if(g){let J=[ue.contextHash,g];X=X?[J].concat(X):[J]}if(re>25){let J=[ue.lookAhead,re];X=X?[J].concat(X):[J]}return new xe(N,H,W,Z,X)}function O(N,H){let W=d.fork(),Z=0,re=0,X=0,J=W.end-l,ie={size:0,start:0,skip:0};e:for(let me=W.pos-N;W.pos>me;){let ke=W.size;if(W.id==H&&ke>=0){ie.size=Z,ie.start=re,ie.skip=X,X+=4,Z+=4,W.next();continue}let We=W.pos-ke;if(ke<0||We<me||W.start<J)break;let De=W.id>=h?4:0,it=W.start;for(W.next();W.pos>We;){if(W.size<0)if(W.size==-3)De+=4;else break e;else W.id>=h&&(De+=4);W.next()}re=it,Z+=ke,X+=De}return(H<0||Z==N)&&(ie.size=Z,ie.start=re,ie.skip=X),ie.size>4?ie:void 0}function M(N,H,W){let{id:Z,start:re,end:X,size:J}=d;if(d.next(),J>=0&&Z<h){let ie=W;if(J>4){let me=d.pos-(J-4);for(;d.pos>me;)W=M(N,H,W)}H[--W]=ie,H[--W]=X-N,H[--W]=re-N,H[--W]=Z}else J==-3?g=Z:J==-4&&(m=Z);return W}let I=[],L=[];for(;d.pos>0;)y(r.start||0,r.bufferStart||0,I,L,-1);let F=(t=r.length)!==null&&t!==void 0?t:I.length?L[0]+I[0].length:0;return new xe(p[r.topID],I.reverse(),L.reverse(),F)}const eg=new WeakMap;function ts(r,t){if(!r.isAnonymous||t instanceof oi||t.type!=r)return 1;let e=eg.get(t);if(e==null){e=1;for(let n of t.children){if(n.type!=r||!(n instanceof xe)){e=1;break}e+=ts(r,n)}eg.set(t,e)}return e}function to(r,t,e,n,l,a,h,d,p){let g=0;for(let C=n;C<l;C++)g+=ts(r,t[C]);let m=Math.ceil(g*1.5/8),y=[],b=[];function k(C,O,M,I,L){for(let F=M;F<I;){let N=F,H=O[F],W=ts(r,C[F]);for(F++;F<I;F++){let Z=ts(r,C[F]);if(W+Z>=m)break;W+=Z}if(F==N+1){if(W>m){let Z=C[N];k(Z.children,Z.positions,0,Z.children.length,O[N]+L);continue}y.push(C[N])}else{let Z=O[F-1]+C[F-1].length-H;y.push(to(r,C,O,N,F,H,Z,null,p))}b.push(H+L-a)}}return k(t,e,n,l,0),(d||p)(y,b,h)}class ti{constructor(t,e,n,l,a=!1,h=!1){this.from=t,this.to=e,this.tree=n,this.offset=l,this.open=(a?1:0)|(h?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],n=!1){let l=[new ti(0,t.length,t,0,!1,n)];for(let a of e)a.to>t.length&&l.push(a);return l}static applyChanges(t,e,n=128){if(!e.length)return t;let l=[],a=1,h=t.length?t[0]:null;for(let d=0,p=0,g=0;;d++){let m=d<e.length?e[d]:null,y=m?m.fromA:1e9;if(y-p>=n)for(;h&&h.from<y;){let b=h;if(p>=b.from||y<=b.to||g){let k=Math.max(b.from,p)-g,C=Math.min(b.to,y)-g;b=k>=C?null:new ti(k,C,b.tree,b.offset+g,d>0,!!m)}if(b&&l.push(b),h.to>y)break;h=a<t.length?t[a++]:null}if(!m)break;p=m.toA,g=m.toA-m.toB}return l}}class Ym{startParse(t,e,n){return typeof t=="string"&&(t=new XP(t)),n=n?n.length?n.map(l=>new Hn(l.from,l.to)):[new Hn(0,0)]:[new Hn(0,t.length)],this.createParse(t,e||[],n)}parse(t,e,n){let l=this.startParse(t,e,n);for(;;){let a=l.advance();if(a)return a}}}class XP{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new ue({perNode:!0});let YP=0;class et{constructor(t,e,n){this.set=t,this.base=e,this.modified=n,this.id=YP++}static define(t){if(t!=null&&t.base)throw new Error("Can not derive from a modified tag");let e=new et([],null,[]);if(e.set.push(e),t)for(let n of t.set)e.set.push(n);return e}static defineModifier(){let t=new ks;return e=>e.modified.indexOf(t)>-1?e:ks.get(e.base||e,e.modified.concat(t).sort((n,l)=>n.id-l.id))}}let JP=0;class ks{constructor(){this.instances=[],this.id=JP++}static get(t,e){if(!e.length)return t;let n=e[0].instances.find(d=>d.base==t&&ZP(e,d.modified));if(n)return n;let l=[],a=new et(l,t,e);for(let d of e)d.instances.push(a);let h=QP(e);for(let d of t.set)if(!d.modified.length)for(let p of h)l.push(ks.get(d,p));return a}}function ZP(r,t){return r.length==t.length&&r.every((e,n)=>e==t[n])}function QP(r){let t=[[]];for(let e=0;e<r.length;e++)for(let n=0,l=t.length;n<l;n++)t.push(t[n].concat(r[e]));return t.sort((e,n)=>n.length-e.length)}function e$(r){let t=Object.create(null);for(let e in r){let n=r[e];Array.isArray(n)||(n=[n]);for(let l of e.split(" "))if(l){let a=[],h=2,d=l;for(let y=0;;){if(d=="..."&&y>0&&y+3==l.length){h=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!b)throw new RangeError("Invalid path: "+l);if(a.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),y+=b[0].length,y==l.length)break;let k=l[y++];if(y==l.length&&k=="!"){h=0;break}if(k!="/")throw new RangeError("Invalid path: "+l);d=l.slice(y)}let p=a.length-1,g=a[p];if(!g)throw new RangeError("Invalid path: "+l);let m=new Ss(n,h,p>0?a.slice(0,p):null);t[g]=m.sort(t[g])}}return Jm.add(t)}const Jm=new ue;class Ss{constructor(t,e,n,l){this.tags=t,this.mode=e,this.context=n,this.next=l}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Ss.empty=new Ss([],2,null);function Zm(r,t){let e=Object.create(null);for(let a of r)if(!Array.isArray(a.tag))e[a.tag.id]=a.class;else for(let h of a.tag)e[h.id]=a.class;let{scope:n,all:l=null}=t||{};return{style:a=>{let h=l;for(let d of a)for(let p of d.set){let g=e[p.id];if(g){h=h?h+" "+g:g;break}}return h},scope:n}}function t$(r,t){let e=null;for(let n of r){let l=n.style(t);l&&(e=e?e+" "+l:l)}return e}function i$(r,t,e,n=0,l=r.length){let a=new r$(n,Array.isArray(t)?t:[t],e);a.highlightRange(r.cursor(),n,l,"",a.highlighters),a.flush(l)}class r${constructor(t,e,n){this.at=t,this.highlighters=e,this.span=n,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,n,l,a){let{type:h,from:d,to:p}=t;if(d>=n||p<=e)return;h.isTop&&(a=this.highlighters.filter(k=>!k.scope||k.scope(h)));let g=l,m=s$(t)||Ss.empty,y=t$(a,m.tags);if(y&&(g&&(g+=" "),g+=y,m.mode==1&&(l+=(l?" ":"")+y)),this.startSpan(t.from,g),m.opaque)return;let b=t.tree&&t.tree.prop(ue.mounted);if(b&&b.overlay){let k=t.node.enter(b.overlay[0].from+d,1),C=this.highlighters.filter(M=>!M.scope||M.scope(b.tree.type)),O=t.firstChild();for(let M=0,I=d;;M++){let L=M<b.overlay.length?b.overlay[M]:null,F=L?L.from+d:p,N=Math.max(e,I),H=Math.min(n,F);if(N<H&&O)for(;t.from<H&&(this.highlightRange(t,N,H,l,a),this.startSpan(Math.min(H,t.to),g),!(t.to>=F||!t.nextSibling())););if(!L||F>n)break;I=L.to+d,I>e&&(this.highlightRange(k.cursor(),Math.max(e,L.from+d),Math.min(n,I),l,C),this.startSpan(I,g))}O&&t.parent()}else if(t.firstChild()){do if(!(t.to<=e)){if(t.from>=n)break;this.highlightRange(t,e,n,l,a),this.startSpan(Math.min(n,t.to),g)}while(t.nextSibling());t.parent()}}}function s$(r){let t=r.type.prop(Jm);for(;t&&t.context&&!r.matchContext(t.context);)t=t.next;return t||null}const B=et.define,Ur=B(),Nt=B(),tg=B(Nt),ig=B(Nt),Lt=B(),qr=B(Lt),Wn=B(Lt),vt=B(),Yt=B(vt),gt=B(),mt=B(),Dl=B(),Yi=B(Dl),Gr=B(),_={comment:Ur,lineComment:B(Ur),blockComment:B(Ur),docComment:B(Ur),name:Nt,variableName:B(Nt),typeName:tg,tagName:B(tg),propertyName:ig,attributeName:B(ig),className:B(Nt),labelName:B(Nt),namespace:B(Nt),macroName:B(Nt),literal:Lt,string:qr,docString:B(qr),character:B(qr),attributeValue:B(qr),number:Wn,integer:B(Wn),float:B(Wn),bool:B(Lt),regexp:B(Lt),escape:B(Lt),color:B(Lt),url:B(Lt),keyword:gt,self:B(gt),null:B(gt),atom:B(gt),unit:B(gt),modifier:B(gt),operatorKeyword:B(gt),controlKeyword:B(gt),definitionKeyword:B(gt),moduleKeyword:B(gt),operator:mt,derefOperator:B(mt),arithmeticOperator:B(mt),logicOperator:B(mt),bitwiseOperator:B(mt),compareOperator:B(mt),updateOperator:B(mt),definitionOperator:B(mt),typeOperator:B(mt),controlOperator:B(mt),punctuation:Dl,separator:B(Dl),bracket:Yi,angleBracket:B(Yi),squareBracket:B(Yi),paren:B(Yi),brace:B(Yi),content:vt,heading:Yt,heading1:B(Yt),heading2:B(Yt),heading3:B(Yt),heading4:B(Yt),heading5:B(Yt),heading6:B(Yt),contentSeparator:B(vt),list:B(vt),quote:B(vt),emphasis:B(vt),strong:B(vt),link:B(vt),monospace:B(vt),strikethrough:B(vt),inserted:B(),deleted:B(),changed:B(),invalid:B(),meta:Gr,documentMeta:B(Gr),annotation:B(Gr),processingInstruction:B(Gr),definition:et.defineModifier(),constant:et.defineModifier(),function:et.defineModifier(),standard:et.defineModifier(),local:et.defineModifier(),special:et.defineModifier()};Zm([{tag:_.link,class:"tok-link"},{tag:_.heading,class:"tok-heading"},{tag:_.emphasis,class:"tok-emphasis"},{tag:_.strong,class:"tok-strong"},{tag:_.keyword,class:"tok-keyword"},{tag:_.atom,class:"tok-atom"},{tag:_.bool,class:"tok-bool"},{tag:_.url,class:"tok-url"},{tag:_.labelName,class:"tok-labelName"},{tag:_.inserted,class:"tok-inserted"},{tag:_.deleted,class:"tok-deleted"},{tag:_.literal,class:"tok-literal"},{tag:_.string,class:"tok-string"},{tag:_.number,class:"tok-number"},{tag:[_.regexp,_.escape,_.special(_.string)],class:"tok-string2"},{tag:_.variableName,class:"tok-variableName"},{tag:_.local(_.variableName),class:"tok-variableName tok-local"},{tag:_.definition(_.variableName),class:"tok-variableName tok-definition"},{tag:_.special(_.variableName),class:"tok-variableName2"},{tag:_.definition(_.propertyName),class:"tok-propertyName tok-definition"},{tag:_.typeName,class:"tok-typeName"},{tag:_.namespace,class:"tok-namespace"},{tag:_.className,class:"tok-className"},{tag:_.macroName,class:"tok-macroName"},{tag:_.propertyName,class:"tok-propertyName"},{tag:_.operator,class:"tok-operator"},{tag:_.comment,class:"tok-comment"},{tag:_.meta,class:"tok-meta"},{tag:_.invalid,class:"tok-invalid"},{tag:_.punctuation,class:"tok-punctuation"}]);var zn;const bi=new ue;function n$(r){return K.define({combine:r?t=>t.concat(r):void 0})}const l$=new ue;class ft{constructor(t,e,n=[],l=""){this.data=t,this.name=l,se.prototype.hasOwnProperty("tree")||Object.defineProperty(se.prototype,"tree",{get(){return Ri(this)}}),this.parser=e,this.extension=[Ni.of(this),se.languageData.of((a,h,d)=>{let p=rg(a,h,d),g=p.type.prop(bi);if(!g)return[];let m=a.facet(g),y=p.type.prop(l$);if(y){let b=p.resolve(h-p.from,d);for(let k of y)if(k.test(b,a)){let C=a.facet(k.facet);return k.type=="replace"?C:C.concat(m)}}return m})].concat(n)}isActiveAt(t,e,n=-1){return rg(t,e,n).type.prop(bi)==this.data}findRegions(t){let e=t.facet(Ni);if((e==null?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let n=[],l=(a,h)=>{if(a.prop(bi)==this.data){n.push({from:h,to:h+a.length});return}let d=a.prop(ue.mounted);if(d){if(d.tree.prop(bi)==this.data){if(d.overlay)for(let p of d.overlay)n.push({from:p.from+h,to:p.to+h});else n.push({from:h,to:h+a.length});return}else if(d.overlay){let p=n.length;if(l(d.tree,d.overlay[0].from+h),n.length>p)return}}for(let p=0;p<a.children.length;p++){let g=a.children[p];g instanceof xe&&l(g,a.positions[p]+h)}};return l(Ri(t),0),n}get allowsNesting(){return!0}}ft.setState=de.define();function rg(r,t,e){let n=r.facet(Ni),l=Ri(r).topNode;if(!n||n.allowsNesting)for(let a=l;a;a=a.enter(t,e,Be.ExcludeBuffers))a.type.isTop&&(l=a);return l}function Ri(r){let t=r.field(ft.state,!1);return t?t.tree:xe.empty}class o${constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let n=this.cursorPos-this.string.length;return t<n||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-n,e-n)}}let Ji=null;class Oi{constructor(t,e,n=[],l,a,h,d,p){this.parser=t,this.state=e,this.fragments=n,this.tree=l,this.treeLen=a,this.viewport=h,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(t,e,n){return new Oi(t,e,[],xe.empty,0,n,[],null)}startParse(){return this.parser.startParse(new o$(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=xe.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof t=="number"){let l=Date.now()+t;t=()=>Date.now()>l}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let l=this.parse.advance();if(l)if(this.fragments=this.withoutTempSkipped(ti.addTree(l,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=l,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(ti.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Ji;Ji=this;try{return t()}finally{Ji=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=sg(t,e.from,e.to);return t}changes(t,e){let{fragments:n,tree:l,treeLen:a,viewport:h,skipped:d}=this;if(this.takeTree(),!t.empty){let p=[];if(t.iterChangedRanges((g,m,y,b)=>p.push({fromA:g,toA:m,fromB:y,toB:b})),n=ti.applyChanges(n,p),l=xe.empty,a=0,h={from:t.mapPos(h.from,-1),to:t.mapPos(h.to,1)},this.skipped.length){d=[];for(let g of this.skipped){let m=t.mapPos(g.from,1),y=t.mapPos(g.to,-1);m<y&&d.push({from:m,to:y})}}}return new Oi(this.parser,e,n,l,a,h,d,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:l,to:a}=this.skipped[n];l<t.to&&a>t.from&&(this.fragments=sg(this.fragments,l,a),this.skipped.splice(n--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Ym{createParse(e,n,l){let a=l[0].from,h=l[l.length-1].to;return{parsedPos:a,advance(){let p=Ji;if(p){for(let g of l)p.tempSkipped.push(g);t&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,t]):t)}return this.parsedPos=h,new xe(Ye.none,[],[],h-a)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Ji}}function sg(r,t,e){return ti.applyChanges(r,[{fromA:t,toA:e,fromB:t,toB:e}])}class Ii{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,n)||e.takeTree(),new Ii(e)}static init(t){let e=Math.min(3e3,t.doc.length),n=Oi.create(t.facet(Ni).parser,t,{from:0,to:e});return n.work(20,e)||n.takeTree(),new Ii(n)}}ft.state=At.define({create:Ii.init,update(r,t){for(let e of t.effects)if(e.is(ft.setState))return e.value;return t.startState.facet(Ni)!=t.state.facet(Ni)?Ii.init(t.state):r.apply(t)}});let Qm=r=>{let t=setTimeout(()=>r(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Qm=r=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(r,{timeout:500-100})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const Un=typeof navigator<"u"&&(!((zn=navigator.scheduling)===null||zn===void 0)&&zn.isInputPending)?()=>navigator.scheduling.isInputPending():null,a$=St.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(ft.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(ft.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=Qm(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:l}}=this.view,a=n.field(ft.state);if(a.tree==a.context.tree&&a.context.isDone(l+1e5))return;let h=Date.now()+Math.min(this.chunkBudget,100,t&&!Un?Math.max(25,t.timeRemaining()-5):1e9),d=a.context.treeLen<l&&n.doc.length>l+1e3,p=a.context.work(()=>Un&&Un()||Date.now()>h,l+(d?0:1e5));this.chunkBudget-=Date.now()-e,(p||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:ft.setState.of(new Ii(a.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Et(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ni=K.define({combine(r){return r.length?r[0]:null},enables:r=>[ft.state,a$,Q.contentAttributes.compute([r],t=>{let e=t.facet(r);return e&&e.name?{"data-language":e.name}:{}})]}),f$=K.define(),io=K.define({combine:r=>{if(!r.length)return"  ";let t=r[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return t}});function As(r){let t=r.facet(io);return t.charCodeAt(0)==9?r.tabSize*t.length:t.length}function u$(r,t){let e="",n=r.tabSize,l=r.facet(io)[0];if(l=="	"){for(;t>=n;)e+="	",t-=n;l=" "}for(let a=0;a<t;a++)e+=l;return e}class mr{constructor(t,e){this.specs=t;let n;function l(d){let p=Wt.newName();return(n||(n=Object.create(null)))["."+p]=d,p}const a=typeof e.all=="string"?e.all:e.all?l(e.all):void 0,h=e.scope;this.scope=h instanceof ft?d=>d.prop(bi)==h.data:h?d=>d==h:void 0,this.style=Zm(t.map(d=>({tag:d.tag,class:d.class||l(Object.assign({},d,{tag:null}))})),{all:a}).style,this.module=n?new Wt(n):null,this.themeType=e.themeType}static define(t,e){return new mr(t,e||{})}}const El=K.define(),e0=K.define({combine(r){return r.length?[r[0]]:null}});function qn(r){let t=r.facet(El);return t.length?t:r.facet(e0)}function h$(r,t){let e=[d$],n;return r instanceof mr&&(r.module&&e.push(Q.styleModule.of(r.module)),n=r.themeType),t!=null&&t.fallback?e.push(e0.of(r)):n?e.push(El.computeN([Q.darkTheme],l=>l.facet(Q.darkTheme)==(n=="dark")?[r]:[])):e.push(El.of(r)),e}class c${constructor(t){this.markCache=Object.create(null),this.tree=Ri(t.state),this.decorations=this.buildDeco(t,qn(t.state))}update(t){let e=Ri(t.state),n=qn(t.state),l=n!=qn(t.startState);e.length<t.view.viewport.to&&!l&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||l)&&(this.tree=e,this.decorations=this.buildDeco(t.view,n))}buildDeco(t,e){if(!e||!this.tree.length)return fe.none;let n=new or;for(let{from:l,to:a}of t.visibleRanges)i$(this.tree,e,(h,d,p)=>{n.add(h,d,this.markCache[p]||(this.markCache[p]=fe.mark({class:p})))},l,a);return n.finish()}}const d$=Hl.high(St.fromClass(c$,{decorations:r=>r.decorations}));_.meta,_.link,_.heading,_.emphasis,_.strong,_.strikethrough,_.keyword,_.atom,_.bool,_.url,_.contentSeparator,_.labelName,_.literal,_.inserted,_.string,_.deleted,_.regexp,_.escape,_.string,_.variableName,_.variableName,_.typeName,_.namespace,_.className,_.variableName,_.macroName,_.propertyName,_.comment,_.invalid;function ng(r,t,e,n=0,l=0){t==null&&(t=r.search(/[^\s\u00a0]/),t==-1&&(t=r.length));let a=l;for(let h=n;h<t;h++)r.charCodeAt(h)==9?a+=e-a%e:a++;return a}class t0{constructor(t,e,n,l){this.string=t,this.tabSize=e,this.indentUnit=n,this.overrideIndent=l,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e=this.string.charAt(this.pos),n;if(typeof t=="string"?n=e==t:n=e&&(t instanceof RegExp?t.test(e):t(e)),n)return++this.pos,e}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ng(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var t;return(t=this.overrideIndent)!==null&&t!==void 0?t:ng(this.string,null,this.tabSize)}match(t,e,n){if(typeof t=="string"){let l=h=>n?h.toLowerCase():h,a=this.string.substr(this.pos,t.length);return l(a)==l(t)?(e!==!1&&(this.pos+=t.length),!0):null}else{let l=this.string.slice(this.pos).match(t);return l&&l.index>0?null:(l&&e!==!1&&(this.pos+=l[0].length),l)}}current(){return this.string.slice(this.start,this.pos)}}function p$(r){return{name:r.name||"",token:r.token,blankLine:r.blankLine||(()=>{}),startState:r.startState||(()=>!0),copyState:r.copyState||g$,indent:r.indent||(()=>null),languageData:r.languageData||{},tokenTable:r.tokenTable||no}}function g$(r){if(typeof r!="object")return r;let t={};for(let e in r){let n=r[e];t[e]=n instanceof Array?n.slice():n}return t}const lg=new WeakMap;class ro extends ft{constructor(t){let e=n$(t.languageData),n=p$(t),l,a=new class extends Ym{createParse(h,d,p){return new v$(l,h,d,p)}};super(e,a,[f$.of((h,d)=>this.getIndent(h,d))],t.name),this.topNode=b$(e),l=this,this.streamParser=n,this.stateAfter=new ue({perNode:!0}),this.tokenTable=t.tokenTable?new n0(n.tokenTable):x$}static define(t){return new ro(t)}getIndent(t,e){let n=Ri(t.state),l=n.resolve(e);for(;l&&l.type!=this.topNode;)l=l.parent;if(!l)return null;let a,{overrideIndentation:h}=t.options;h&&(a=lg.get(t.state),a!=null&&a<e-1e4&&(a=void 0));let d=so(this,n,0,l.from,a??e),p,g;if(d?(g=d.state,p=d.pos+1):(g=this.streamParser.startState(t.unit),p=0),e-p>1e4)return null;for(;p<e;){let y=t.state.doc.lineAt(p),b=Math.min(e,y.to);if(y.length){let k=h?h(y.from):-1,C=new t0(y.text,t.state.tabSize,t.unit,k<0?void 0:k);for(;C.pos<b-y.from;)r0(this.streamParser.token,C,g)}else this.streamParser.blankLine(g,t.unit);if(b==e)break;p=y.to+1}let m=t.lineAt(e);return h&&a==null&&lg.set(t.state,m.from),this.streamParser.indent(g,/^\s*(.*)/.exec(m.text)[1],t)}get allowsNesting(){return!1}}function so(r,t,e,n,l){let a=e>=n&&e+t.length<=l&&t.prop(r.stateAfter);if(a)return{state:r.streamParser.copyState(a),pos:e+t.length};for(let h=t.children.length-1;h>=0;h--){let d=t.children[h],p=e+t.positions[h],g=d instanceof xe&&p<l&&so(r,d,p,n,l);if(g)return g}return null}function i0(r,t,e,n,l){if(l&&e<=0&&n>=t.length)return t;!l&&t.type==r.topNode&&(l=!0);for(let a=t.children.length-1;a>=0;a--){let h=t.positions[a],d=t.children[a],p;if(h<n&&d instanceof xe){if(!(p=i0(r,d,e-h,n-h,l)))break;return l?new xe(t.type,t.children.slice(0,a).concat(p),t.positions.slice(0,a+1),h+p.length):p}}return null}function m$(r,t,e,n){for(let l of t){let a=l.from+(l.openStart?25:0),h=l.to-(l.openEnd?25:0),d=a<=e&&h>e&&so(r,l.tree,0-l.offset,e,h),p;if(d&&(p=i0(r,l.tree,e+l.offset,d.pos+l.offset,!1)))return{state:d.state,tree:p}}return{state:r.streamParser.startState(n?As(n):4),tree:xe.empty}}class v${constructor(t,e,n,l){this.lang=t,this.input=e,this.fragments=n,this.ranges=l,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=l[l.length-1].to;let a=Oi.get(),h=l[0].from,{state:d,tree:p}=m$(t,n,h,a==null?void 0:a.state);this.state=d,this.parsedPos=this.chunkStart=h+p.length;for(let g=0;g<p.children.length;g++)this.chunks.push(p.children[g]),this.chunkPos.push(p.positions[g]);a&&this.parsedPos<a.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(As(a.state)),a.skipUntilInView(this.parsedPos,a.viewport.from),this.parsedPos=a.viewport.from),this.moveRangeIndex()}advance(){let t=Oi.get(),e=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(e,this.chunkStart+2048);for(t&&(n=Math.min(n,t.viewport.to));this.parsedPos<n;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)e==`
`&&(e="");else{let n=e.indexOf(`
`);n>-1&&(e=e.slice(0,n))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),n=t+e.length;for(let l=this.rangeIndex;;){let a=this.ranges[l].to;if(a>=n||(e=e.slice(0,a-(n-e.length)),l++,l==this.ranges.length))break;let h=this.ranges[l].from,d=this.lineAfter(h);e+=d,n=h+d.length}return{line:e,end:n}}skipGapsTo(t,e,n){for(;;){let l=this.ranges[this.rangeIndex].to,a=t+e;if(n>0?l>a:l>=a)break;let h=this.ranges[++this.rangeIndex].from;e+=h-l}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,n,l,a){if(this.ranges.length>1){a=this.skipGapsTo(e,a,1),e+=a;let h=this.chunk.length;a=this.skipGapsTo(n,a,-1),n+=a,l+=this.chunk.length-h}return this.chunk.push(t,e,n,l),a}parseLine(t){let{line:e,end:n}=this.nextLine(),l=0,{streamParser:a}=this.lang,h=new t0(e,t?t.state.tabSize:4,t?As(t.state):2);if(h.eol())a.blankLine(this.state,h.indentUnit);else for(;!h.eol();){let d=r0(a.token,h,this.state);if(d&&(l=this.emitToken(this.lang.tokenTable.resolve(d),this.parsedPos+h.start,this.parsedPos+h.pos,4,l)),h.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=xe.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:y$,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new xe(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new xe(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function r0(r,t,e){t.start=t.pos;for(let n=0;n<10;n++){let l=r(t,e);if(t.pos>t.start)return l}throw new Error("Stream parser failed to advance stream.")}const no=Object.create(null),cr=[Ye.none],y$=new Zl(cr),og=[],s0=Object.create(null);for(let[r,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])s0[r]=l0(no,t);class n0{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),s0)}resolve(t){return t?this.table[t]||(this.table[t]=l0(this.extra,t)):0}}const x$=new n0(no);function Gn(r,t){og.indexOf(r)>-1||(og.push(r),console.warn(t))}function l0(r,t){let e=null;for(let a of t.split(".")){let h=r[a]||_[a];h?typeof h=="function"?e?e=h(e):Gn(a,`Modifier ${a} used at start of tag`):e?Gn(a,`Tag ${a} used as modifier`):e=h:Gn(a,`Unknown highlighting tag ${a}`)}if(!e)return 0;let n=t.replace(/ /g,"_"),l=Ye.define({id:cr.length,name:n,props:[e$({[n]:e})]});return cr.push(l),l.id}function b$(r){let t=Ye.define({id:cr.length,name:"Document",props:[bi.add(()=>r)]});return cr.push(t),t}const Rl=jt.define(),w$=jt.define(),k$=K.define(),o0=K.define({combine(r){return Wl(r,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(n,l)=>t(n,l)||e(n,l)})}});function S$(r){let t=0;return r.iterChangedRanges((e,n)=>t=n),t}const a0=At.define({create(){return bt.empty},update(r,t){let e=t.state.facet(o0),n=t.annotation(Rl);if(n){let p=t.docChanged?q.single(S$(t.changes)):void 0,g=Xe.fromTransaction(t,p),m=n.side,y=m==0?r.undone:r.done;return g?y=Ps(y,y.length,e.minDepth,g):y=h0(y,t.startState.selection),new bt(m==0?n.rest:y,m==0?y:n.rest)}let l=t.annotation(w$);if((l=="full"||l=="before")&&(r=r.isolate()),t.annotation(Ce.addToHistory)===!1)return t.changes.empty?r:r.addMapping(t.changes.desc);let a=Xe.fromTransaction(t),h=t.annotation(Ce.time),d=t.annotation(Ce.userEvent);return a?r=r.addChanges(a,h,d,e,t):t.selection&&(r=r.addSelection(t.startState.selection,h,d,e.newGroupDelay)),(l=="full"||l=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(t=>t.toJSON()),undone:r.undone.map(t=>t.toJSON())}},fromJSON(r){return new bt(r.done.map(Xe.fromJSON),r.undone.map(Xe.fromJSON))}});function A$(r={}){return[a0,o0.of(r),Q.domEventHandlers({beforeinput(t,e){let n=t.inputType=="historyUndo"?P$:t.inputType=="historyRedo"?$$:null;return n?(t.preventDefault(),n(e)):!1}})]}function f0(r,t){return function({state:e,dispatch:n}){if(!t&&e.readOnly)return!1;let l=e.field(a0,!1);if(!l)return!1;let a=l.pop(r,e,t);return a?(n(a),!0):!1}}const P$=f0(0,!1),$$=f0(1,!1);class Xe{constructor(t,e,n,l,a){this.changes=t,this.effects=e,this.mapped=n,this.startSelection=l,this.selectionsAfter=a}setSelAfter(t){return new Xe(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,n;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(l=>l.toJSON())}}static fromJSON(t){return new Xe(t.changes&&$e.fromJSON(t.changes),[],t.mapped&&wt.fromJSON(t.mapped),t.startSelection&&q.fromJSON(t.startSelection),t.selectionsAfter.map(q.fromJSON))}static fromTransaction(t,e){let n=lt;for(let l of t.startState.facet(k$)){let a=l(t);a.length&&(n=n.concat(a))}return!n.length&&t.changes.empty?null:new Xe(t.changes.invert(t.startState.doc),n,void 0,e||t.startState.selection,lt)}static selection(t){return new Xe(void 0,lt,void 0,void 0,t)}}function Ps(r,t,e,n){let l=t+1>e+20?t-e-1:0,a=r.slice(l,t);return a.push(n),a}function C$(r,t){let e=[],n=!1;return r.iterChangedRanges((l,a)=>e.push(l,a)),t.iterChangedRanges((l,a,h,d)=>{for(let p=0;p<e.length;){let g=e[p++],m=e[p++];d>=g&&h<=m&&(n=!0)}}),n}function M$(r,t){return r.ranges.length==t.ranges.length&&r.ranges.filter((e,n)=>e.empty!=t.ranges[n].empty).length===0}function u0(r,t){return r.length?t.length?r.concat(t):r:t}const lt=[],T$=200;function h0(r,t){if(r.length){let e=r[r.length-1],n=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-T$));return n.length&&n[n.length-1].eq(t)?r:(n.push(t),Ps(r,r.length-1,1e9,e.setSelAfter(n)))}else return[Xe.selection([t])]}function D$(r){let t=r[r.length-1],e=r.slice();return e[r.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function jn(r,t){if(!r.length)return r;let e=r.length,n=lt;for(;e;){let l=E$(r[e-1],t,n);if(l.changes&&!l.changes.empty||l.effects.length){let a=r.slice(0,e);return a[e-1]=l,a}else t=l.mapped,e--,n=l.selectionsAfter}return n.length?[Xe.selection(n)]:lt}function E$(r,t,e){let n=u0(r.selectionsAfter.length?r.selectionsAfter.map(d=>d.map(t)):lt,e);if(!r.changes)return Xe.selection(n);let l=r.changes.map(t),a=t.mapDesc(r.changes,!0),h=r.mapped?r.mapped.composeDesc(a):a;return new Xe(l,de.mapEffects(r.effects,t),h,r.startSelection.map(a),n)}const R$=/^(input\.type|delete)($|\.)/;class bt{constructor(t,e,n=0,l=void 0){this.done=t,this.undone=e,this.prevTime=n,this.prevUserEvent=l}isolate(){return this.prevTime?new bt(this.done,this.undone):this}addChanges(t,e,n,l,a){let h=this.done,d=h[h.length-1];return d&&d.changes&&!d.changes.empty&&t.changes&&(!n||R$.test(n))&&(!d.selectionsAfter.length&&e-this.prevTime<l.newGroupDelay&&l.joinToEvent(a,C$(d.changes,t.changes))||n=="input.type.compose")?h=Ps(h,h.length-1,l.minDepth,new Xe(t.changes.compose(d.changes),u0(t.effects,d.effects),d.mapped,d.startSelection,lt)):h=Ps(h,h.length,l.minDepth,t),new bt(h,lt,e,n)}addSelection(t,e,n,l){let a=this.done.length?this.done[this.done.length-1].selectionsAfter:lt;return a.length>0&&e-this.prevTime<l&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&M$(a[a.length-1],t)?this:new bt(h0(this.done,t),this.undone,e,n)}addMapping(t){return new bt(jn(this.done,t),jn(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,n){let l=t==0?this.done:this.undone;if(l.length==0)return null;let a=l[l.length-1];if(n&&a.selectionsAfter.length)return e.update({selection:a.selectionsAfter[a.selectionsAfter.length-1],annotations:Rl.of({side:t,rest:D$(l)}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(a.changes){let h=l.length==1?lt:l.slice(0,l.length-1);return a.mapped&&(h=jn(h,a.mapped)),e.update({changes:a.changes,selection:a.startSelection,effects:a.effects,annotations:Rl.of({side:t,rest:h}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}bt.empty=new bt(lt,lt);function c0(r,t){let e=-1;return r.changeByRange(n=>{let l=[];for(let h=n.from;h<=n.to;){let d=r.doc.lineAt(h);d.number>e&&(n.empty||n.to>d.from)&&(t(d,l,n),e=d.number),h=d.to+1}let a=r.changes(l);return{changes:l,range:q.range(a.mapPos(n.anchor,1),a.mapPos(n.head,1))}})}const O$=({state:r,dispatch:t})=>r.readOnly?!1:(t(r.update(c0(r,(e,n)=>{n.push({from:e.from,insert:r.facet(io)})}),{userEvent:"input.indent"})),!0),I$=({state:r,dispatch:t})=>r.readOnly?!1:(t(r.update(c0(r,(e,n)=>{let l=/^\s*/.exec(e.text)[0];if(!l)return;let a=JS(l,r.tabSize),h=0,d=u$(r,Math.max(0,a-As(r)));for(;h<l.length&&h<d.length&&l.charCodeAt(h)==d.charCodeAt(h);)h++;n.push({from:e.from+h,to:e.from+l.length,insert:d.slice(h)})}),{userEvent:"delete.dedent"})),!0),N$={key:"Tab",run:O$,shift:I$};function xt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var l=e[n];typeof l=="string"?r.setAttribute(n,l):l!=null&&(r[n]=l)}t++}for(;t<arguments.length;t++)d0(r,arguments[t]);return r}function d0(r,t){if(typeof t=="string")r.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)r.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)d0(r,t[e]);else throw new RangeError("Unsupported child node: "+t)}class L${constructor(t,e,n){this.from=t,this.to=e,this.diagnostic=n}}class Zt{constructor(t,e,n){this.diagnostics=t,this.panel=e,this.selected=n}static init(t,e,n){let l=t,a=n.facet(m0).markerFilter;a&&(l=a(l));let h=fe.set(l.map(d=>d.from==d.to||d.from==d.to-1&&n.doc.lineAt(d.from).to==d.from?fe.widget({widget:new z$(d),diagnostic:d}).range(d.from):fe.mark({attributes:{class:"cm-lintRange cm-lintRange-"+d.severity},diagnostic:d}).range(d.from,d.to)),!0);return new Zt(h,e,Li(h))}}function Li(r,t=null,e=0){let n=null;return r.between(e,1e9,(l,a,{spec:h})=>{if(!(t&&h.diagnostic!=t))return n=new L$(l,a,h.diagnostic),!1}),n}function _$(r,t){return!!(r.effects.some(e=>e.is(lo))||r.changes.touchesRange(t.pos))}function B$(r,t){return r.field(ut,!1)?t:t.concat(de.appendConfig.of(G$))}function F$(r,t){return{effects:B$(r,[lo.of(t)])}}const lo=de.define(),p0=de.define(),g0=de.define(),ut=At.define({create(){return new Zt(fe.none,null,null)},update(r,t){if(t.docChanged){let e=r.diagnostics.map(t.changes),n=null;if(r.selected){let l=t.changes.mapPos(r.selected.from,1);n=Li(e,r.selected.diagnostic,l)||Li(e,null,l)}r=new Zt(e,r.panel,n)}for(let e of t.effects)e.is(lo)?r=Zt.init(e.value,r.panel,t.state):e.is(p0)?r=new Zt(r.diagnostics,e.value?oo.open:null,r.selected):e.is(g0)&&(r=new Zt(r.diagnostics,r.panel,e.value));return r},provide:r=>[Cl.from(r,t=>t.panel),Q.decorations.from(r,t=>t.diagnostics)]}),V$=fe.mark({class:"cm-lintRange cm-lintRange-active"});function H$(r,t,e){let{diagnostics:n}=r.state.field(ut),l=[],a=2e8,h=0;n.between(t-(e<0?1:0),t+(e>0?1:0),(p,g,{spec:m})=>{t>=p&&t<=g&&(p==g||(t>p||e>0)&&(t<g||e<0))&&(l.push(m.diagnostic),a=Math.min(p,a),h=Math.max(g,h))});let d=r.state.facet(m0).tooltipFilter;return d&&(l=d(l)),l.length?{pos:a,end:h,above:r.state.doc.lineAt(a).to<h,create(){return{dom:W$(r,l)}}}:null}function W$(r,t){return xt("ul",{class:"cm-tooltip-lint"},t.map(e=>y0(r,e,!1)))}const ag=r=>{let t=r.state.field(ut,!1);return!t||!t.panel?!1:(r.dispatch({effects:p0.of(!1)}),!0)},m0=K.define({combine(r){return Object.assign({sources:r.map(t=>t.source)},Wl(r.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(t,e)=>t?e?n=>t(n)||e(n):t:e}))}});function v0(r){let t=[];if(r)e:for(let{name:e}of r){for(let n=0;n<e.length;n++){let l=e[n];if(/[a-zA-Z]/.test(l)&&!t.some(a=>a.toLowerCase()==l.toLowerCase())){t.push(l);continue e}}t.push("")}return t}function y0(r,t,e){var n;let l=e?v0(t.actions):[];return xt("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},xt("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),(n=t.actions)===null||n===void 0?void 0:n.map((a,h)=>{let d=!1,p=b=>{if(b.preventDefault(),d)return;d=!0;let k=Li(r.state.field(ut).diagnostics,t);k&&a.apply(r,k.from,k.to)},{name:g}=a,m=l[h]?g.indexOf(l[h]):-1,y=m<0?g:[g.slice(0,m),xt("u",g.slice(m,m+1)),g.slice(m+1)];return xt("button",{type:"button",class:"cm-diagnosticAction",onclick:p,onmousedown:p,"aria-label":` Action: ${g}${m<0?"":` (access key "${l[h]})"`}.`},y)}),t.source&&xt("div",{class:"cm-diagnosticSource"},t.source))}class z$ extends pr{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return xt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class fg{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=y0(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class oo{constructor(t){this.view=t,this.items=[];let e=l=>{if(l.keyCode==27)ag(this.view),this.view.focus();else if(l.keyCode==38||l.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(l.keyCode==40||l.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(l.keyCode==36)this.moveSelection(0);else if(l.keyCode==35)this.moveSelection(this.items.length-1);else if(l.keyCode==13)this.view.focus();else if(l.keyCode>=65&&l.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:a}=this.items[this.selectedIndex],h=v0(a.actions);for(let d=0;d<h.length;d++)if(h[d].toUpperCase().charCodeAt(0)==l.keyCode){let p=Li(this.view.state.field(ut).diagnostics,a);p&&a.actions[d].apply(t,p.from,p.to)}}else return;l.preventDefault()},n=l=>{for(let a=0;a<this.items.length;a++)this.items[a].dom.contains(l.target)&&this.moveSelection(a)};this.list=xt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:n}),this.dom=xt("div",{class:"cm-panel-lint"},this.list,xt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>ag(this.view)},"")),this.update()}get selectedIndex(){let t=this.view.state.field(ut).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(ut),n=0,l=!1,a=null;for(t.between(0,this.view.state.doc.length,(h,d,{spec:p})=>{let g=-1,m;for(let y=n;y<this.items.length;y++)if(this.items[y].diagnostic==p.diagnostic){g=y;break}g<0?(m=new fg(this.view,p.diagnostic),this.items.splice(n,0,m),l=!0):(m=this.items[g],g>n&&(this.items.splice(n,g-n),l=!0)),e&&m.diagnostic==e.diagnostic?m.dom.hasAttribute("aria-selected")||(m.dom.setAttribute("aria-selected","true"),a=m):m.dom.hasAttribute("aria-selected")&&m.dom.removeAttribute("aria-selected"),n++});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)l=!0,this.items.pop();this.items.length==0&&(this.items.push(new fg(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),l=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:()=>({sel:a.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:h,panel:d})=>{h.top<d.top?this.list.scrollTop-=d.top-h.top:h.bottom>d.bottom&&(this.list.scrollTop+=h.bottom-d.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),l&&this.sync()}sync(){let t=this.list.firstChild;function e(){let n=t;t=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;t!=n.dom;)e();t=n.dom.nextSibling}else this.list.insertBefore(n.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(ut),n=Li(e.diagnostics,this.items[t].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:g0.of(n)})}static open(t){return new oo(t)}}function U$(r,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(r)}</svg>')`}function Kn(r){return U$(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const q$=Q.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Kn("#d11")},".cm-lintRange-warning":{backgroundImage:Kn("orange")},".cm-lintRange-info":{backgroundImage:Kn("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),G$=[ut,Q.decorations.compute([ut],r=>{let{selected:t,panel:e}=r.field(ut);return!t||!e||t.from==t.to?fe.none:fe.set([V$.range(t.from,t.to)])}),IP(H$,{hideOn:_$}),q$];function j$(){const r={name:"glsl",token(t,e){const n=()=>{t.eol()&&e.comment=="line"&&(e.comment=!1)};if(e.comment){if(t.match(/^@\w+/))return e.precedingDocComment=1,n(),"attributeName";if(e.precedingDocComment==1)return t.eatSpace(),n(),t.match("=")?(t.eatSpace(),n(),e.precedingDocComment=2,n(),"comment"):(e.precedingDocComment=0,n(),"comment");if(e.precedingDocComment==2&&t.match(/"[^"]*?"|\S+/))return e.precedingDocComment=0,n(),"attributeValue";e.precedingDocComment=0}return t.match(/^\/\*/)?(e.comment="block","comment"):t.match(/^\/\//)?(e.comment="line",n(),"comment"):t.match(/^\*\//)&&e.comment=="block"?(e.comment=!1,"comment"):e.comment?(t.next(),n(),"comment"):(t.eatSpace(),t.match(/^[iu]?vec[234]/)||t.match(/^(int|uint|float)/)||t.match(/^sampler[1D|2D|3D]/)?"typeName":t.match(/^(for|return|while|switch|break|uniform|struct|if|else)/)?"keyword":t.match(/^[a-zA-Z_][a-zA-Z_0-9]*/)?"variableName":t.match(/^-?[1-9][0-9]*/)?"integer":t.match(/^-?[0-9]*\.[0-9]*/)?"float":t.match(/^(\-|\+|\*|\/|\%|\>|\<|\>\=|\<\=|\=|\=\=)/)?"operator":(t.next(),"name"))},startState:t=>({comment:!1,precedingDocComment:0})};return ro.define(r)}const K$=oe("<div></div>",2);et.define();et.define();console.log(et);function X$(r,t){for(let e=0;e<Math.min(r.length,t.length);e++)if(r[e]!=t[e])return!1;return!0}function Y$(r){const[t,e]=He(r.src());return(()=>{const n=K$.cloneNode(!0);return ls(l=>{const a=()=>[A$(),zP(),Q.updateListener.of(function(d){ek(()=>{const p=d.state.doc.toString();r.setSrc(p),e(p)})}),Q.theme({".cm-content":{caretColor:"white"},".cm-gutterElement":{background:"#00000000",color:"white"},".cm-gutters":{borderColorRight:"#ffffff88",backgroundColor:"#00000000"},".cm-tooltip":{background:"black",color:"white"}}),Um.of([N$,{key:"Ctrl-s",run:d=>(r.onSave(),!0)}]),j$(),h$(mr.define([{tag:[_.typeName],color:"#ff4444"},{tag:[_.comment],color:"#999999"},{tag:[_.attributeName],color:"#BB77AA"},{tag:[_.attributeValue],color:"#FFAAFF"},{tag:[_.integer,_.float],color:"#00AACC"},{tag:[_.variableName],color:"#FFFFAA"},{tag:[_.operator],color:"white"},{tag:[_.keyword],color:"#99EE99"}]))],h=new Q({state:se.create({doc:r.src(),extensions:a()}),parent:l});ki(d=>{let p=[];return X$([r.infoLog(),r.extraErrors()],d)?d:(r.infoLog().split(`
`).map(g=>{const[m,y]=g.slice(7).split(":").slice(0,2).map(k=>parseInt(k));if(typeof y!="number"||y<145)return;const b=h.state.doc.line(y-145);p.push({from:b.from,to:b.to,severity:"error",message:g.slice(7).split(":").slice(2).join(":")})}),r.extraErrors().forEach(g=>{p.push({from:g.start,to:g.end,message:g.message,severity:"error"})}),h.dispatch(F$(h.state,p)),[r.infoLog(),r.extraErrors()])},["",[]]),ki(()=>{ht(()=>{h.setState(se.create({doc:r.src(),extensions:a()}))})}),ki(()=>{t()!=r.src()&&h.dispatch({changes:{from:0,to:h.state.doc.length,insert:r.src()}})})},n),n})()}const J$=oe("<button>Recompile</button>",2),Z$=oe('<select><option value="guide.glsl">guide.glsl</option><option value="fractal1.glsl">fractal1.glsl</option><option value="menger-sponge.glsl">menger-sponge.glsl</option><option value="rotation-fractal.glsl">rotation-fractal.glsl</option><option value="tree.glsl">tree.glsl</option><option value="smooth-tree.glsl">smooth-tree.glsl</option></select>',14),Q$=oe('<div><div class="shader-sticky-tab"></div></div>',4),e3=oe("<p></p>",2);function t3(r){const[t,e]=He(r.value().shaderCode);ki(()=>{e(r.value().shaderCode)});const[n,l]=He("guide.glsl");let a,h;return gg(()=>{h.addEventListener("wheel",d=>{a.getBoundingClientRect().top<1?(a.style.backgroundColor="#00000088",a.style.borderBottomColor="#ffffff88"):(a.style.backgroundColor="#00000000",a.style.borderBottomColor="#ffffff00")})}),(()=>{const d=Q$.cloneNode(!0),p=d.firstChild;return ls(g=>h=g,d),ls(g=>a=g,p),te(p,V(pe,{name:"",tooltip:"Recompiles the shader. You can also use Ctrl+S to recompile.",get children(){const g=J$.cloneNode(!0);return g.$$click=m=>{r.setValue({...r.value(),shaderCode:t()})},g}}),null),te(p,V(pe,{name:"",tooltip:"Select one of the shaders from this dropdown to view it. This will overwrite all the code below.",get children(){const g=Z$.cloneNode(!0);return g.addEventListener("change",async m=>{l(m.currentTarget.value);const y=await(await fetch("examples/"+m.currentTarget.value)).text();e(y),r.setValue({...r.value(),shaderCode:y})}),Fe(()=>g.value=n()),g}}),null),te(d,(()=>{const g=be(()=>!!r.value().shaderErrors);return()=>g()&&(()=>{const m=e3.cloneNode(!0);return te(m,()=>r.value().shaderErrors),m})()})(),null),te(d,V(Y$,{src:t,setSrc:e,infoLog:()=>r.value().shaderErrors,onSave:()=>{r.setValue({...r.value(),shaderCode:t()})},extraErrors:()=>r.customSettings().filter(g=>!g.success).map(g=>({message:g.reason,start:g.start,end:g.end}))}),null),d})()}Gt(["click"]);function i3(r){let t=0;return{done:()=>t>=r.length,pos:()=>t,match:(e,n)=>{var l;if(e instanceof RegExp){const a=(l=r.slice(t).match(e))==null?void 0:l[0];if(a)return n||(t+=a.length),a}else if(e instanceof Function){const a=e(r.slice(t)),h=r.slice(t,t+a);return n||(t+=a),h}else if(r.slice(t).startsWith(e))return n||(t+=e.length),e},next:e=>(t+=e,r.slice(t-e,t))}}function r3(r){const t=i3(r),e=[];let n=!1,l=1,a="f",h="",d="",p,g=new Set(["numerical"]),m={},y,b=[0,0,0,0],k=0,C=!0;function O(){k=1,console.log("uniform got here"),C||(e.push({success:!0,quantity:l,type:a,name:h,tooltip:p,internalName:d,formats:Array.from(g.values()),...m,scale:y,defaultValue:b}),l=1,a="f",h="",p=void 0,d="",g=new Set(["numerical"]),m={},y=void 0,b=[0,0,0,0]),C=!1,t.match(/^\s/)}for(;!t.done();){if(t.match("//")&&!n){n="line",console.log("linecomment");continue}if(t.match("/*")&&!n){n="block";continue}if(t.match("*/")&&n=="block"){n=!1;continue}if(t.match(`
`,!0)&&n=="line"){n=!1;continue}if(n){const M=t.match(/^@\w+\s*\=\s*("[^"]*?"|\S+)/);if(console.log("kvp",M),M){const I=M,[L,F]=I.split("=").map(W=>W.trim()),N=L.slice(1),H=F[0]=='"'?F.slice(1,-1):F;switch(N){case"min":case"max":case"step":case"sensitivity":const W=Number(H);isNaN(W)&&e.push({success:!1,reason:`Expected property '${N}' to be a number.`,start:t.pos()-H.length,end:t.pos()}),m[N]=W;break;case"scale":H=="linear"||H=="log"&&(y="log");break;case"name":h=H;break;case"tooltip":p=H;break;case"format":g.clear();const Z=H.split("/");for(const X of Z)X=="numerical"||X=="position"||X=="color"||X=="checkbox"?g.add(X):e.push({success:!1,reason:`Unknown input format '${X}'. Accepted values are "numerical", "position", "color", and "checkbox"`,start:t.pos()-H.length,end:t.pos()});break;case"default":const re=H.split(",");re.length!=l&&e.push({success:!1,reason:`This variable requires ${l} default values, but ${re.length} were supplied. Note that you need quotes if a value contains spaces.`,start:t.pos()-H.length,end:t.pos()}),b=re.map(X=>Number(X));break}continue}t.next(1)}else{if(k==1){t.match(/^\s/);const M=t.match(Wk);if(M){const[I,L]=M.split(/\s+/g).map(F=>F.trim());if(!I||!L)continue;l=1,a="f",I[0]=="u"&&(a="ui"),I[0]=="i"&&(a="i"),I.match(/vec/g)&&(l=parseInt(I[I.length-1])),h=L,d=L}else k=0;continue}if(t.match("uniform")){O();continue}t.next(1)}}return O(),e}const s3=oe("<button>Reposition</button>",2);function n3(r){const t=Kt(r.value,r.setValue);return V(pe,{get name(){return r.setup.name},get tooltip(){return r.setup.tooltip},get children(){return[be(()=>be(()=>!!r.setup.formats.includes("numerical"))()&&new Array(r.setup.quantity).fill(0).map((e,n)=>V(je,{value:()=>{var l;return((l=r.value()[r.setup.internalName])==null?void 0:l.data[n])??0},setValue:l=>{r.value()[r.setup.internalName]||t(r.setup.internalName)({type:r.setup.type,count:r.setup.quantity,data:new Array(r.setup.quantity).fill(0)}),t(r.setup.internalName)({...r.value()[r.setup.internalName],data:r.value()[r.setup.internalName].data.map((a,h)=>h==n?l:a)})},get min(){return r.setup.min},get max(){return r.setup.max},get step(){return r.setup.step},get sensitivity(){return r.setup.sensitivity},get slideMode(){return r.setup.scale},updateInRealTime:!0}))),be(()=>be(()=>!!(r.setup.formats.includes("color")&&r.setup.type=="f"&&r.setup.quantity==3))()&&V(Rg,{value:()=>{var e;return((e=r.value()[r.setup.internalName])==null?void 0:e.data.map(n=>n*256))??[0,0,0]},setValue:e=>{t(r.setup.internalName)({type:"f",count:3,data:e.map(n=>n/256)})}})),be(()=>be(()=>!!(r.setup.formats.includes("position")&&r.setup.type=="f"&&r.setup.quantity==3))()&&V(pe,{name:"",tooltip:"Click to set this variable to the (X, Y, Z) position of the viewer.",get children(){const e=s3.cloneNode(!0);return e.$$click=n=>{t(r.setup.internalName)({type:"f",count:3,data:r.position()})},e}})),be(()=>be(()=>!!r.setup.formats.includes("checkbox"))()&&new Array(r.setup.quantity).fill(0).map((e,n)=>V(fs,{value:()=>{var l;return(((l=r.value()[r.setup.internalName])==null?void 0:l.data[n])??0)!=0},setValue:l=>{r.value()[r.setup.internalName]||t(r.setup.internalName)({type:r.setup.type,count:r.setup.quantity,data:new Array(r.setup.quantity).fill(0)}),t(r.setup.internalName)({...r.value()[r.setup.internalName],data:r.value()[r.setup.internalName].data.map((a,h)=>h==n?l?1:0:a)})}})))]}})}const ug=r=>r.filter(t=>t.success);function l3(r){return gk(()=>{const t=r3(r.value().shaderCode);console.log(t),r.setCustomSettings(t),r.setValue({...r.value(),customSettings:Object.fromEntries(ug(t).map(e=>[e.internalName,{count:e.quantity,type:e.type,data:e.defaultValue??new Array(e.quantity).fill(0)}]))})},()=>r.value().shaderCode),V(ri,{name:"Custom Settings",get children(){return ug(r.customSettings()).map(t=>V(n3,{value:()=>r.value().customSettings,setValue:e=>r.setValue({...r.value(),customSettings:e}),setup:t,get position(){return r.position}}))}})}Gt(["click"]);const o3=oe("<div><h1>Raymarching Engine</h1><button>Capture Image</button></div>",6),a3=oe('<div class="tooltip"><h2></h2></div>',4),hg=oe("<div></div>",2);function Kt(r,t,e){let n=e??(l=>l);return function(l){return function(a){t(n({...r(),[l]:a}))}}}function f3(r){const t=Kt(r.value,r.setValue);return[V(xS,{get value(){return r.value},get setValue(){return r.setValue}}),V(IS,{get value(){return r.value},get setValue(){return r.setValue}}),V(ri,{name:"DoF",get children(){return[V(pe,{name:"Amount",tooltip:"Strength of the depth of field effect. Higher values yield blurrier results in out-of-focus areas. Set to 0 to disable entirely.",get children(){return V(je,{min:0,value:()=>r.value().dofAmount,get setValue(){return t("dofAmount")},sensitivity:.003,updateInRealTime:!0,slideMode:"log"})}}),V(pe,{name:"Focus Distance",tooltip:"Distance at which to focus the camera for the purposes of depth of field. Areas in focus will be highlighted.",get children(){return V(je,{min:0,value:()=>r.value().dofFocusDistance,get setValue(){return t("dofFocusDistance")},sensitivity:.01,updateInRealTime:!0,onSlideStart:()=>{t("showFocusedArea")(!0)},onSlideEnd:()=>{t("showFocusedArea")(!1)},slideMode:"log"})}})]}}),V(mS,{get value(){return r.value},get setValue(){return r.setValue}}),V(RS,{get value(){return r.value},get setValue(){return r.setValue},lightPosition:()=>r.value().viewerPosition}),V(l3,{get value(){return r.value},get setValue(){return r.setValue},position:()=>r.value().viewerPosition,get customSettings(){return r.customSettings},get setCustomSettings(){return r.setCustomSettings}}),V(ri,{name:"Other",get children(){return V(pe,{name:"Fog Density",tooltip:"Density of the fog uniformly distributed throughout the scene.",get children(){return V(je,{min:0,value:()=>r.value().fogDensity,get setValue(){return t("fogDensity")},sensitivity:3e-4,updateInRealTime:!0})}})}})]}function u3(r){Kt(r.value,r.setValue);const[t,e]=He([]),[n,l]=He({name:"Name",tooltip:"Tooltip",visible:!1,x:0,y:0}),[a,h]=He("settings");return V(Dg.Provider,{value:[n,d=>l(d)],get children(){return[(()=>{const d=o3.cloneNode(!0),p=d.firstChild,g=p.nextSibling;return te(d,V(Bl,{value:a,setValue:h,variants:[["settings","Settings"],["shader","Shader"]]}),g),g.$$click=()=>{r.captureImage()},te(d,()=>(()=>{const m=hg.cloneNode(!0);return te(m,V(f3,{get value(){return r.value},get setValue(){return r.setValue},customSettings:t,setCustomSettings:e})),Fe(()=>m.style.setProperty("display",a()=="settings"?"":"none")),m})(),null),te(d,()=>(()=>{const m=hg.cloneNode(!0);return te(m,V(t3,{get value(){return r.value},get setValue(){return r.setValue},customSettings:t})),Fe(()=>m.style.setProperty("display",a()=="shader"?"":"none")),m})(),null),Fe(()=>Ms(d,"settings"+{"always-visible":" floating-settings",hide:" floating-settings hidden-settings","separate-tab":" separate-tab-settings"}[r.value().menuDisplayMode])),d})(),(()=>{const d=a3.cloneNode(!0),p=d.firstChild;return te(p,()=>n().name),te(d,()=>n().tooltip,null),Fe(g=>{const m=n().visible?"":"none",y=`${n().y}px`,b=`${n().x}px`;return m!==g._v$&&d.style.setProperty("display",g._v$=m),y!==g._v$2&&d.style.setProperty("top",g._v$2=y),b!==g._v$3&&d.style.setProperty("left",g._v$3=b),g},{_v$:void 0,_v$2:void 0,_v$3:void 0}),d})()]}})}Gt(["click"]);const h3=oe("<canvas></canvas>",2),c3=oe("<div></div>",2);function d3(r){return function(e,n,l,a,h){e.scissor(0,0,n.render.width,n.render.height),e.useProgram(l.program.display),jr(e,l.program.display,{color:ne.int(0),normalAndDofRadiusTex:ne.int(1),albedoAndDepthTex:ne.int(2),brightness:ne.float(1/r)}),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,a.currTex.color),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,a.currTex.normalAndDofRadius),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,a.currTex.albedoAndDepth),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.drawArrays(e.TRIANGLES,0,6)}}const p3=async(r,t,e)=>{r.addEventListener("click",b=>{b.button==0&&r.requestPointerLock()});let n=0,l=nS(sS()),a=0;r.addEventListener("mousemove",b=>{document.pointerLockElement===r&&(Zd(l,l,.004*b.movementX,[0,1,0]),Zd(l,l,.004*b.movementY,[1,0,0]),n=5)});let h=new Map;document.addEventListener("keydown",b=>{document.pointerLockElement===r&&h.set(b.key.toLowerCase(),!0)}),document.addEventListener("keyup",b=>{h.set(b.key.toLowerCase(),!1)});const d=r.getContext("webgl2",{preserveDrawingBuffer:!0});if(!d)return;d.getExtension("EXT_color_buffer_float");const p=await iS(d);if(console.log(p),!p)return;let g=!1,m=0;async function y(){const b={reflectionIterationCounts:t().reflectionIterationCounts.map(M=>M.count),normalDelta:1e-5,sdfShaderSource:t().shaderCode,customShaderParameters:t().customSettings,fogDensity:t().fogDensity,time:0,timeDelta:0,dof:{distance:t().dofFocusDistance,amount:t().dofAmount,showFocusedArea:t().showFocusedArea},camera:{position:t().viewerPosition,rotation:l,motion:[0,0,0],mode:(()=>{switch(t().cameraMode){case"perspective":return{type:"perspective",fov:t().fov};case"orthographic":return{type:"orthographic",size:t().orthographicSize};case"panoramic":return{type:"panoramic",angleX:Math.PI*2,angleY:Math.PI}}})()},render:{width:t().width,height:t().height,samplesPerPixel:1,exposure:.5,subdivisions:1,frameid:a,blendWithPreviousFrameFactor:.9,sampleYieldInterval:1,blendMode:"additive",renderMode:t().previewMode?"preview":"full"},lights:t().lights.map(M=>({size:M.size,position:M.position,color:M.color.map(I=>I*M.strength/256),type:"point"}))};d.viewport(0,0,b.render.width,b.render.height);const k=[0,0,0],C=t().cameraSpeed;h.get("w")&&(k[2]+=C),h.get("a")&&(k[0]-=C),h.get("s")&&(k[2]-=C),h.get("d")&&(k[0]+=C),h.get("shift")&&(k[1]-=C),h.get(" ")&&(k[1]+=C);let O=Qd(k)!=0||n>0;if((g||t().requestingNewFrame)&&(e({...t(),requestingNewFrame:!1}),m=0,a++,g=!1),m++,O&&(g=!0),t().renderWhileInMenu||document.pointerLockElement!==null){const M=(await Gk(b,p))(d3(m));let I=!1;for(;!I;){const L=M.next();I=L.done??!1,L.value&&!L.value.success&&L.value.why&&L.value.why.type=="fragment"?t().shaderErrors!=L.value.why.infoLog&&e({...t(),shaderErrors:L.value.why.infoLog}):t().shaderErrors!=""&&e({...t(),shaderErrors:""})}}n--,oS(k,k,b.camera.rotation),Qd(k)!=0&&e({...t(),viewerPosition:Array.from(lS(Tg(),t().viewerPosition,k))}),requestAnimationFrame(y)}y()};function g3(){const[r,t]=He({dofAmount:.01,dofFocusDistance:1.5,matchScreenResolution:!0,resolutionFactor:1,width:1280,height:720,rawWidth:1280,rawHeight:720,requestingNewFrame:!1,samplesRenderedSoFar:0,fov:1.5,fogDensity:0,reflectionIterationCounts:[128,128,64,32,32].map((l,a)=>({count:l,id:a})),cameraMode:"perspective",orthographicSize:1.5,renderWhileInMenu:!0,menuDisplayMode:"always-visible",cameraSpeed:.01,previewMode:!0,lights:[],viewerPosition:[0,0,0],previewModeDownscaling:.25,showFocusedArea:!1,shaderErrors:"",customSettings:{},shaderCode:`// Diffuse color for the scene as a function of position.
vec3 sceneDiffuseColor(vec3 position) {
  if (length(position) > 35.0) return vec3(0.0);
  return vec3(0.6);
}

// Specular/metallic color for the scene.
vec3 sceneSpecularColor(vec3 position) {
  if (length(position) > 35.0) return vec3(0.0);
  return vec3(0.6);
}

// Specular roughness coefficient (ranges 0-1).
float sceneSpecularRoughness(vec3 position) {
  return 0.2;
}

// Subsurface scattering coefficient. Lower values appear translucent and scatter more.
float sceneSubsurfaceScattering(vec3 position) {
  return 11111115.0;
}

// Color for light rays that undergo subsurface scattering.
vec3 sceneSubsurfaceScatteringColor(vec3 position) {
  if (length(position) > 30.0) return vec3(1.0);
  return vec3(1.0);
}

// Index of refraction for fresnel effects.
float sceneIOR(vec3 position) {
  return 100.0;
}

// Light emission strength.
vec3 sceneEmission(vec3 position) {
  float d = max(normalize(position).y, 0.2);
  vec3 brightColor = vec3(0.7, 0.8, 1.0) * d * 1.0;
  return (length(position) > 36.0) ? (brightColor * 2.00) : vec3(0.0);
}

// Signed distance function describing the scene to be drawn.
float sdf(vec3 position) {  
  float minDist = 9999.9;
  for (float i = -1.0; i < 10.0; i++) {
      float sf = pow(0.3333333333333, i);
      ivec3 index = ivec3(position / 2.0);
      vec3 d = abs(mod(position + vec3(0.5 * sf), sf) - vec3(sf / 2.0)) - vec3(sf / 3.0);
      float dist = length(d) - 0.21 * sf;
      minDist = min(dist, minDist);
  }
  minDist = max(length(position) - 5.0, -minDist);
  return minDist;
}`});gg(async()=>{t({...r(),shaderCode:await(await fetch("examples/guide.glsl")).text()}),console.log("GUIDE LOADED"),console.log(r().shaderCode)});let e;const n=(()=>{const l=h3.cloneNode(!0);return ls(a=>{e=a;function h(){if(r().matchScreenResolution){let p=r().resolutionFactor*(r().previewMode?r().previewModeDownscaling:1);const g=a.getBoundingClientRect();console.log("dims",g.width,g.height),t({...r(),width:Math.max(1,Math.round((g.width||window.innerWidth)*p)),height:Math.max(1,Math.round((g.height||window.innerHeight)*p)),requestingNewFrame:!0})}}window.addEventListener("resize",h),new ResizeObserver(()=>h()).observe(a),h(),p3(a,r,t)},l),Fe(a=>{const h=r().width,d=r().height,p=r().menuDisplayMode=="separate-tab"?"main-canvas-tab":"main-canvas";return h!==a._v$&&kn(l,"width",a._v$=h),d!==a._v$2&&kn(l,"height",a._v$2=d),p!==a._v$3&&kn(l,"id",a._v$3=p),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),l})();return(()=>{const l=c3.cloneNode(!0);return te(l,n,null),te(l,V(u3,{captureImage:()=>{const a=e.toDataURL("image/png",1),h=document.createElement("a");h.href=a,h.download="3d-fractal.png",h.click()},value:r,setValue:a=>{t({...a,requestingNewFrame:!0})}}),null),Fe(()=>Ms(l,r().menuDisplayMode=="separate-tab"?"tabs-container":"")),l})()}hk(()=>V(g3,{}),document.body);
